<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>施工事例ポートフォリオ作成ツール | Premium Builder</title>
    <style>
        :root {
            --gold: #D4AF37;
            --dark-bg: #1a1a1a;
            --input-bg: #2a2a2a;
            --text-color: #ffffff;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: #000;
            color: var(--text-color);
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* 左側：入力フォーム */
        .editor-side {
            width: 400px;
            background-color: var(--dark-bg);
            border-right: 1px solid var(--gold);
            padding: 20px;
            overflow-y: auto;
            box-shadow: 5px 0 15px rgba(0,0,0,0.5);
            z-index: 10;
        }

        h1 { color: var(--gold); font-size: 1.2rem; border-bottom: 1px solid var(--gold); padding-bottom: 10px; }
        
        .form-group { margin-bottom: 15px; }
        label { display: block; font-size: 0.8rem; color: var(--gold); margin-bottom: 5px; }
        
        input[type="text"], textarea {
            width: 100%;
            background: var(--input-bg);
            border: 1px solid #444;
            color: white;
            padding: 8px;
            box-sizing: border-box;
            border-radius: 4px;
        }

        input[type="file"] {
            font-size: 0.7rem;
            color: #ccc;
        }

        .btn-download {
            width: 100%;
            background: linear-gradient(45deg, #B8860B, #D4AF37);
            color: black;
            border: none;
            padding: 12px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            border-radius: 4px;
            transition: transform 0.2s;
        }
        .btn-download:hover { transform: scale(1.02); }

        /* 右側：プレビュー */
        .preview-side {
            flex-grow: 1;
            background: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        #preview-frame {
            width: 375px; /* スマホサイズ */
            height: 80%;
            background: white;
            border: 10px solid #222;
            border-radius: 20px;
            overflow: hidden;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--gold);
            color: black;
            padding: 5px 10px;
            font-size: 10px;
            border-radius: 20px;
        }
    </style>
</head>
<body>

<div class="editor-side">
    <h1>PREMIUM PORTFOLIO BUILDER</h1>
    
    <div class="form-group">
        <label>施工タイトル</label>
        <input type="text" id="title" placeholder="例：M様邸 擁壁リノベーション" oninput="updatePreview()">
    </div>

    <div class="form-group">
        <label>キャッチコピー</label>
        <input type="text" id="catch" placeholder="例：ブロック塀が、重厚な石積みへ。" oninput="updatePreview()">
    </div>

    <div class="form-group">
        <label>メイン画像 (hero.jpg)</label>
        <input type="file" id="img-hero" accept="image/*" onchange="previewImage(this, 'hero')">
    </div>

    <hr style="border-color: #444;">

    <div class="form-group">
        <label>B/Aセット1 (Before: before1.jpg)</label>
        <input type="file" id="img-b1" accept="image/*" onchange="previewImage(this, 'b1')">
        <label style="margin-top:5px;">B/Aセット1 (After: after1.jpg)</label>
        <input type="file" id="img-a1" accept="image/*" onchange="previewImage(this, 'a1')">
    </div>

    <div class="form-group">
        <label>アトモスフィア画像 (atmosphere.jpg)</label>
        <input type="file" id="img-atmo" accept="image/*" onchange="previewImage(this, 'atmo')">
    </div>

    <div class="form-group">
        <label>施工コメント</label>
        <textarea id="comment" rows="4" oninput="updatePreview()"></textarea>
    </div>

    <button class="btn-download" onclick="downloadHTML()">ポートフォリオを保存 (HTML)</button>
    <p style="font-size: 10px; color: #888; margin-top: 10px;">※保存時は画像パスが img/ フォルダ参照に変換されます。</p>
</div>

<div class="preview-side">
    <div class="badge">PREVIEW (Mobile View)</div>
    <div id="preview-frame">
        <iframe id="output-iframe"></iframe>
    </div>
</div>

<script>
    // 各画像の一時URLを格納
    const images = {
        hero: '', b1: '', a1: '', atmo: ''
    };

    function previewImage(input, key) {
        if (input.files && input.files[0]) {
            images[key] = URL.createObjectURL(input.files[0]);
            updatePreview();
        }
    }

    function generateHTML(isDownload = false) {
        const title = document.getElementById('title').value || '施工事例タイトル';
        const catchphrase = document.getElementById('catch').value || 'キャッチコピーがここに入ります';
        const comment = document.getElementById('comment').value || '施工の詳細コメントがここに入ります。';

        // ダウンロード用なら相対パス、プレビュー用ならBlob URLを使用
        const getPath = (key, defaultName) => {
            if (isDownload) return `img/${defaultName}`;
            return images[key] || 'https://via.placeholder.com/800x600?text=No+Image';
        };

        return `
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${title}</title>
    <style>
        body { margin: 0; background: #000; color: #fff; font-family: sans-serif; overflow-x: hidden; }
        .hero { position: relative; height: 100vh; background: url('${getPath('hero', 'hero.jpg')}') center/cover; display: flex; align-items: flex-end; }
        .hero::after { content:''; position:absolute; top:0; left:0; width:100%; height:100%; background:linear-gradient(transparent, #000); }
        .hero-content { position: relative; z-index: 1; padding: 40px 20px; }
        .gold-text { color: #D4AF37; }
        h1 { font-size: 1.8rem; margin: 0; }
        .catch { font-size: 1.1rem; margin-top: 10px; }
        
        .section { padding: 60px 20px; text-align: center; }
        .ba-container { position: relative; width: 100%; max-width: 500px; margin: 20px auto; aspect-ratio: 4/3; overflow: hidden; border: 1px solid #D4AF37; }
        .ba-image { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
        .ba-after { clip-path: inset(0 0 0 50%); }
        .ba-slider { position: absolute; top: 0; bottom: 0; left: 50%; width: 2px; background: #D4AF37; z-index: 10; cursor: ew-resize; }
        .ba-slider::before { content: '◀ ▶'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #D4AF37; color: black; padding: 5px; font-size: 10px; border-radius: 5px; }

        .atmosphere { width: 100%; height: 300px; object-fit: cover; border-top: 1px solid #D4AF37; border-bottom: 1px solid #D4AF37; }
        .footer { padding: 40px 20px; font-size: 0.8rem; color: #888; text-align: center; }
    </style>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9KY5C7XC36"><\/script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-9KY5C7XC36');
    <\/script>
</head>
<body>
    <header class="hero">
        <div class="hero-content">
            <h1 class="gold-text">${title}</h1>
            <p class="catch">${catchphrase}</p>
        </div>
    </header>

    <section class="section">
        <h2 class="gold-text">BEFORE / AFTER</h2>
        <div class="ba-container" id="slider1">
            <img src="${getPath('b1', 'before1.jpg')}" class="ba-image">
            <img src="${getPath('a1', 'after1.jpg')}" class="ba-image ba-after" id="afterImg">
            <div class="ba-slider" id="sliderHandle"></div>
        </div>
        <p style="margin-top:30px;">${comment.replace(/\n/g, '<br>')}</p>
    </section>

    <img src="${getPath('atmo', 'atmosphere.jpg')}" class="atmosphere">

    <footer class="footer">
        &copy; ROLLER STONE PORTFOLIO
    </footer>

    <script>
        const container = document.getElementById('slider1');
        const afterImg = document.getElementById('afterImg');
        const handle = document.getElementById('sliderHandle');

        const move = (e) => {
            let x = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
            let rect = container.getBoundingClientRect();
            let position = ((x - rect.left) / rect.width) * 100;
            if (position < 0) position = 0;
            if (position > 100) position = 100;
            afterImg.style.clipPath = \`inset(0 0 0 \${position}%)\`;
            handle.style.left = \`\${position}%\`;
        };

        container.addEventListener('mousemove', move);
        container.addEventListener('touchmove', move);
    <\/script>
</body>
</html>`;
    }

    function updatePreview() {
        const iframe = document.getElementById('output-iframe');
        const doc = iframe.contentDocument || iframe.contentWindow.document;
        doc.open();
        doc.write(generateHTML(false));
        doc.close();
    }

    function downloadHTML() {
        const htmlContent = generateHTML(true);
        const blob = new Blob([htmlContent], { type: 'text/html' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'index.html';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }

    // 初期プレビュー
    updatePreview();
</script>

</body>
</html>
