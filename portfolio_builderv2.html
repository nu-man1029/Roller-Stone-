<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ææ¡ˆãƒ‘ãƒ¼ã‚¹ãƒ»ãƒ“ãƒ«ãƒ€ãƒ¼ | ROLLER STONE PREMIUM</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600&family=Noto+Serif+JP:wght@200;300;400&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #C9A84C;
            --gold-light: #E8D5A3;
            --gold-dim: rgba(201,168,76,0.3);
            --dark: #0e0e0e;
            --panel: #141414;
            --card: #1a1a1a;
            --input-bg: #111;
            --border: #2a2a2a;
            --text: #e8e8e8;
            --muted: #777;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Noto Serif JP', 'Cormorant Garamond', serif;
            background: var(--dark);
            color: var(--text);
            min-height: 100vh;
        }

        /* â”â”â” HEADER â”â”â” */
        .app-header {
            background: var(--panel);
            border-bottom: 1px solid var(--border);
            padding: 14px 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 200;
        }
        .app-logo {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.1rem;
            font-weight: 300;
            letter-spacing: 4px;
            color: var(--gold);
            text-transform: uppercase;
        }
        .app-logo span { color: var(--muted); font-size: 0.65rem; letter-spacing: 6px; display: block; margin-top: 2px; }

        /* â”â”â” LAYOUT â”â”â” */
        .workspace {
            display: grid;
            grid-template-columns: 380px 1fr;
            height: calc(100vh - 57px);
        }
        @media (max-width: 900px) {
            .workspace { grid-template-columns: 1fr; height: auto; }
            .preview-panel { height: 70vh; }
        }

        /* â”â”â” EDITOR PANEL â”â”â” */
        .editor-panel {
            background: var(--panel);
            border-right: 1px solid var(--border);
            overflow-y: auto;
            padding: 28px 24px;
        }
        .editor-panel::-webkit-scrollbar { width: 4px; }
        .editor-panel::-webkit-scrollbar-track { background: transparent; }
        .editor-panel::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }

        .section-title {
            font-size: 0.6rem;
            letter-spacing: 5px;
            color: var(--gold);
            text-transform: uppercase;
            margin: 28px 0 14px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--gold-dim);
            font-family: 'Cormorant Garamond', serif;
        }
        .section-title:first-child { margin-top: 0; }

        /* API KEY */
        .api-key-row {
            display: flex;
            gap: 8px;
            align-items: center;
            background: #0a0a0a;
            border: 1px solid #2a2a2a;
            border-radius: 6px;
            padding: 10px 12px;
            margin-bottom: 6px;
        }
        .api-key-row input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text);
            font-size: 0.78rem;
            outline: none;
            font-family: 'Courier New', monospace;
        }
        .api-key-row input::placeholder { color: #444; }
        .api-key-hint { font-size: 0.62rem; color: #555; margin-bottom: 20px; line-height: 1.6; }
        .api-key-hint a { color: var(--gold); text-decoration: none; }

        /* FORM ELEMENTS */
        .form-group { margin-bottom: 16px; }
        label {
            display: block;
            font-size: 0.62rem;
            color: var(--muted);
            margin-bottom: 6px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        input[type="text"], textarea {
            width: 100%;
            background: var(--input-bg);
            border: 1px solid var(--border);
            color: var(--text);
            padding: 10px 13px;
            border-radius: 5px;
            font-size: 0.82rem;
            font-family: 'Noto Serif JP', serif;
            transition: border-color 0.2s;
            outline: none;
        }
        input[type="text"]:focus, textarea:focus { border-color: var(--gold-dim); }
        textarea { resize: vertical; line-height: 1.7; }

        .file-upload-area {
            border: 1px dashed #333;
            border-radius: 5px;
            padding: 14px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--input-bg);
            position: relative;
        }
        .file-upload-area:hover { border-color: var(--gold-dim); background: #151515; }
        .file-upload-area input[type="file"] { position: absolute; inset: 0; opacity: 0; cursor: pointer; width: 100%; }
        .file-upload-area .upload-label { font-size: 0.7rem; color: #555; letter-spacing: 1px; pointer-events: none; }
        .file-upload-area .upload-label.has-file { color: var(--gold); }
        .file-upload-area .upload-icon { font-size: 1.4rem; display: block; margin-bottom: 6px; opacity: 0.4; }

        .ba-pair { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

        /* BA SET */
        .ba-set {
            background: #0d0d0d;
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 10px;
            position: relative;
            animation: fadeIn 0.25s ease;
        }
        .ba-set-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .ba-set-label {
            font-size: 0.6rem;
            color: var(--muted);
            letter-spacing: 3px;
            text-transform: uppercase;
        }
        .ba-delete-btn {
            background: none;
            border: 1px solid #333;
            color: #555;
            width: 24px;
            height: 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s;
            flex-shrink: 0;
        }
        .ba-delete-btn:hover { border-color: #c0392b; color: #c0392b; background: rgba(192,57,43,0.08); }

        .btn-add-ba {
            width: 100%;
            padding: 11px;
            background: transparent;
            border: 1px dashed #333;
            color: #555;
            font-size: 0.68rem;
            letter-spacing: 3px;
            cursor: pointer;
            border-radius: 5px;
            font-family: 'Cormorant Garamond', serif;
            transition: all 0.2s;
            margin-top: 4px;
            text-transform: uppercase;
        }
        .btn-add-ba:hover { border-color: var(--gold-dim); color: var(--gold); background: rgba(201,168,76,0.03); }

        /* STYLE SELECTOR */
        .style-selector { display: flex; gap: 6px; margin-bottom: 0; }
        .style-btn {
            flex: 1;
            background: var(--input-bg);
            border: 1px solid var(--border);
            color: #666;
            padding: 9px 6px;
            font-size: 0.65rem;
            cursor: pointer;
            border-radius: 5px;
            letter-spacing: 1px;
            transition: all 0.2s;
            font-family: 'Noto Serif JP', serif;
        }
        .style-btn:hover { border-color: var(--gold-dim); color: #999; }
        .style-btn.active { border-color: var(--gold); color: var(--gold); background: rgba(201,168,76,0.06); }

        /* AI COPY BOX */
        .ai-copy-box {
            margin-top: 12px;
            background: #0a0a0a;
            border: 1px solid var(--gold-dim);
            border-radius: 6px;
            padding: 14px;
            display: none;
            animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-4px); } to { opacity: 1; transform: translateY(0); } }
        .ai-copy-header { font-size: 0.58rem; color: var(--gold); letter-spacing: 4px; margin-bottom: 10px; text-transform: uppercase; }
        .ai-loading { display: flex; align-items: center; gap: 8px; color: #555; font-size: 0.75rem; }
        .ai-loading::before {
            content: '';
            width: 12px; height: 12px;
            border: 1px solid var(--gold-dim);
            border-top-color: var(--gold);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            flex-shrink: 0;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .copy-chip {
            display: block;
            background: #111;
            color: #ccc;
            padding: 9px 12px;
            border-radius: 4px;
            font-size: 0.78rem;
            margin-bottom: 6px;
            cursor: pointer;
            border: 1px solid #2a2a2a;
            transition: all 0.15s;
            line-height: 1.5;
            font-family: 'Noto Serif JP', serif;
        }
        .copy-chip:last-child { margin-bottom: 0; }
        .copy-chip:hover { border-color: var(--gold-dim); color: var(--gold-light); background: #0f0f0f; }
        .copy-chip.selected { border-color: var(--gold); color: var(--gold); }

        /* SHARE AREA */
        .share-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 12px; }
        .share-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 11px;
            border-radius: 5px;
            font-size: 0.72rem;
            cursor: pointer;
            border: 1px solid;
            font-family: 'Noto Serif JP', serif;
            letter-spacing: 1px;
            transition: all 0.2s;
            text-decoration: none;
            color: inherit;
            background: var(--input-bg);
        }
        .share-btn-x { border-color: #333; color: #aaa; }
        .share-btn-x:hover { border-color: #888; color: #fff; background: #151515; }
        .share-btn-ig { border-color: rgba(192,80,220,0.3); color: #c878e8; }
        .share-btn-ig:hover { border-color: #c878e8; background: #120818; }
        .share-btn svg { width: 15px; height: 15px; fill: currentColor; flex-shrink: 0; }

        .ig-guide {
            background: #0a0510;
            border: 1px solid rgba(192,80,220,0.2);
            border-radius: 5px;
            padding: 14px;
            margin-top: 10px;
            display: none;
        }
        .ig-guide-title { font-size: 0.62rem; color: #c878e8; letter-spacing: 3px; margin-bottom: 8px; text-transform: uppercase; }
        .ig-guide p { font-size: 0.72rem; color: #888; line-height: 1.8; }
        .ig-guide strong { color: #c878e8; }

        /* CONTRAST COPY BOX */
        .contrast-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 10px; }
        .contrast-input-wrap { position: relative; }
        .contrast-tag {
            position: absolute;
            top: 8px; left: 10px;
            font-size: 0.52rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            pointer-events: none;
            z-index: 1;
        }
        .contrast-tag.before { color: #666; }
        .contrast-tag.after  { color: var(--gold); }
        .contrast-input-wrap textarea {
            padding-top: 26px;
            font-size: 0.75rem;
            line-height: 1.6;
            min-height: 70px;
        }
        .btn-gen-contrast {
            width: 100%;
            padding: 10px;
            background: rgba(201,168,76,0.07);
            border: 1px solid var(--gold-dim);
            color: var(--gold);
            font-size: 0.68rem;
            letter-spacing: 3px;
            cursor: pointer;
            border-radius: 5px;
            font-family: 'Cormorant Garamond', serif;
            transition: all 0.2s;
            text-transform: uppercase;
            margin-bottom: 10px;
        }
        .btn-gen-contrast:hover { background: rgba(201,168,76,0.14); }
        .btn-gen-contrast:disabled { opacity: 0.4; cursor: not-allowed; }

        .contrast-result {
            background: #0a0a0a;
            border: 1px solid var(--gold-dim);
            border-radius: 6px;
            padding: 14px;
            display: none;
            animation: fadeIn 0.3s ease;
        }
        .contrast-result-header { font-size: 0.58rem; color: var(--gold); letter-spacing: 4px; margin-bottom: 10px; text-transform: uppercase; }
        .contrast-chip {
            display: block;
            background: #0f0f0f;
            border: 1px solid #242424;
            border-radius: 5px;
            padding: 10px 12px;
            margin-bottom: 7px;
            cursor: pointer;
            transition: all 0.15s;
            font-family: 'Noto Serif JP', serif;
        }
        .contrast-chip:last-child { margin-bottom: 0; }
        .contrast-chip:hover { border-color: var(--gold-dim); }
        .contrast-chip.selected { border-color: var(--gold); }
        .contrast-chip .chip-before { font-size: 0.68rem; color: #666; margin-bottom: 5px; letter-spacing: 1px; }
        .contrast-chip .chip-arrow { color: var(--gold); font-size: 0.7rem; margin: 3px 0; }
        .contrast-chip .chip-after  { font-size: 0.82rem; color: #ddd; line-height: 1.5; }
        .contrast-chip.selected .chip-after { color: var(--gold-light); }

        /* PUBLISH BTN */
        .btn-publish {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #9a6c18, #C9A84C, #9a6c18);
            background-size: 200% 100%;
            color: #000;
            border: none;
            font-size: 0.78rem;
            font-weight: 600;
            letter-spacing: 4px;
            cursor: pointer;
            border-radius: 5px;
            margin-top: 24px;
            text-transform: uppercase;
            font-family: 'Cormorant Garamond', serif;
            transition: background-position 0.4s;
        }
        .btn-publish:hover { background-position: 100% 0; }

        /* â”â”â” PREVIEW PANEL â”â”â” */
        .preview-panel {
            background: #050505;
            overflow: hidden;
            position: relative;
        }
        .preview-label {
            position: absolute;
            top: 14px;
            right: 16px;
            font-size: 0.55rem;
            letter-spacing: 4px;
            color: #2a2a2a;
            z-index: 10;
            text-transform: uppercase;
            pointer-events: none;
        }
        #output-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>

<header class="app-header">
    <div class="app-logo">
        Roller Stone
        <span>Premium Proposal Builder</span>
    </div>
    <div style="font-size:0.6rem; color:#333; letter-spacing:3px; font-family:'Cormorant Garamond',serif;">PRESENTATION SYSTEM</div>
</header>

<div class="workspace">
    <!-- â”â”â” EDITOR â”â”â” -->
    <div class="editor-panel">

        <div class="section-title">OpenAI API è¨­å®š</div>
        <div class="api-key-row">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#555" stroke-width="2" stroke-linecap="round"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            <input type="password" id="api-key" placeholder="sk-... ï¼ˆä»»æ„ï¼‰" autocomplete="off">
        </div>
        <p class="api-key-hint">
            æœªå…¥åŠ›ã§ã‚‚å†…è”µã‚³ãƒ”ãƒ¼ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã‚­ãƒ¼ã¯ç«¯æœ«å†…ã®ã¿ã§ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚<br>
            <a href="https://platform.openai.com/api-keys" target="_blank">â†’ OpenAI APIã‚­ãƒ¼ã‚’å–å¾—ã™ã‚‹</a>
        </p>

        <div class="section-title">01 ï½œ ç‰©ä»¶ãƒ»ææ¡ˆæƒ…å ±</div>
        <div class="form-group">
            <label>ç‰©ä»¶å / ãŠå®¢æ§˜é‚¸å</label>
            <input type="text" id="title" value="Mé‚¸ å¤–æ§‹ãƒªãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³" placeholder="ä¾‹ï¼šç”°ä¸­æ§˜é‚¸ã€€å¤–æ§‹è¨ˆç”»" oninput="updatePreview()">
        </div>

        <div class="form-group">
            <label>ç¾çŠ¶ã®èª²é¡Œ â†’ ææ¡ˆã®ãƒã‚¤ãƒ³ãƒˆ <span style="color:#444;font-size:0.6rem;">â€” AIãŒå¯¾æ¯”ã‚³ãƒ”ãƒ¼ã‚’ç”Ÿæˆ</span></label>
            <div class="contrast-inputs">
                <div class="contrast-input-wrap">
                    <span class="contrast-tag before">ç¾çŠ¶ã®èª²é¡Œ</span>
                    <textarea id="issue" rows="3" placeholder="ä¾‹ï¼šé§è»Šå ´ãŒè€æœ½åŒ–&#10;é›‘è‰ãŒç›®ç«‹ã¤&#10;å¡€ãŒå¤ãæš—ã„å°è±¡" oninput="updatePreview()"></textarea>
                </div>
                <div class="contrast-input-wrap">
                    <span class="contrast-tag after">ææ¡ˆã®ãƒã‚¤ãƒ³ãƒˆ</span>
                    <textarea id="proposal-point" rows="3" placeholder="ä¾‹ï¼šçŸ³ç•³Ã—ç·‘åŒ–ã§&#10;é‡åšæ„Ÿã¨ä¸Šå“ã•ã‚’&#10;ä¸¡ç«‹ã•ã›ãŸç©ºé–“ã¸" oninput="updatePreview()"></textarea>
                </div>
            </div>
            <button class="btn-gen-contrast" id="btn-gen-contrast" onclick="generateContrastCopy()">
                âœ¦ &nbsp; AIã§å¯¾æ¯”ã‚³ãƒ”ãƒ¼ã‚’ç”Ÿæˆ
            </button>
            <div id="contrast-result" class="contrast-result">
                <div class="contrast-result-header">âœ¦ AI Generated Contrast Copy</div>
                <div id="contrast-chips"></div>
            </div>
        </div>

        <div class="form-group" style="display:none;">
            <input type="text" id="issue-copy" value="">
            <input type="text" id="proposal-copy" value="">
        </div>

        <div class="section-title">02 ï½œ ã‚¹ã‚¿ã‚¤ãƒ«é¸æŠ</div>
        <div class="style-selector">
            <button class="style-btn active" onclick="setStyle('luxury', this)">é‡åšãƒ»é«˜ç´š</button>
            <button class="style-btn" onclick="setStyle('modern', this)">æ´—ç·´ãƒ»ãƒ¢ãƒ€ãƒ³</button>
            <button class="style-btn" onclick="setStyle('nature', this)">è‡ªç„¶ãƒ»æƒ…ç·’</button>
        </div>

        <div class="section-title">03 ï½œ ãƒ¡ã‚¤ãƒ³ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«</div>
        <div class="form-group">
            <div class="file-upload-area">
                <span class="upload-icon">ğŸ–¼</span>
                <div class="upload-label" id="hero-label">HERO IMAGE ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</div>
                <input type="file" accept="image/*" onchange="processImg(this,'hero','hero-label',true)">
            </div>
        </div>
        <div class="form-group">
            <label>ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ <span style="color:#444;font-size:0.6rem;">â€” ç”»åƒï¼‹ã‚¹ã‚¿ã‚¤ãƒ«ã§è‡ªå‹•ç”Ÿæˆ</span></label>
            <input type="text" id="catch" value="" placeholder="ç”»åƒã¨ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é¸ã¶ã¨è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™" oninput="updatePreview()">
        </div>
        <div id="ai-box" class="ai-copy-box">
            <div class="ai-copy-header">âœ¦ AI Suggested Copy</div>
            <div id="ai-chips"><div class="ai-loading">AIãŒã‚³ãƒ”ãƒ¼ã‚’è€ƒãˆã¦ã„ã¾ã™...</div></div>
        </div>

        <div class="section-title">04 ï½œ Before / After</div>
        <div id="ba-sets-container"></div>
        <button class="btn-add-ba" onclick="addBaSet()">ï¼‹ &nbsp; ã‚»ãƒƒãƒˆã‚’è¿½åŠ </button>

        <div class="section-title">05 ï½œ ãƒ©ã‚¹ãƒˆãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«</div>
        <div class="form-group">
            <div class="file-upload-area">
                <span class="upload-icon">ğŸŒ™</span>
                <div class="upload-label" id="footer-label">ä¿¯ç°ãƒ»å¤œæ™¯ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</div>
                <input type="file" accept="image/*" onchange="processImg(this,'footer_img','footer-label')">
            </div>
        </div>

        <div class="section-title">06 ï½œ SNSã‚·ã‚§ã‚¢</div>
        <div class="form-group">
            <label>å…¬é–‹URLï¼ˆã‚·ã‚§ã‚¢ã«ä½¿ç”¨ï¼‰</label>
            <input type="text" id="lp-url" placeholder="https://yoursite.github.io/...">
        </div>
        <div class="share-buttons">
            <button class="share-btn share-btn-x" onclick="doXShare()">
                <svg viewBox="0 0 24 24"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-4.714-6.231-5.401 6.231H2.747l7.73-8.835L1.254 2.25H8.08l4.253 5.622zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                X ã§ã‚·ã‚§ã‚¢
            </button>
            <button class="share-btn share-btn-ig" onclick="doIgShare()">
                <svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 1 0 0 12.324 6.162 6.162 0 0 0 0-12.324zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm6.406-11.845a1.44 1.44 0 1 0 0 2.881 1.44 1.44 0 0 0 0-2.881z"/></svg>
                Instagram ã¸
            </button>
        </div>
        <div id="ig-guide" class="ig-guide">
            <div class="ig-guide-title">âœ¦ Instagram æŠ•ç¨¿æ‰‹é †</div>
            <p>
                <strong>â‘  ç”»åƒãŒä¿å­˜ã•ã‚Œã¾ã—ãŸ</strong><br>
                Instagramã‚¢ãƒ—ãƒªã‚’é–‹ã„ã¦ <strong>æ–°è¦æŠ•ç¨¿ â†’ ã‚«ãƒ¡ãƒ©ãƒ­ãƒ¼ãƒ«</strong> ã‹ã‚‰ä¿å­˜ã—ãŸç”»åƒã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚<br><br>
                <strong>â‘¡ ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼æ¸ˆã¿</strong><br>
                <span id="ig-caption-preview" style="color:#666; font-size:0.68rem;"></span>
            </p>
        </div>

        <button class="btn-publish" onclick="preparePublish()">â–² &nbsp; å…¬é–‹ç”¨ index.html ã‚’ç”Ÿæˆ</button>

    </div>

    <!-- â”â”â” PREVIEW â”â”â” -->
    <div class="preview-panel">
        <div class="preview-label">LIVE PREVIEW</div>
        <iframe id="output-iframe"></iframe>
    </div>
</div>

<script>
    const images = { hero:'', footer_img:'' };
    // BA sets: [{id, before:'', after:''}]
    let baSets = [];
    let baIdCounter = 0;
    let currentStyle = 'luxury';
    let heroUploaded = false;
    const ANALYTICS_ID = "G-9KY5C7XC36";

    // â”€â”€â”€ BA Set Management â”€â”€â”€
    function addBaSet() {
        const id = ++baIdCounter;
        baSets.push({ id, before: '', after: '' });
        renderBaSets();
        updatePreview();
    }

    function removeBaSet(id) {
        if (baSets.length <= 1) return; // æœ€ä½1ã‚»ãƒƒãƒˆã¯æ®‹ã™
        baSets = baSets.filter(s => s.id !== id);
        renderBaSets();
        updatePreview();
    }

    function renderBaSets() {
        const container = document.getElementById('ba-sets-container');
        container.innerHTML = '';
        baSets.forEach((set, idx) => {
            const div = document.createElement('div');
            div.className = 'ba-set';
            div.innerHTML = `
                <div class="ba-set-header">
                    <span class="ba-set-label">ã‚»ãƒƒãƒˆ ${String(idx + 1).padStart(2,'0')}</span>
                    <button class="ba-delete-btn" onclick="removeBaSet(${set.id})" title="å‰Šé™¤">âœ•</button>
                </div>
                <div class="ba-pair">
                    <div class="file-upload-area">
                        <div class="upload-label ${set.before ? 'has-file' : ''}" id="b-label-${set.id}">
                            ${set.before ? 'âœ“ BEFORE' : 'â† BEFORE'}
                        </div>
                        <input type="file" accept="image/*" onchange="processBaImg(this, ${set.id}, 'before')">
                    </div>
                    <div class="file-upload-area">
                        <div class="upload-label ${set.after ? 'has-file' : ''}" id="a-label-${set.id}">
                            ${set.after ? 'âœ“ AFTER' : 'AFTER â†’'}
                        </div>
                        <input type="file" accept="image/*" onchange="processBaImg(this, ${set.id}, 'after')">
                    </div>
                </div>`;
            container.appendChild(div);
        });
    }

    function processBaImg(input, setId, side) {
        if (!input.files[0]) return;
        const reader = new FileReader();
        reader.onload = (e) => {
            const img = new Image();
            img.onload = () => {
                const canvas = document.createElement('canvas');
                let w = img.width, h = img.height;
                if (w > 1920) { h = h * 1920 / w; w = 1920; }
                canvas.width = w; canvas.height = h;
                canvas.getContext('2d').drawImage(img, 0, 0, w, h);
                const dataUrl = canvas.toDataURL('image/jpeg', 0.72);
                const set = baSets.find(s => s.id === setId);
                if (set) {
                    set[side] = dataUrl;
                    const labelEl = document.getElementById(`${side === 'before' ? 'b' : 'a'}-label-${setId}`);
                    if (labelEl) {
                        labelEl.textContent = side === 'before' ? 'âœ“ BEFORE' : 'âœ“ AFTER';
                        labelEl.classList.add('has-file');
                    }
                    updatePreview();
                }
            };
            img.src = e.target.result;
        };
        reader.readAsDataURL(input.files[0]);
    }

    // â”€â”€â”€ Style â”€â”€â”€
    function setStyle(style, btn) {
        currentStyle = style;
        document.querySelectorAll('.style-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        if (heroUploaded) generateAICopy();
    }

    // â”€â”€â”€ Hero / Footer Image â”€â”€â”€
    function processImg(input, key, labelId, isHero = false) {
        if (!input.files[0]) return;
        const label = document.getElementById(labelId);
        const name = input.files[0].name;
        label.textContent = name.length > 22 ? name.substring(0, 20) + '...' : name;
        label.classList.add('has-file');

        const reader = new FileReader();
        reader.onload = (e) => {
            const img = new Image();
            img.onload = () => {
                const canvas = document.createElement('canvas');
                let w = img.width, h = img.height;
                if (w > 1920) { h = h * 1920 / w; w = 1920; }
                canvas.width = w; canvas.height = h;
                canvas.getContext('2d').drawImage(img, 0, 0, w, h);
                images[key] = canvas.toDataURL('image/jpeg', 0.72);
                if (isHero) { heroUploaded = true; generateAICopy(); }
                updatePreview();
            };
            img.src = e.target.result;
        };
        reader.readAsDataURL(input.files[0]);
    }

    // â”€â”€â”€ Contrast Copy Generation â”€â”€â”€
    async function generateContrastCopy() {
        const issue   = document.getElementById('issue').value.trim();
        const point   = document.getElementById('proposal-point').value.trim();
        if (!issue && !point) {
            alert('ã€Œç¾çŠ¶ã®èª²é¡Œã€ã¨ã€Œææ¡ˆã®ãƒã‚¤ãƒ³ãƒˆã€ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
            return;
        }
        const btn = document.getElementById('btn-gen-contrast');
        const box = document.getElementById('contrast-result');
        const chips = document.getElementById('contrast-chips');
        btn.disabled = true;
        box.style.display = 'block';
        chips.innerHTML = '<div class="ai-loading">AIãŒå¯¾æ¯”ã‚³ãƒ”ãƒ¼ã‚’è€ƒãˆã¦ã„ã¾ã™...</div>';

        const apiKey = document.getElementById('api-key').value.trim();
        if (!apiKey || !apiKey.startsWith('sk-')) {
            await new Promise(r => setTimeout(r, 800));
            useLocalContrastCopy(issue, point);
            btn.disabled = false;
            return;
        }
        try {
            const res = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${apiKey}` },
                body: JSON.stringify({
                    model: 'gpt-4o-mini',
                    messages: [
                        { role: 'system', content: 'ã‚ãªãŸã¯é«˜ç´šä½å®…å¤–æ§‹å·¥äº‹ã®ææ¡ˆæ›¸å°‚é–€ã‚³ãƒ”ãƒ¼ãƒ©ã‚¤ã‚¿ãƒ¼ã§ã™ã€‚ã€Œç¾çŠ¶ã®èª²é¡Œã€ã¨ã€Œææ¡ˆã®ãƒã‚¤ãƒ³ãƒˆã€ã‚’ã‚‚ã¨ã«ã€æ–½ä¸»ã¸ã®å¯¾æ¯”å‹ã‚³ãƒ”ãƒ¼ã‚’3æ¡ˆç”Ÿæˆã—ã¦ãã ã•ã„ã€‚å„æ¡ˆã¯ä»¥ä¸‹ã®JSONé…åˆ—å½¢å¼ã®ã¿ã§å‡ºåŠ›ï¼ˆèª¬æ˜ãƒ»ç•ªå·ä¸è¦ï¼‰:\n[{"before":"èª²é¡Œã‚’çŸ­ã15å­—ä»¥å†…","after":"ææ¡ˆã®é­…åŠ›ã‚’æ ¼èª¿é«˜ã20ã€œ35å­—"},...]' },
                        { role: 'user', content: `ç¾çŠ¶ã®èª²é¡Œï¼š${issue}\nææ¡ˆã®ãƒã‚¤ãƒ³ãƒˆï¼š${point}\nã‚¹ã‚¿ã‚¤ãƒ«ï¼š${currentStyle}` }
                    ],
                    max_tokens: 400, temperature: 0.85
                })
            });
            if (!res.ok) throw new Error('API error');
            const data = await res.json();
            const raw = data.choices[0].message.content.replace(/```json|```/g,'').trim();
            renderContrastChips(JSON.parse(raw).slice(0, 3));
        } catch (err) {
            console.warn('Contrast copy error:', err.message);
            useLocalContrastCopy(issue, point);
        }
        btn.disabled = false;
    }

    function useLocalContrastCopy(issue, point) {
        const fallbacks = {
            luxury: [
                { before: 'è€æœ½åŒ–ã—ãŸå¤–æ§‹', after: 'çŸ³ç©ã¿ã®é¢¨æ ¼ãŒã€é‚¸å®…ã®ä¾¡å€¤ã‚’é™ã‹ã«èªã‚‹ã€‚' },
                { before: 'æš—ãé‡ã„å°è±¡ã®é–€æ§‹ãˆ', after: 'æ­³æœˆãŒè¨¼æ˜ã™ã‚‹ã€æœ¬ç‰©ã®é¢¨æ ¼ã‚’ã“ã“ã«ã€‚' },
                { before: 'æ™‚ä»£é…ã‚Œã®å¤–è¦³', after: 'å¨é¢¨å ‚ã€…ã€‚ä½ã¾ã„ã®çŸœæŒã‚’å†å®šç¾©ã™ã‚‹ã€‚' }
            ],
            modern: [
                { before: 'é›‘ç„¶ã¨ã—ã¦æ•£æ¼«ãªå°è±¡', after: 'ä½™ç™½ã«å®¿ã‚‹å“æ ¼ã€‚æœ¬è³ªçš„ãªç¾ã‚’æãã€‚' },
                { before: 'å¤ã•ãŒç›®ç«‹ã¤å¤–æ§‹', after: 'æ—¥å¸¸ã‚’ã‚¢ãƒ¼ãƒˆã«å¤‰ãˆã‚‹ã€æ´—ç·´ã®ãƒ©ã‚¤ãƒ³ã€‚' },
                { before: 'æš—ãé–‰ã˜ãŸé›°å›²æ°—', after: 'éƒ½å¸‚ã®é¢¨æ™¯ã«ã€é™ã‹ãªå­˜åœ¨æ„Ÿã‚’åˆ»ã‚€ã€‚' }
            ],
            nature: [
                { before: 'æ®ºé¢¨æ™¯ã§æ®ºä¼ã¨ã—ãŸå¤–è¦³', after: 'å…‰ã¨å½±ãŒç¹”ã‚Šãªã™ã€ã“ã®å ´æ‰€ã ã‘ã®å­£ç¯€ã€‚' },
                { before: 'ç·‘ã®ãªã„å†·ãŸã„å°è±¡', after: 'è‡ªç„¶ã¨å…±é³´ã™ã‚‹ã€ä¸Šè³ªãªæš®ã‚‰ã—ã®å…¥å£ã€‚' },
                { before: 'ç„¡æ©Ÿè³ªãªå¤–æ§‹', after: 'å„ªã—ãè¿ãˆå…¥ã‚Œã‚‹ã€ç·‘ã¨çŸ³ã®è©©æƒ…ã€‚' }
            ]
        };
        const items = fallbacks[currentStyle].map((f, i) => ({
            before: i === 0 && issue ? issue.split('\n')[0] : f.before,
            after:  i === 0 && point ? point.replace(/\n/g,'ã€€') : f.after
        }));
        renderContrastChips(items);
    }

    function renderContrastChips(items) {
        const chips = document.getElementById('contrast-chips');
        chips.innerHTML = '';
        items.forEach((item, i) => {
            const chip = document.createElement('div');
            chip.className = 'contrast-chip';
            chip.innerHTML = `
                <div class="chip-before">${item.before}</div>
                <div class="chip-arrow">â–¼</div>
                <div class="chip-after">${item.after}</div>`;
            chip.onclick = () => {
                document.querySelectorAll('.contrast-chip').forEach(c => c.classList.remove('selected'));
                chip.classList.add('selected');
                document.getElementById('issue-copy').value    = item.before;
                document.getElementById('proposal-copy').value = item.after;
                updatePreview();
            };
            chips.appendChild(chip);
            if (i === 0) chip.click();
        });
    }

    // â”€â”€â”€ AI Copy â”€â”€â”€
    async function generateAICopy() {
        const apiKey = document.getElementById('api-key').value.trim();
        const box = document.getElementById('ai-box');
        const chips = document.getElementById('ai-chips');

        box.style.display = 'block';
        chips.innerHTML = '<div class="ai-loading">AIãŒã‚³ãƒ”ãƒ¼ã‚’è€ƒãˆã¦ã„ã¾ã™...</div>';

        const styleMap = { luxury: 'é‡åšã§å¨å³ã‚ã‚‹é«˜ç´šé‚¸å®…', modern: 'æ´—ç·´ã•ã‚ŒãŸãƒ¢ãƒ€ãƒ³ã§ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªä½å®…', nature: 'è‡ªç„¶ã¨èª¿å’Œã—ãŸæƒ…ç·’ã‚ã‚‹å’Œã®ä½å®…' };

        if (!apiKey || !apiKey.startsWith('sk-')) {
            await new Promise(r => setTimeout(r, 700));
            useLocalCopy();
            return;
        }

        try {
            const res = await fetch('https://api.openai.com/v1/chat/completions', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    model: 'gpt-4o-mini',
                    messages: [
                        {
                            role: 'system',
                            content: 'ã‚ãªãŸã¯é«˜ç´šä½å®…ã®å¤–æ§‹ãƒ»ã‚¨ã‚¯ã‚¹ãƒ†ãƒªã‚¢å·¥äº‹å°‚é–€ã®åºƒå‘Šã‚³ãƒ”ãƒ¼ãƒ©ã‚¤ã‚¿ãƒ¼ã§ã™ã€‚ææ¡ˆæ›¸ã®ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ã¨ã—ã¦ä½¿ã†ã€æ ¼èª¿é«˜ãç°¡æ½”ãªæ—¥æœ¬èªã‚³ãƒ”ãƒ¼ã‚’3æ¡ˆç”Ÿæˆã—ã¦ãã ã•ã„ã€‚å„æ¡ˆã¯15ã€œ35æ–‡å­—ç¨‹åº¦ã€‚ç•ªå·ãƒ»è¨˜å·ãƒ»èª¬æ˜æ–‡ã¯ä¸è¦ã§ã€ã‚³ãƒ”ãƒ¼æœ¬æ–‡ã®ã¿ã‚’1è¡Œãšã¤å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚'
                        },
                        {
                            role: 'user',
                            content: `ã€Œ${styleMap[currentStyle]}ã€å‘ã‘ã®å¤–æ§‹ææ¡ˆæ›¸ç”¨ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ã‚’3æ¡ˆãŠé¡˜ã„ã—ã¾ã™ã€‚`
                        }
                    ],
                    max_tokens: 220,
                    temperature: 0.9
                })
            });

            if (!res.ok) throw new Error('API error ' + res.status);
            const data = await res.json();
            const lines = data.choices[0].message.content
                .split('\n')
                .map(l => l.replace(/^[\d\.\-\sãƒ»]+/, '').trim())
                .filter(l => l.length > 5)
                .slice(0, 3);

            renderChips(lines);
        } catch (err) {
            console.warn('OpenAI API error:', err.message);
            useLocalCopy();
        }
    }

    function useLocalCopy() {
        const lib = {
            luxury: ["æ­³æœˆãŒè¨¼æ˜ã™ã‚‹ã€æœ¬ç‰©ã®é¢¨æ ¼ã‚’ã“ã“ã«ã€‚", "å¨é¢¨å ‚ã€…ã€‚ä½ã¾ã„ã®ä¾¡å€¤ã‚’æ¬¡ä¸–ä»£ã¸ç¶™ãã€‚", "çŸ³ç©ã¿ãŒèªã‚‹ã€é‚¸å®…ã®çŸœæŒã¨ç¾å­¦ã€‚"],
            modern: ["ä½™ç™½ã«å®¿ã‚‹å“æ ¼ã€‚æœ¬è³ªçš„ãªç¾ã‚’æãã€‚", "æ—¥å¸¸ã‚’ã‚¢ãƒ¼ãƒˆã«å¤‰ãˆã‚‹ã€æ´—ç·´ã®ãƒ©ã‚¤ãƒ³ã€‚", "éƒ½å¸‚ã®é¢¨æ™¯ã«ã€é™ã‹ãªå­˜åœ¨æ„Ÿã‚’åˆ»ã‚€ã€‚"],
            nature: ["å…‰ã¨å½±ãŒç¹”ã‚Šãªã™ã€ã“ã®å ´æ‰€ã ã‘ã®å­£ç¯€ã€‚", "è‡ªç„¶ã¨å…±é³´ã™ã‚‹ã€ä¸Šè³ªãªæš®ã‚‰ã—ã®å…¥å£ã€‚", "å„ªã—ãè¿ãˆå…¥ã‚Œã‚‹ã€ç·‘ã¨çŸ³ã®è©©æƒ…ã€‚"]
        };
        renderChips(lib[currentStyle]);
    }

    function renderChips(lines) {
        const chips = document.getElementById('ai-chips');
        chips.innerHTML = '';
        lines.forEach((text, i) => {
            const chip = document.createElement('div');
            chip.className = 'copy-chip';
            chip.textContent = text;
            chip.onclick = () => {
                document.querySelectorAll('.copy-chip').forEach(c => c.classList.remove('selected'));
                chip.classList.add('selected');
                document.getElementById('catch').value = text;
                updatePreview();
            };
            chips.appendChild(chip);
            if (i === 0) chip.click();
        });
    }

    // â”€â”€â”€ Share â”€â”€â”€
    function doXShare() {
        const url = document.getElementById('lp-url').value.trim();
        const copy = document.getElementById('catch').value;
        const title = document.getElementById('title').value;
        const text = [copy, title, url, '#å¤–æ§‹å·¥äº‹ #ã‚¨ã‚¯ã‚¹ãƒ†ãƒªã‚¢ #ä½å®…ãƒ‡ã‚¶ã‚¤ãƒ³'].filter(Boolean).join('\n\n');
        window.open('https://twitter.com/intent/tweet?text=' + encodeURIComponent(text), '_blank');
    }

    function doIgShare() {
        if (!images.hero) {
            alert('ãƒ¡ã‚¤ãƒ³ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‹ã‚‰å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚');
            return;
        }

        // ãƒ’ãƒ¼ãƒ­ãƒ¼ç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        const a = document.createElement('a');
        a.href = images.hero;
        a.download = 'proposal-hero.jpg';
        a.click();

        // ã‚­ãƒ£ãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸
        const copy = document.getElementById('catch').value;
        const title = document.getElementById('title').value;
        const url = document.getElementById('lp-url').value.trim();
        const caption = [copy, title, url, '#å¤–æ§‹å·¥äº‹ #ã‚¨ã‚¯ã‚¹ãƒ†ãƒªã‚¢ #ä½å®…ãƒ‡ã‚¶ã‚¤ãƒ³ #ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¹ãƒˆãƒ¼ãƒ³'].filter(Boolean).join('\n\n');
        navigator.clipboard.writeText(caption).catch(() => {});

        document.getElementById('ig-guide').style.display = 'block';
        document.getElementById('ig-caption-preview').textContent = caption.substring(0, 60) + '...(ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ)';

        // ãƒ¢ãƒã‚¤ãƒ«ã§Instagramã‚¢ãƒ—ãƒªèµ·å‹•ã‚’è©¦ã¿ã‚‹
        setTimeout(() => { window.location.href = 'instagram://app'; }, 600);
    }

    // â”€â”€â”€ Generate Output HTML â”€â”€â”€
    function generateHTML() {
        const title      = document.getElementById('title').value || 'å¤–æ§‹ãƒªãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ææ¡ˆ';
        const catchphrase= document.getElementById('catch').value || '';
        const issueCopy  = document.getElementById('issue-copy').value || '';
        const propCopy   = document.getElementById('proposal-copy').value || '';
        const noImg = 'https://via.placeholder.com/1200x800/111/1a1a1a?text=NO+IMAGE';

        // ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
        const heroContent = (issueCopy || propCopy) ? `
            <div class="hero-contrast">
                ${issueCopy ? `<div class="hero-issue"><span class="issue-label">ç¾çŠ¶</span>${issueCopy}</div>` : ''}
                ${(issueCopy && propCopy) ? `<div class="hero-arrow">â–¼</div>` : ''}
                ${propCopy  ? `<div class="hero-proposal">${propCopy}</div>` : ''}
            </div>` : '';

        const catchLine = catchphrase ? `<div class="catch">${catchphrase}</div>` : '';

        // BA sections
        const baSections = baSets.map((set, idx) => {
            const beforeSrc = set.before || noImg;
            const afterSrc  = set.after  || noImg;
            const num = String(idx + 1).padStart(2, '0');
            return `<div class="label">Perspective Comparison &nbsp;&nbsp; ${num}</div>
<div class="ba-wrap"><img src="${beforeSrc}" class="ba-img"><img src="${afterSrc}" class="ba-img after-img"><div class="handle"></div></div>`;
        }).join('\n');

        return `<!DOCTYPE html><html lang="ja"><head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>${title}</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@200;300;400&family=Noto+Serif+JP:wght@200;300&display=swap" rel="stylesheet">
<script async src="https://www.googletagmanager.com/gtag/js?id=${ANALYTICS_ID}"><\/script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','${ANALYTICS_ID}');<\/script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#000;color:#fff;font-family:'Noto Serif JP','Cormorant Garamond',serif;overflow-x:hidden}
.hero{height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:flex-end;text-align:center;background:url('${images.hero || noImg}') center/cover no-repeat;position:relative;padding-bottom:0}
.hero::after{content:'';position:absolute;inset:0;background:linear-gradient(to bottom,rgba(0,0,0,.1) 0%,rgba(0,0,0,.55) 50%,rgba(0,0,0,.92) 100%)}
/* â”€â”€ ã‚¿ã‚¤ãƒˆãƒ«ãƒ–ãƒ­ãƒƒã‚¯ â”€â”€ */
.hero-title-block{position:relative;z-index:10;padding:36px 50px 40px;width:100%;max-width:900px;animation:fadeUp 1s ease both}
@keyframes fadeUp{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
.catch{color:#C9A84C;font-size:.78rem;letter-spacing:5px;margin-bottom:16px;font-weight:300}
.hero-title{font-family:'Cormorant Garamond',serif;font-size:2rem;font-weight:200;letter-spacing:8px;text-transform:uppercase;line-height:1.6;border-top:1px solid rgba(201,168,76,.2);padding-top:18px}
/* â”€â”€ å¯¾æ¯”ã‚³ãƒ”ãƒ¼ â”€â”€ */
.hero-contrast{position:relative;z-index:10;width:100%;background:rgba(0,0,0,.72);backdrop-filter:blur(20px);border-top:1px solid rgba(201,168,76,.2);padding:28px 0 32px;animation:fadeUp 1.2s .2s ease both}
.hero-issue{font-size:.75rem;color:#888;letter-spacing:3px;margin-bottom:6px;font-family:'Noto Serif JP',serif}
.issue-label{display:inline-block;background:rgba(255,255,255,.06);border:1px solid #333;color:#666;font-size:.55rem;letter-spacing:3px;padding:3px 8px;margin-right:10px;border-radius:2px;vertical-align:middle;text-transform:uppercase}
.hero-arrow{font-size:.65rem;color:rgba(201,168,76,.5);margin:10px 0;letter-spacing:2px}
.hero-proposal{font-size:1.15rem;color:#E8D5A3;font-weight:300;letter-spacing:4px;font-family:'Noto Serif JP',serif;line-height:1.8;padding:0 40px}
/* â”€â”€ ãƒ©ãƒ™ãƒ«ãƒ»BAãƒ»å…±é€š â”€â”€ */
.label{color:#C9A84C;text-align:center;font-size:.58rem;letter-spacing:7px;margin:100px 0 40px;text-transform:uppercase;opacity:.75;font-family:'Cormorant Garamond',serif}
.ba-wrap{width:90%;max-width:880px;margin:0 auto 90px;aspect-ratio:16/9;overflow:hidden;border:1px solid #1e1e1e;position:relative;cursor:ew-resize}
.ba-img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;pointer-events:none;display:block}
.after-img{clip-path:inset(0 0 0 50%);z-index:2}
.handle{position:absolute;top:0;bottom:0;left:50%;width:2px;background:#C9A84C;z-index:10;pointer-events:none}
.handle::after{content:'â—€  SLIDE  â–¶';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,.9);color:#C9A84C;padding:9px 16px;border:1px solid rgba(201,168,76,.6);font-size:9px;letter-spacing:3px;white-space:nowrap;font-family:'Cormorant Garamond',serif}
.last-img{width:100%;display:block;filter:contrast(1.05) brightness(.96);margin-top:60px}
footer{padding:100px 0;text-align:center;background:#030303;color:#252525;letter-spacing:6px;font-size:.6rem;border-top:1px solid #111;font-family:'Cormorant Garamond',serif}
</style></head><body>
<div class="hero">
  <div class="hero-title-block">
    ${catchLine}
    <div class="hero-title">${title}</div>
  </div>
  ${heroContent}
</div>
${baSections}
<div class="label">Detail &nbsp;&nbsp; Atmosphere</div>
<img src="${images.footer_img || noImg}" class="last-img">
<footer>ROLLER STONE &nbsp;Â·&nbsp; PREMIUM EXTERIOR PROPOSAL</footer>
<script>
document.querySelectorAll('.ba-wrap').forEach(wrap=>{
  const handle=wrap.querySelector('.handle'),after=wrap.querySelector('.after-img');
  const move=e=>{
    const r=wrap.getBoundingClientRect();
    const cx=e.touches?e.touches[0].clientX:e.clientX;
    const p=Math.max(0,Math.min(100,(cx-r.left)/r.width*100));
    after.style.clipPath='inset(0 0 0 '+p+'%)';
    handle.style.left=p+'%';
  };
  wrap.addEventListener('mousemove',move);
  wrap.addEventListener('touchmove',move,{passive:true});
});
<\/script></body></html>`;
    }

    function updatePreview() {
        const doc = document.getElementById('output-iframe').contentWindow.document;
        doc.open(); doc.write(generateHTML()); doc.close();
    }

    function preparePublish() {
        const blob = new Blob([generateHTML()], { type: 'text/html' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'index.html';
        a.click();
        setTimeout(() => alert('index.html ã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚\nGitHub Pages ç­‰ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦å…¬é–‹URLã‚’SNSã‚·ã‚§ã‚¢æ¬„ã«å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚'), 300);
    }

    window.onload = () => {
        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ2ã‚»ãƒƒãƒˆ
        addBaSet();
        addBaSet();
        updatePreview();
    };
</script>
</body>
</html>
