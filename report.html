<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RSæ–½å·¥å ±å‘ŠLPã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
<!-- ä½æ‰€è‡ªå‹•å…¥åŠ›ãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
<script src="https://yubinbango.github.io/yubinbango/yubinbango.js" charset="UTF-8"></script>
<style>
    :root { --gold: #c5a059; --bg: #0a0a0a; --card-bg: #1a1a1a; }
    body { background: var(--bg); color: #fff; font-family: sans-serif; margin: 0; padding: 20px; box-sizing: border-box; }
    h1, h2, h3 { color: var(--gold); text-align: center; }
    
    /* å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .input-section { max-width: 600px; margin: 0 auto 40px; background: #222; padding: 20px; border-radius: 15px; border: 1px solid #444; }
    label { display: block; margin-top: 15px; color: var(--gold); font-weight: bold; font-size: 0.9rem; }
    input[type="text"], input[type="number"], input[type="date"], input[type="url"], textarea, select {
        width: 100%; padding: 12px; margin-top: 5px; background: #000; border: 1px solid #555; color: #fff; border-radius: 5px; box-sizing: border-box; font-size: 16px;
    }
    textarea { height: 100px; resize: vertical; }
    
    /* AIãƒœã‚¿ãƒ³ */
    .btn-ai {
        background: #333; color: var(--gold); border: 1px solid var(--gold);
        padding: 8px 15px; border-radius: 20px; font-size: 0.8rem; cursor: pointer;
        font-weight: bold; margin-top: 5px; display: inline-flex; align-items: center; gap: 5px;
    }
    .btn-ai:hover { background: var(--gold); color: #000; }
    .ai-note { font-size: 0.75rem; color: #aaa; margin-top: 5px; line-height: 1.4; }

    /* ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢ */
    .file-input-wrapper { margin-top: 5px; border: 1px dashed #555; padding: 20px; text-align: center; border-radius: 5px; cursor: pointer; position: relative; overflow: hidden; background: #111; }
    .file-input-wrapper:hover { border-color: var(--gold); }
    .preview-img { width: 100%; max-height: 200px; object-fit: contain; display: none; margin-top: 10px; border-radius: 5px; border: 1px solid #333; }

    /* ãƒ¡ã‚¤ãƒ³æ“ä½œãƒœã‚¿ãƒ³ */
    button#generateBtn {
        display: block; width: 100%; padding: 18px; background: linear-gradient(135deg, #c5a059, #e6c88b); 
        color: #000; font-weight: bold; border: none; border-radius: 30px; font-size: 1.1rem; margin-top: 30px; cursor: pointer;
        box-shadow: 0 4px 15px rgba(197, 160, 89, 0.4); transition: transform 0.2s;
    }
    button#generateBtn:active { transform: scale(0.98); }

    .line-copy-btn {
        background: #06c755; color: #fff; border: none; padding: 12px; width: 100%; border-radius: 10px;
        font-weight: bold; margin-top: 30px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 8px;
    }
</style>
</head>
<body>

    <h1 style="margin-bottom: 5px;">RSW DX PORTAL</h1>
    <h2 style="font-size: 1rem; color: #888; margin-top: 0;">æ–½å·¥å ±å‘ŠLPã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</h2>

    <!-- å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  -->
    <div class="input-section h-adr">
        <span class="p-country-name" style="display:none;">Japan</span>
        
        <label>æ–½å·¥å®Œäº†æ—¥</label>
        <input type="date" id="date">

        <label>é¡§å®¢å (æ§˜)</label>
        <input type="text" id="customerName" placeholder="ä¾‹ï¼šå±±ç”° å¤ªéƒ">

        <label>éƒµä¾¿ç•ªå· (ãƒã‚¤ãƒ•ãƒ³ãªã—)</label>
        <input type="text" class="p-postal-code" size="8" maxlength="8" placeholder="1234567">
        
        <label>ä½æ‰€ (è‡ªå‹•å…¥åŠ›)</label>
        <input type="text" class="p-region p-locality p-street-address p-extended-address" id="address">

        <label>èªå®šæ–½å·¥åº—å</label>
        <input type="text" id="shopName" value="èªå®šæ–½å·¥åº—">

        <hr style="border-color: #333; margin: 20px 0;">

        <label>ãƒ¡ã‚¤ãƒ³ç”»åƒ (å®Œäº†å†™çœŸ)</label>
        <div class="file-input-wrapper">
            <span id="text-imgMain">ã‚¿ãƒƒãƒ—ã—ã¦å†™çœŸã‚’é¸æŠ</span>
            <input type="file" id="imgMain" accept="image/*" style="opacity:0; position:absolute; top:0; left:0; width:100%; height:100%; cursor:pointer;" onchange="previewFile('imgMain')">
            <img id="preview-imgMain" class="preview-img">
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <div>
                <label>Beforeç”»åƒ</label>
                <div class="file-input-wrapper">
                    <span id="text-imgBefore">é¸æŠ</span>
                    <input type="file" id="imgBefore" accept="image/*" style="opacity:0; position:absolute; top:0; left:0; width:100%; height:100%; cursor:pointer;" onchange="previewFile('imgBefore')">
                    <img id="preview-imgBefore" class="preview-img">
                </div>
            </div>
            <div>
                <label>Afterç”»åƒ</label>
                <div class="file-input-wrapper">
                    <span id="text-imgAfter">é¸æŠ</span>
                    <input type="file" id="imgAfter" accept="image/*" style="opacity:0; position:absolute; top:0; left:0; width:100%; height:100%; cursor:pointer;" onchange="previewFile('imgAfter')">
                    <img id="preview-imgAfter" class="preview-img">
                </div>
            </div>
        </div>

        <label>æ–½å·¥é¢¨æ™¯ / é›†åˆå†™çœŸ (ä»»æ„)</label>
        <div class="file-input-wrapper">
            <span id="text-imgSub">ã‚¿ãƒƒãƒ—ã—ã¦å†™çœŸã‚’é¸æŠ</span>
            <input type="file" id="imgSub" accept="image/*" style="opacity:0; position:absolute; top:0; left:0; width:100%; height:100%; cursor:pointer;" onchange="previewFile('imgSub')">
            <img id="preview-imgSub" class="preview-img">
        </div>

        <hr style="border-color: #333; margin: 20px 0;">

        <label>ã“ã ã‚ã‚Šãƒã‚¤ãƒ³ãƒˆ</label>
        <div class="ai-note">ğŸ’¡ å˜èªå…¥åŠ›ã§OKï¼ˆä¾‹ï¼šæ—©ã‹ã£ãŸã€ç¶ºéº—ã€ã‹ã£ã“ã„ã„ï¼‰</div>
        <textarea id="kodawari" placeholder="ä¾‹ï¼šæ—¢å­˜ã®ã²ã³å‰²ã‚Œã‚’æ´»ã‹ã—ãŸãƒ‡ã‚¶ã‚¤ãƒ³ã«ã—ã¾ã—ãŸ..."></textarea>
        <button class="btn-ai" onclick="optimizeText('kodawari')">âœ¨ AIã§æ–‡ç« ã‚’æ•´ãˆã‚‹</button>

        <div style="display: flex; gap: 10px; margin-top:15px;">
            <div style="flex:1;">
                <label>æ–½å·¥é¢ç© (ã¡)</label>
                <input type="text" id="area" placeholder="30">
            </div>
            <div style="flex:1;">
                <label>æ–½å·¥æ—¥æ•° (æ—¥)</label>
                <input type="text" id="days" placeholder="3">
            </div>
        </div>
        <label>ä½¿ç”¨ã‚«ãƒ©ãƒ¼</label>
        <input type="text" id="color" placeholder="ãƒŸãƒ«ã‚¯ãƒ†ã‚£ãƒ¼, ãƒ–ãƒ©ãƒƒã‚¯">

        <label>ãŠå®¢æ§˜ã®å£°</label>
        <div class="ai-note">ğŸ’¡ å˜èªå…¥åŠ›ã§OKï¼ˆä¾‹ï¼šå–œã‚“ã§ãŸã€æ˜ã‚‹ããªã£ãŸï¼‰</div>
        <textarea id="voice" placeholder="ä¾‹ï¼šæƒ³åƒä»¥ä¸Šã®ä»•ä¸ŠãŒã‚Šã§æ„Ÿå‹•ã—ã¾ã—ãŸï¼"></textarea>
        <button class="btn-ai" onclick="optimizeText('voice')">âœ¨ AIã§æ–‡ç« ã‚’æ•´ãˆã‚‹</button>

        <label>å…¬å¼LINE URL (å•ã„åˆã‚ã›ãƒœã‚¿ãƒ³ç”¨)</label>
        <input type="text" id="lineUrl" placeholder="https://line.me/...">

        <button class="line-copy-btn" onclick="copyLineText()">
            ğŸ’¬ LINEå ±å‘Šç”¨ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼
        </button>

        <button id="generateBtn" onclick="generateAndDownload()">å ±å‘Šæ›¸LPã‚’ä½œæˆï¼†ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
    </div>

<script>
    // ä»Šæ—¥ã®æ—¥ä»˜ã‚’ã‚»ãƒƒãƒˆ
    document.getElementById('date').valueAsDate = new Date();

    // AIè¾æ›¸ï¼ˆç°¡æ˜“ç½®æ›ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
    const dictionary = {
        "æ—©ã‹ã£ãŸ": "ç†Ÿç·´ã®æŠ€è¡“ã«ã‚ˆã‚Šã€ã‚¹ãƒ”ãƒ¼ãƒ‡ã‚£ãƒ¼ã‹ã¤ä¸å¯§ã«ä»•ä¸Šã’ã¾ã—ãŸã€‚",
        "æ—©ã„": "çŸ­æœŸé–“ã§ã®æ–½å·¥ã‚’å®Ÿç¾ã—ã€ãŠå®¢æ§˜ã®è² æ‹…ã‚’æœ€å°é™ã«æŠ‘ãˆã¾ã—ãŸã€‚",
        "ç¶ºéº—": "ã¾ã‚‹ã§æœ¬çŸ³ã®ã‚ˆã†ãªã€é«˜ç´šæ„Ÿã‚ãµã‚Œã‚‹ç¾ã—ã„ä»•ä¸ŠãŒã‚Šã‚’å®Ÿç¾ã—ã¾ã—ãŸã€‚",
        "ãã‚Œã„": "ç´°éƒ¨ã¾ã§ã“ã ã‚ã‚Šã€æ´—ç·´ã•ã‚ŒãŸç¾ã—ã„ãƒ‡ã‚¶ã‚¤ãƒ³ã«ä»•ä¸Šã’ã¾ã—ãŸã€‚",
        "ã‹ã£ã“ã„ã„": "åœ§å€’çš„ãªå­˜åœ¨æ„Ÿã‚’æ”¾ã¤ã€ã‚¯ãƒ¼ãƒ«ã§ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªç©ºé–“ã«ç”Ÿã¾ã‚Œå¤‰ã‚ã‚Šã¾ã—ãŸã€‚",
        "ã™ã”ã„": "é€šè¡Œäººã‚‚è¶³ã‚’æ­¢ã‚ã‚‹ã»ã©ã®ã€ã‚¤ãƒ³ãƒ‘ã‚¯ãƒˆã‚ã‚‹ä»•ä¸ŠãŒã‚Šã¨ãªã‚Šã¾ã—ãŸã€‚",
        "å–œã‚“ã§ãŸ": "ã€Œæƒ³åƒä»¥ä¸Šã®å‡ºæ¥æ „ãˆï¼ã€ã¨ã€æ–½ä¸»æ§˜ã«ã‚‚å¤§å¤‰ãŠå–œã³ã„ãŸã ã‘ã¾ã—ãŸã€‚",
        "æ˜ã‚‹ã„": "ç©ºé–“å…¨ä½“ãŒãƒ‘ãƒƒã¨æ˜ã‚‹ããªã‚Šã€é–‹æ”¾æ„Ÿã®ã‚ã‚‹ä»•ä¸ŠãŒã‚Šã¨ãªã‚Šã¾ã—ãŸã€‚",
        "æƒé™¤": "ç‰¹æ®ŠåŠ å·¥ã«ã‚ˆã‚Šã€æ—¥ã€…ã®ãŠæ‰‹å…¥ã‚Œã‚„æƒé™¤ã‚‚é©šãã»ã©ç°¡å˜ã«ãªã‚Šã¾ã™ã€‚",
        "ä¸å¯§": "ç´°éƒ¨ã®ç›®åœ°ã«ã„ãŸã‚‹ã¾ã§ã€è·äººã®ã“ã ã‚ã‚Šã‚’è©°ã‚è¾¼ã‚“ã ä¸å¯§ãªæ–½å·¥ã§ã™ã€‚",
        "å®‰ã„": "ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆã¤ã¤ã‚‚ã€æœ€é«˜ç´šã®ã‚¯ã‚ªãƒªãƒ†ã‚£ã‚’å®Ÿç¾ã„ãŸã—ã¾ã—ãŸã€‚"
    };

    function optimizeText(targetId) {
        let text = document.getElementById(targetId).value;
        const shop = document.getElementById('shopName').value;
        if(!text) return;

        // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç½®æ›
        Object.keys(dictionary).forEach(key => {
            const reg = new RegExp(key, 'g');
            text = text.replace(reg, dictionary[key]);
        });

        // ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°è¿½åŠ ï¼ˆã“ã ã‚ã‚Šæ¬„ã®ã¿ï¼‰
        if (targetId === 'kodawari') {
            const tags = `\n\n#ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¹ãƒˆãƒ¼ãƒ³ #${shop} #èªå®šæ–½å·¥åº— #å¤–æ§‹å·¥äº‹ #ãƒªãƒ•ã‚©ãƒ¼ãƒ  #ãŠã—ã‚ƒã‚Œãªå®¶ #ã‚°ãƒ©ãƒ³ãƒ‰ã‚¢ãƒ¼ãƒˆã‚¦ã‚©ãƒ¼ãƒ«`;
            if(!text.includes('#ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¹ãƒˆãƒ¼ãƒ³')) text += tags;
        }

        document.getElementById(targetId).value = text;
        alert("æ–‡ç« ã‚’æœ€é©åŒ–ã—ã¾ã—ãŸï¼");
    }

    // LINEç”¨ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ”ãƒ¼
    function copyLineText() {
        const d = {
            date: document.getElementById('date').value,
            s: document.getElementById('customerName').value || "ãŠå®¢æ§˜",
            addr: document.getElementById('address').value,
            p: document.getElementById('shopName').value,
            k: document.getElementById('kodawari').value,
            sc: document.getElementById('area').value,
            jc: document.getElementById('days').value,
            m: document.getElementById('color').value
        };

        const text = `ã€æ–½å·¥å®Œäº†å ±å‘Šã€‘
æ‹…å½“ï¼š${d.p}
æ—¥æ™‚ï¼š${d.date}
é¡§å®¢ï¼š${d.s} æ§˜
ä½æ‰€ï¼š${d.addr}

[æ–½å·¥å†…å®¹]
ãƒ»é¢ç©ï¼š${d.sc}ã¡
ãƒ»æ—¥æ•°ï¼š${d.jc}æ—¥
ãƒ»ã‚«ãƒ©ãƒ¼ï¼š${d.m}

[ã“ã ã‚ã‚Šãƒ»è©³ç´°]
${d.k.replace(/<br>/g, '\n')}

è©³ç´°å†™çœŸã¯æ·»ä»˜ã®HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã”è¦§ãã ã•ã„ã€‚`;

        navigator.clipboard.writeText(text).then(() => {
            alert("LINEç”¨ã®å ±å‘Šãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
        }).catch(err => {
            alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚");
        });
    }

    // ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼†åœ§ç¸®å‡¦ç†
    function previewFile(id) {
        const fileInput = document.getElementById(id);
        const file = fileInput.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            const img = new Image();
            img.onload = function() {
                // Canvasã§ãƒªã‚µã‚¤ã‚ºï¼ˆæœ€å¤§å¹…1000pxã«åœ§ç¸®ï¼‰
                const canvas = document.createElement('canvas');
                const MAX_WIDTH = 1000;
                let width = img.width;
                let height = img.height;

                if (width > MAX_WIDTH) {
                    height *= MAX_WIDTH / width;
                    width = MAX_WIDTH;
                }

                canvas.width = width;
                canvas.height = height;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0, width, height);

                // åœ§ç¸®å¾Œã®Base64ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»åƒã®srcã«ã‚»ãƒƒãƒˆ
                const dataUrl = canvas.toDataURL('image/jpeg', 0.8); // ç”»è³ª80%
                const previewImg = document.getElementById('preview-' + id);
                previewImg.src = dataUrl;
                previewImg.style.display = 'block';
                document.getElementById('text-' + id).style.display = 'none';
            };
            img.src = e.target.result;
        };
        reader.readAsDataURL(file);
    }

    async function generateAndDownload() {
        const btn = document.getElementById('generateBtn');
        btn.innerText = "ç”Ÿæˆä¸­...";
        btn.disabled = true;

        try {
            // å…¥åŠ›å€¤ã®å–å¾—
            const d = {
                date: document.getElementById('date').value,
                s: document.getElementById('customerName').value || "ãŠå®¢æ§˜",
                addr: document.getElementById('address').value,
                p: document.getElementById('shopName').value,
                k: document.getElementById('kodawari').value,
                sc: document.getElementById('area').value,
                jc: document.getElementById('days').value,
                m: document.getElementById('color').value,
                v: document.getElementById('voice').value,
                cu: document.getElementById('lineUrl').value
            };

            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»åƒã‹ã‚‰åœ§ç¸®æ¸ˆã¿Base64ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
            const getImgSrc = (id) => {
                const img = document.getElementById('preview-' + id);
                return img.style.display === 'block' ? img.src : null;
            };

            const im = getImgSrc('imgMain');
            const ib1 = getImgSrc('imgBefore');
            const ia1 = getImgSrc('imgAfter');
            const iff = getImgSrc('imgSub');

            // HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æ§‹ç¯‰
            const htmlContent = `
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ–½å·¥å®Œäº†å ±å‘Š | ${d.s}æ§˜é‚¸</title>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9KY5C7XC36"><\/script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-9KY5C7XC36');
<\/script>
<style>
    body { background: #0a0a0a; color: #fff; font-family: "Helvetica Neue", Arial, sans-serif; margin: 0; text-align: center; padding-bottom: 50px; }
    .main-img { width: 100%; max-height: 450px; object-fit: contain; border-bottom: 2px solid #c5a059; background: #000; }
    .container { padding: 20px; max-width: 600px; margin: auto; }
    .card { background: #1a1a1a; padding: 20px; border-radius: 15px; border: 1px solid #333; margin-bottom: 20px; text-align: left; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
    .label { color: #c5a059; font-size: 0.8rem; font-weight: bold; display: block; margin-bottom: 8px; letter-spacing: 0.05em; }
    h1 { margin: 10px 0 20px; font-size: 1.8rem; text-align: center; color: #fff; }
    p { line-height: 1.6; color: #ddd; white-space: pre-wrap; }
    .ba-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
    .ba-box { text-align: center; }
    .ba-box span { display: block; font-size: 0.8rem; color: #c5a059; margin-bottom: 5px; font-weight: bold; }
    .ba-box img { width: 100%; aspect-ratio: 1/1; object-fit: cover; border-radius: 8px; border: 1px solid #555; background: #000; }
    .btn-contact { display: block; width: 100%; padding: 18px; background: #06c755; color: white; text-decoration: none; border-radius: 50px; font-weight: bold; margin-top: 10px; box-sizing: border-box; text-align: center; font-size: 1.1rem; box-shadow: 0 4px 10px rgba(6, 199, 85, 0.4); }
    .footer { margin-top: 40px; padding-bottom: 20px; color: #555; font-size: 0.7rem; }
    
    /* æœ¬éƒ¨ç”¨ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ */
    .dl-btn {
        display: inline-block; margin-top: 5px; padding: 5px 12px; background: rgba(255,255,255,0.1); 
        color: #aaa; border: 1px solid #444; border-radius: 4px; font-size: 0.7rem; text-decoration: none;
    }
    .dl-btn:hover { background: var(--gold); color: #000; border-color: var(--gold); }
</style>
</head>
<body>
    ${im ? `
        <img src="${im}" class="main-img">
        <br><a href="${im}" download="main_image.jpg" class="dl-btn">ğŸ“· ãƒ¡ã‚¤ãƒ³ç”»åƒã‚’ä¿å­˜</a>
    ` : ''}
    
    <div class="container">
        <p class="label" style="text-align:center;">${d.p} æ–½å·¥å ±å‘Š</p>
        <h1>${d.s} æ§˜</h1>
        <p style="text-align:center; color:#888; font-size:0.9rem; margin-top:-10px; margin-bottom:30px;">
            ${d.addr ? d.addr : ''}
        </p>

        <div class="card">
            <span class="label">ã“ã ã‚ã‚Šãƒã‚¤ãƒ³ãƒˆ</span>
            <p style="margin-top:0;">${d.k || 'ç´ æ™´ã‚‰ã—ã„ä»•ä¸ŠãŒã‚Šã«ãªã‚Šã¾ã—ãŸã€‚'}</p>
            
            <div style="border-top: 1px solid #333; margin-top:15px; padding-top:15px; font-size: 0.9rem; color:#aaa;">
                <span style="margin-right:10px;">ğŸ“ é¢ç©: ${d.sc}ã¡</span>
                <span style="margin-right:10px;">ğŸ“… å·¥æœŸ: ${d.jc}æ—¥</span>
                <span>ğŸ¨ è‰²: ${d.m}</span>
            </div>
        </div>

        <h2 style="color:#c5a059; font-size: 1.2rem; margin: 30px 0 15px;">Before / After</h2>
        <div class="ba-grid">
            <div class="ba-box">
                <span>BEFORE</span>
                ${ib1 ? `<img src="${ib1}"><br><a href="${ib1}" download="before.jpg" class="dl-btn">ğŸ“· ä¿å­˜</a>` : '<div style="background:#222; height:100%; border-radius:8px;"></div>'}
            </div>
            <div class="ba-box">
                <span>AFTER</span>
                ${ia1 ? `<img src="${ia1}"><br><a href="${ia1}" download="after.jpg" class="dl-btn">ğŸ“· ä¿å­˜</a>` : '<div style="background:#222; height:100%; border-radius:8px;"></div>'}
            </div>
        </div>

        ${d.v ? `
        <div class="card">
            <span class="label">ãŠå®¢æ§˜ã®å£°</span>
            <p style="margin-top:0; font-style: italic;">ã€Œ${d.v}ã€</p>
        </div>` : ''}

        ${iff ? `
            <img src="${iff}" style="width:100%; border-radius:15px; margin-top:20px; border:1px solid #444;">
            <br><a href="${iff}" download="sub_image.jpg" class="dl-btn">ğŸ“· æ–½å·¥é¢¨æ™¯ã‚’ä¿å­˜</a>
        ` : ''}

        <div style="margin-top:40px;">
            ${d.cu ? `<a href="${d.cu}" class="btn-contact">å…¬å¼LINEã§ãŠå•ã„åˆã‚ã›</a>` : ''}
        </div>

        <div class="footer">
            Generated by RSW DX PORTAL<br>
            Date: ${d.date}
        </div>
    </div>
</body>
</html>`;

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `report_${d.date}_${d.s}æ§˜.html`;
            link.click();

            // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’æˆ»ã™
            btn.innerText = "ä½œæˆå®Œäº†ï¼ã‚‚ã†ä¸€åº¦ä½œæˆã™ã‚‹";
            btn.disabled = false;
            
            alert("å ±å‘Šæ›¸LPã®ä½œæˆãŒå®Œäº†ã—ã¾ã—ãŸï¼\n1. ã€ŒLINEå ±å‘Šç”¨ãƒ†ã‚­ã‚¹ãƒˆã€ã‚’ã‚³ãƒ”ãƒ¼\n2. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸHTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ·»ä»˜\nã—ã¦LINEé€ä¿¡ã—ã¦ãã ã•ã„ã€‚");

        } catch (error) {
            console.error(error);
            alert("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚");
            btn.innerText = "å ±å‘Šæ›¸LPã‚’ä½œæˆï¼†ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰";
            btn.disabled = false;
        }
    }
</script>

</body>
</html>
