<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RSæ–½å·¥å ±å‘ŠLPã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
<!-- ä½æ‰€è‡ªå‹•å…¥åŠ›ãƒ©ã‚¤ãƒ–ãƒ©ãƒª -->
<script src="https://yubinbango.github.io/yubinbango/yubinbango.js" charset="UTF-8"></script>
<style>
    :root { --gold: #c5a059; --bg: #0a0a0a; --card-bg: #1a1a1a; }
    body { background: var(--bg); color: #fff; font-family: sans-serif; margin: 0; padding: 20px; box-sizing: border-box; }
    h1, h2, h3 { color: var(--gold); text-align: center; }
    
    /* å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .input-section { max-width: 600px; margin: 0 auto 40px; background: #222; padding: 20px; border-radius: 15px; border: 1px solid #444; }
    label { display: block; margin-top: 15px; color: var(--gold); font-weight: bold; font-size: 0.9rem; }
    input[type="text"], input[type="number"], textarea, select {
        width: 100%; padding: 12px; margin-top: 5px; background: #000; border: 1px solid #555; color: #fff; border-radius: 5px; box-sizing: border-box; font-size: 16px;
    }
    textarea { height: 100px; resize: vertical; }
    .file-input-wrapper { margin-top: 5px; border: 1px dashed #555; padding: 20px; text-align: center; border-radius: 5px; cursor: pointer; }
    .file-input-wrapper:hover { border-color: var(--gold); background: #111; }
    
    button#generateBtn {
        display: block; width: 100%; padding: 18px; background: linear-gradient(135deg, #c5a059, #e6c88b); 
        color: #000; font-weight: bold; border: none; border-radius: 30px; font-size: 1.1rem; margin-top: 30px; cursor: pointer;
        box-shadow: 0 4px 15px rgba(197, 160, 89, 0.4); transition: transform 0.2s;
    }
    button#generateBtn:active { transform: scale(0.98); }

    /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ï¼ˆç”Ÿæˆã•ã‚Œã‚‹HTMLã®è¦‹ãŸç›®ï¼‰ */
    #previewArea { display: none; margin-top: 40px; border-top: 2px solid var(--gold); padding-top: 20px; }
    
    /* ç”Ÿæˆå¾Œã®HTMLç”¨ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆåŸ‹ã‚è¾¼ã¿ç”¨ï¼‰ */
    .generated-body { background: #0a0a0a; color: #fff; font-family: sans-serif; margin: 0; text-align: center; }
    .main-img { width: 100%; max-height: 400px; object-fit: contain; border-bottom: 2px solid #c5a059; background: #000; }
    .container { padding: 20px; max-width: 600px; margin: auto; }
    .card { background: #1a1a1a; padding: 20px; border-radius: 15px; border: 1px solid #333; margin-bottom: 20px; text-align: left; }
    .label { color: #c5a059; font-size: 0.8rem; font-weight: bold; display: block; margin-bottom: 5px; }
    .ba-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
    .ba-box { text-align: center; }
    .ba-box span { display: block; font-size: 0.8rem; color: #888; margin-bottom: 5px; }
    .ba-box img { width: 100%; aspect-ratio: 1/1; object-fit: cover; border-radius: 8px; border: 1px solid #444; background: #000; display: block; }
    .btn-contact { display: block; width: 100%; padding: 15px; background: #06c755; color: white; text-decoration: none; border-radius: 30px; font-weight: bold; margin-top: 10px; box-sizing: border-box; text-align: center; }
    .footer { font-size: 0.7rem; color: #666; margin-top: 40px; }
</style>
</head>
<body>

    <h1 style="margin-bottom: 5px;">RSW DX PORTAL</h1>
    <h2 style="font-size: 1rem; color: #888; margin-top: 0;">æ–½å·¥å ±å‘ŠLPã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</h2>

    <!-- å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  -->
    <div class="input-section h-adr">
        <span class="p-country-name" style="display:none;">Japan</span>
        
        <label>æ–½å·¥å®Œäº†æ—¥</label>
        <input type="date" id="date" value="<?php echo date('Y-m-d'); ?>">

        <label>é¡§å®¢å (æ§˜)</label>
        <input type="text" id="customerName" placeholder="ä¾‹ï¼šå±±ç”° å¤ªéƒ">

        <label>éƒµä¾¿ç•ªå· (ãƒã‚¤ãƒ•ãƒ³ãªã—)</label>
        <input type="text" class="p-postal-code" size="8" maxlength="8" placeholder="1234567">
        
        <label>ä½æ‰€ (è‡ªå‹•å…¥åŠ›)</label>
        <input type="text" class="p-region p-locality p-street-address p-extended-address" id="address">

        <label>èªå®šæ–½å·¥åº—å</label>
        <input type="text" id="shopName" value="èªå®šæ–½å·¥åº—">

        <hr style="border-color: #333; margin: 20px 0;">

        <label>ãƒ¡ã‚¤ãƒ³ç”»åƒ (å®Œäº†å†™çœŸ)</label>
        <div class="file-input-wrapper">
            <input type="file" id="imgMain" accept="image/*">
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <div>
                <label>Beforeç”»åƒ</label>
                <div class="file-input-wrapper">
                    <input type="file" id="imgBefore" accept="image/*">
                </div>
            </div>
            <div>
                <label>Afterç”»åƒ</label>
                <div class="file-input-wrapper">
                    <input type="file" id="imgAfter" accept="image/*">
                </div>
            </div>
        </div>

        <label>æ–½å·¥é¢¨æ™¯ / é›†åˆå†™çœŸ (ä»»æ„)</label>
        <div class="file-input-wrapper">
            <input type="file" id="imgSub" accept="image/*">
        </div>

        <hr style="border-color: #333; margin: 20px 0;">

        <label>ã“ã ã‚ã‚Šãƒã‚¤ãƒ³ãƒˆ</label>
        <textarea id="kodawari" placeholder="ä¾‹ï¼šæ—¢å­˜ã®ã²ã³å‰²ã‚Œã‚’æ´»ã‹ã—ãŸãƒ‡ã‚¶ã‚¤ãƒ³ã«ã—ã¾ã—ãŸ..."></textarea>

        <div style="display: flex; gap: 10px;">
            <div style="flex:1;">
                <label>æ–½å·¥é¢ç© (ã¡)</label>
                <input type="text" id="area" placeholder="30">
            </div>
            <div style="flex:1;">
                <label>æ–½å·¥æ—¥æ•° (æ—¥)</label>
                <input type="text" id="days" placeholder="3">
            </div>
        </div>
        <label>ä½¿ç”¨ã‚«ãƒ©ãƒ¼</label>
        <input type="text" id="color" placeholder="ãƒŸãƒ«ã‚¯ãƒ†ã‚£ãƒ¼, ãƒ–ãƒ©ãƒƒã‚¯">

        <label>ãŠå®¢æ§˜ã®å£°</label>
        <textarea id="voice" placeholder="ä¾‹ï¼šæƒ³åƒä»¥ä¸Šã®ä»•ä¸ŠãŒã‚Šã§æ„Ÿå‹•ã—ã¾ã—ãŸï¼"></textarea>

        <label>å…¬å¼LINE URL (å•ã„åˆã‚ã›ãƒœã‚¿ãƒ³ç”¨)</label>
        <input type="text" id="lineUrl" placeholder="https://line.me/...">

        <button id="generateBtn" onclick="generateAndDownload()">å ±å‘Šæ›¸LPã‚’ä½œæˆï¼†ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
    </div>

<script>
    // ä»Šæ—¥ã®æ—¥ä»˜ã‚’ã‚»ãƒƒãƒˆ
    document.getElementById('date').valueAsDate = new Date();

    // ç”»åƒã‚’Base64ã«å¤‰æ›ã™ã‚‹é–¢æ•°
    const fileToBase64 = (file) => {
        return new Promise((resolve, reject) => {
            if (!file) { resolve(null); return; }
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = () => resolve(reader.result);
            reader.onerror = error => reject(error);
        });
    };

    async function generateAndDownload() {
        const btn = document.getElementById('generateBtn');
        btn.innerText = "ç”Ÿæˆä¸­...";
        btn.disabled = true;

        try {
            // å…¥åŠ›å€¤ã®å–å¾—
            const d = {
                date: document.getElementById('date').value,
                s: document.getElementById('customerName').value || "ãŠå®¢æ§˜",
                addr: document.getElementById('address').value,
                p: document.getElementById('shopName').value,
                k: document.getElementById('kodawari').value,
                sc: document.getElementById('area').value,
                jc: document.getElementById('days').value,
                m: document.getElementById('color').value,
                v: document.getElementById('voice').value,
                cu: document.getElementById('lineUrl').value
            };

            // ç”»åƒã®èª­ã¿è¾¼ã¿
            const im = await fileToBase64(document.getElementById('imgMain').files[0]);
            const ib1 = await fileToBase64(document.getElementById('imgBefore').files[0]);
            const ia1 = await fileToBase64(document.getElementById('imgAfter').files[0]);
            const iff = await fileToBase64(document.getElementById('imgSub').files[0]);

            // HTMLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®æ§‹ç¯‰
            const htmlContent = `
<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ–½å·¥å®Œäº†å ±å‘Š | ${d.s}æ§˜é‚¸</title>
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9KY5C7XC36"><\/script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-9KY5C7XC36');
<\/script>
<style>
    body { background: #0a0a0a; color: #fff; font-family: "Helvetica Neue", Arial, sans-serif; margin: 0; text-align: center; }
    .main-img { width: 100%; max-height: 450px; object-fit: contain; border-bottom: 2px solid #c5a059; background: #000; }
    .container { padding: 20px; max-width: 600px; margin: auto; }
    .card { background: #1a1a1a; padding: 20px; border-radius: 15px; border: 1px solid #333; margin-bottom: 20px; text-align: left; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
    .label { color: #c5a059; font-size: 0.8rem; font-weight: bold; display: block; margin-bottom: 8px; letter-spacing: 0.05em; }
    h1 { margin: 10px 0 20px; font-size: 1.8rem; text-align: center; color: #fff; }
    p { line-height: 1.6; color: #ddd; }
    .ba-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
    .ba-box { text-align: center; }
    .ba-box span { display: block; font-size: 0.8rem; color: #c5a059; margin-bottom: 5px; font-weight: bold; }
    .ba-box img { width: 100%; aspect-ratio: 1/1; object-fit: cover; border-radius: 8px; border: 1px solid #555; background: #000; }
    .btn-contact { display: block; width: 100%; padding: 18px; background: #06c755; color: white; text-decoration: none; border-radius: 50px; font-weight: bold; margin-top: 10px; box-sizing: border-box; text-align: center; font-size: 1.1rem; box-shadow: 0 4px 10px rgba(6, 199, 85, 0.4); }
    .footer { margin-top: 40px; padding-bottom: 20px; color: #555; font-size: 0.7rem; }
</style>
</head>
<body>
    ${im ? `<img src="${im}" class="main-img">` : ''}
    
    <div class="container">
        <p class="label" style="text-align:center;">${d.p} æ–½å·¥å ±å‘Š</p>
        <h1>${d.s} æ§˜</h1>
        <p style="text-align:center; color:#888; font-size:0.9rem; margin-top:-10px; margin-bottom:30px;">
            ${d.addr ? d.addr : ''}
        </p>

        <div class="card">
            <span class="label">ã“ã ã‚ã‚Šãƒã‚¤ãƒ³ãƒˆ</span>
            <p style="margin-top:0; white-space: pre-wrap;">${d.k || 'ç´ æ™´ã‚‰ã—ã„ä»•ä¸ŠãŒã‚Šã«ãªã‚Šã¾ã—ãŸã€‚'}</p>
            
            <div style="border-top: 1px solid #333; margin-top:15px; padding-top:15px; font-size: 0.9rem; color:#aaa;">
                <span style="margin-right:10px;">ğŸ“ é¢ç©: ${d.sc}ã¡</span>
                <span style="margin-right:10px;">ğŸ“… å·¥æœŸ: ${d.jc}æ—¥</span>
                <span>ğŸ¨ è‰²: ${d.m}</span>
            </div>
        </div>

        <h2 style="color:#c5a059; font-size: 1.2rem; margin: 30px 0 15px;">Before / After</h2>
        <div class="ba-grid">
            <div class="ba-box">
                <span>BEFORE</span>
                ${ib1 ? `<img src="${ib1}">` : '<div style="background:#222; height:100%; border-radius:8px;"></div>'}
            </div>
            <div class="ba-box">
                <span>AFTER</span>
                ${ia1 ? `<img src="${ia1}">` : '<div style="background:#222; height:100%; border-radius:8px;"></div>'}
            </div>
        </div>

        ${d.v ? `
        <div class="card">
            <span class="label">ãŠå®¢æ§˜ã®å£°</span>
            <p style="margin-top:0; font-style: italic; white-space: pre-wrap;">ã€Œ${d.v}ã€</p>
        </div>` : ''}

        ${iff ? `<img src="${iff}" style="width:100%; border-radius:15px; margin-top:20px; border:1px solid #444;">` : ''}

        <div style="margin-top:40px;">
            ${d.cu ? `<a href="${d.cu}" class="btn-contact">å…¬å¼LINEã§ãŠå•ã„åˆã‚ã›</a>` : ''}
        </div>

        <div class="footer">
            Generated by RSW DX PORTAL<br>
            Date: ${d.date}
        </div>
    </div>
</body>
</html>`;

            // ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å‡¦ç†
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `report_${d.date}_${d.s}æ§˜.html`;
            link.click();

            // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’æˆ»ã™
            btn.innerText = "ä½œæˆå®Œäº†ï¼ã‚‚ã†ä¸€åº¦ä½œæˆã™ã‚‹";
            btn.disabled = false;
            
            alert("å ±å‘Šæ›¸LPã®ä½œæˆãŒå®Œäº†ã—ã¾ã—ãŸï¼\nãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ç¢ºèªã—ã¦ãã ã•ã„ã€‚");

        } catch (error) {
            console.error(error);
            alert("ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ç”»åƒã®ã‚µã‚¤ã‚ºãŒå¤§ãã™ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚");
            btn.innerText = "å ±å‘Šæ›¸LPã‚’ä½œæˆï¼†ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰";
            btn.disabled = false;
        }
    }
</script>

</body>
</html>
