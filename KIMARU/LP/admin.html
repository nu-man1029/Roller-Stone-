<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>KIMARU ç®¡ç†ç”»é¢</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500&family=Cormorant+Garamond:wght@300;400&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;}
:root{
  --gold:#c9a84c;--bg:#0e0e0e;--bg2:#161616;--bg3:#1e1e1e;
  --border:rgba(201,168,76,0.18);--text:#eeebe4;--text2:#888;
  --radius:10px;--green:#4caf7d;--red:#e05555;
}
body{background:var(--bg);color:var(--text);font-family:'Noto Sans JP',sans-serif;font-weight:300;min-height:100vh;}
.header{background:var(--bg2);border-bottom:1px solid var(--border);padding:18px 28px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;}
.header-logo{font-family:'Cormorant Garamond',serif;font-size:1.4rem;color:var(--gold);letter-spacing:4px;}
.header-logo span{color:var(--text2);font-size:.72rem;letter-spacing:2px;margin-left:10px;font-family:'Noto Sans JP',sans-serif;}
.hbtns{display:flex;gap:10px;}
.btn{font-family:'Noto Sans JP',sans-serif;font-size:.78rem;font-weight:400;letter-spacing:1px;padding:10px 22px;border-radius:6px;cursor:pointer;border:none;transition:all .2s;display:flex;align-items:center;gap:7px;}
.btn-primary{background:var(--gold);color:#111;}
.btn-primary:hover{opacity:.85;transform:translateY(-1px);}
.btn-secondary{background:transparent;color:var(--text2);border:1px solid var(--border);}
.btn-secondary:hover{border-color:var(--gold);color:var(--gold);}
.btn-danger{background:transparent;color:var(--red);border:1px solid rgba(224,85,85,.3);font-size:.72rem;padding:7px 14px;}
.btn-danger:hover{background:rgba(224,85,85,.1);}
.btn-add{background:rgba(201,168,76,.08);color:var(--gold);border:1px dashed rgba(201,168,76,.4);width:100%;padding:14px;border-radius:8px;font-size:.82rem;letter-spacing:1px;margin-top:16px;}
.btn-add:hover{background:rgba(201,168,76,.14);}

/* LAYOUT */
.layout{display:grid;grid-template-columns:210px 1fr;min-height:calc(100vh - 61px);}
.sidebar{background:var(--bg2);border-right:1px solid var(--border);padding:20px 0;}
.sidebar-label{font-size:.6rem;letter-spacing:3px;color:var(--text2);padding:14px 14px 6px;text-transform:uppercase;}
.nav-item{display:flex;align-items:center;gap:9px;padding:9px 14px;border-radius:6px;cursor:pointer;font-size:.8rem;color:var(--text2);transition:all .2s;border:none;background:none;width:100%;text-align:left;}
.nav-item:hover{background:var(--bg3);color:var(--text);}
.nav-item.active{background:rgba(201,168,76,.1);color:var(--gold);border-left:2px solid var(--gold);}
.main{padding:36px 40px 120px;}
.page{display:none;}.page.active{display:block;}
.page-title{font-family:'Cormorant Garamond',serif;font-size:1.7rem;font-weight:300;color:var(--text);margin-bottom:4px;letter-spacing:2px;}
.page-sub{font-size:.78rem;color:var(--text2);margin-bottom:32px;}

/* CARDS */
.card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:20px;overflow:hidden;}
.card-head{padding:16px 22px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px;}
.card-icon{font-size:1rem;}
.card-name{font-size:.88rem;font-weight:500;letter-spacing:.5px;}
.card-desc{font-size:.72rem;color:var(--text2);margin-left:auto;}
.card-body{padding:22px;}

/* BA SLIDER CARD */
.ba-card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:16px;overflow:hidden;}
.ba-card-head{padding:14px 18px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:10px;}
.ba-card-num{font-family:'Cormorant Garamond',serif;font-size:1.4rem;color:var(--gold);opacity:.5;line-height:1;}
.ba-card-title-input{flex:1;background:transparent;border:none;color:var(--text);font-family:'Noto Sans JP',sans-serif;font-size:.88rem;outline:none;border-bottom:1px solid transparent;transition:border-color .2s;padding:2px 4px;}
.ba-card-title-input:focus{border-bottom-color:var(--gold);}
.ba-card-body{padding:18px;}
.ba-img-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:16px;}
.img-drop-label{font-size:.65rem;letter-spacing:2px;color:var(--text2);margin-bottom:7px;text-transform:uppercase;}
.img-drop{border:2px dashed var(--border);border-radius:8px;overflow:hidden;aspect-ratio:16/9;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;position:relative;background:var(--bg3);}
.img-drop:hover{border-color:var(--gold);}
.img-drop.has-img{border-style:solid;border-color:rgba(201,168,76,.4);}
.img-drop img.preview{width:100%;height:100%;object-fit:cover;position:absolute;top:0;left:0;}
.img-drop-overlay{position:absolute;inset:0;background:rgba(0,0,0,.55);display:flex;flex-direction:column;align-items:center;justify-content:center;opacity:0;transition:opacity .2s;z-index:1;}
.img-drop:hover .img-drop-overlay,.img-drop:not(.has-img) .img-drop-overlay{opacity:1;}
.img-drop-icon{font-size:1.6rem;margin-bottom:5px;color:var(--gold);}
.img-drop-text{font-size:.68rem;color:var(--text2);text-align:center;}
.img-drop input[type=file]{display:none;}
.img-fname{font-size:.68rem;color:var(--text2);margin-top:5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}

/* INFO FIELDS */
.info-fields{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:14px;}
.sample-row{display:flex;align-items:center;gap:14px;}
/* Drive URL options */
.drive-opt{display:flex;align-items:center;gap:10px;background:var(--bg3);border:1px solid var(--border);border-radius:8px;padding:10px 14px;cursor:pointer;transition:all .2s;}
.drive-opt:hover{border-color:var(--gold);}
.drive-opt.selected{border-color:var(--gold);background:rgba(201,168,76,.08);}
.drive-opt-num{font-family:"Cormorant Garamond",serif;font-size:1.3rem;color:var(--gold);opacity:.6;line-height:1;flex-shrink:0;}
.drive-opt-info{flex:1;min-width:0;}
.drive-opt-label{font-size:.78rem;font-weight:500;color:var(--text);margin-bottom:3px;}
.drive-opt-url{font-size:.65rem;color:var(--text2);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
/* Theme picker */
.theme-picker{display:flex;gap:10px;}
.theme-btn{flex:1;background:var(--bg3);border:2px solid var(--border);border-radius:10px;padding:14px 10px;cursor:pointer;display:flex;flex-direction:column;align-items:center;gap:7px;transition:all .2s;}
.theme-btn:hover{border-color:rgba(201,168,76,.5);}
.theme-btn.active{border-color:var(--gold);background:rgba(201,168,76,.08);}
.theme-swatch{width:36px;height:36px;border-radius:50%;border:2px solid rgba(255,255,255,.15);}
.dark-swatch{background:#111;box-shadow:inset 0 0 0 8px #c9a84c;}
.light-swatch{background:#f5f3ef;box-shadow:inset 0 0 0 8px #c9a84c;}
.ink-swatch{background:#f8f7f4;box-shadow:inset 0 0 0 8px #1a1a1a;}
.theme-label{font-size:.82rem;font-weight:500;color:var(--text);}
.theme-desc{font-size:.65rem;color:var(--text2);text-align:center;}
/* Project save/load */
.proj-modal{position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:500;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .25s;}
.proj-modal.open{opacity:1;pointer-events:all;}
.proj-box{background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:28px;width:420px;max-width:90vw;max-height:80vh;overflow-y:auto;}
.proj-box h3{font-family:'Cormorant Garamond',serif;font-size:1.2rem;font-weight:300;color:var(--gold);letter-spacing:2px;margin-bottom:20px;}
.proj-item{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;background:var(--bg3);border-radius:6px;margin-bottom:8px;cursor:pointer;transition:background .2s;border:1px solid transparent;}
.proj-item:hover{background:rgba(201,168,76,.1);border-color:var(--border);}
.proj-item-name{font-size:.85rem;}
.proj-item-date{font-size:.68rem;color:var(--text2);}
.proj-item-btns{display:flex;gap:6px;flex-shrink:0;}
.proj-empty{font-size:.8rem;color:var(--text2);text-align:center;padding:24px;}

.sample-preview-wrap{position:relative;width:64px;height:64px;flex-shrink:0;}
.sample-preview{width:64px;height:64px;border-radius:7px;object-fit:cover;border:1px solid var(--border);display:none;}
.sample-preview.visible{display:block;}

/* FORM */
label.field-label{display:block;font-size:.65rem;letter-spacing:2px;color:var(--text2);margin-bottom:7px;text-transform:uppercase;}
input[type=text],input[type=url],textarea{width:100%;background:var(--bg3);border:1px solid var(--border);border-radius:6px;padding:11px 13px;color:var(--text);font-family:'Noto Sans JP',sans-serif;font-size:.85rem;font-weight:300;outline:none;transition:border-color .2s;}
input[type=text]:focus,input[type=url]:focus,textarea:focus{border-color:var(--gold);}
textarea{resize:vertical;line-height:1.9;}
.hint{font-size:.68rem;color:var(--text2);margin-top:5px;line-height:1.7;}
.hint a{color:var(--gold);text-decoration:none;}
.form-row{margin-bottom:18px;}.form-row:last-child{margin-bottom:0;}
.form-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
.form-grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px;}

/* TOGGLE */
.toggle-row{display:flex;align-items:center;justify-content:space-between;padding:12px 0;border-bottom:1px solid rgba(255,255,255,.04);}
.toggle-row:last-child{border-bottom:none;}
.toggle-info .t-label{font-size:.83rem;font-weight:400;}
.toggle-info .t-desc{font-size:.7rem;color:var(--text2);margin-top:2px;}
.toggle{position:relative;width:42px;height:22px;flex-shrink:0;margin-left:14px;}
.toggle input{display:none;}
.toggle-track{display:block;width:100%;height:100%;background:var(--bg3);border:1px solid var(--border);border-radius:11px;transition:all .2s;cursor:pointer;}
.toggle input:checked+.toggle-track{background:rgba(201,168,76,.3);border-color:var(--gold);}
.toggle-thumb{position:absolute;top:3px;left:3px;width:14px;height:14px;background:var(--text2);border-radius:50%;transition:all .2s;pointer-events:none;}
.toggle input:checked~.toggle-thumb{left:23px;background:var(--gold);}

/* LOGO GRID */
.logo-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;}
.logo-drop{border:2px dashed var(--border);border-radius:8px;aspect-ratio:1;overflow:hidden;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:all .2s;position:relative;background:var(--bg3);}
.logo-drop:hover{border-color:var(--gold);}
.logo-drop.has-img{border-style:solid;border-color:rgba(201,168,76,.4);}
.logo-drop img.preview{width:100%;height:100%;object-fit:cover;position:absolute;}
.logo-drop input[type=file]{display:none;}

/* SAVE BAR */
.save-bar{position:fixed;bottom:0;left:0;right:0;background:var(--bg2);border-top:1px solid var(--border);padding:14px 28px;display:flex;align-items:center;justify-content:space-between;transform:translateY(100%);transition:transform .3s;z-index:200;}
.save-bar.show{transform:translateY(0);}
.save-msg{font-size:.78rem;color:var(--text2);}
.save-msg strong{color:var(--gold);}
.save-btns{display:flex;gap:10px;}

/* TOAST */
.toast{position:fixed;top:72px;right:20px;background:var(--bg2);border:1px solid var(--green);border-radius:8px;padding:12px 18px;font-size:.8rem;color:var(--text);display:flex;align-items:center;gap:9px;transform:translateX(120%);transition:transform .3s;z-index:300;}
.toast.show{transform:translateX(0);}

/* BA PREVIEW */
.ba-preview-panel{background:var(--bg3);border-radius:8px;overflow:hidden;margin-bottom:8px;}
.ba-preview-slider{position:relative;width:100%;aspect-ratio:16/9;cursor:ew-resize;user-select:none;}
.ba-preview-img{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;}
.ba-preview-after{clip-path:inset(0 0 0 50%);z-index:2;}
.ba-preview-handle{position:absolute;top:0;bottom:0;left:50%;transform:translateX(-50%);width:30px;z-index:10;display:flex;flex-direction:column;align-items:center;pointer-events:none;}
.ba-preview-line{width:2px;flex:1;background:var(--gold);}
.ba-preview-pill{background:var(--gold);color:#111;font-size:.5rem;font-weight:700;letter-spacing:2px;padding:4px 6px;}
.ba-preview-empty{display:flex;align-items:center;justify-content:center;height:120px;color:var(--text2);font-size:.78rem;}

@media(max-width:768px){
  .layout{grid-template-columns:1fr;}
  .sidebar{display:none;}
  .main{padding:20px 14px 120px;}
  .form-grid,.form-grid3,.info-fields,.ba-img-grid,.logo-grid{grid-template-columns:1fr;}
}
</style>
</head>
<body>

<header class="header">
  <div class="header-logo">KIMARU <span>ç®¡ç†ç”»é¢</span></div>
  <div class="hbtns">
    <button class="btn btn-secondary" onclick="previewLP()">ğŸ‘ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
    <button class="btn btn-primary" onclick="generateAndDownload()">â¬‡ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
  </div>
</header>

<div class="layout">
  <nav class="sidebar">
    <div class="sidebar-label">ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</div>
    <button class="nav-item active" onclick="showPage('ba',this)"><span>â†”ï¸</span>BAã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼</button>
    <button class="nav-item" onclick="showPage('urls',this)"><span>ğŸ”—</span>URLè¨­å®š</button>
    <button class="nav-item" onclick="showPage('text',this)"><span>âœï¸</span>ãƒ†ã‚­ã‚¹ãƒˆ</button>
    <button class="nav-item" onclick="showPage('logos',this)"><span>ğŸ·</span>ãƒ­ã‚´</button>
    <button class="nav-item" onclick="showPage('profile',this)"><span>ğŸ‘¤</span>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</button>
    <button class="nav-item" onclick="showPage('sections',this)"><span>âš™ï¸</span>ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¨­å®š</button>
    <div class="sidebar-label" style="margin-top:16px;">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</div>
    <button class="nav-item" onclick="openSaveModal()"><span>ğŸ’¾</span>ä¿å­˜ã™ã‚‹</button>
    <button class="nav-item" onclick="openLoadModal()"><span>ğŸ“‚</span>å‘¼ã³å‡ºã™</button>
  </nav>

  <main class="main">

    <!-- ===== BA SLIDER ===== -->
    <div class="page active" id="page-ba">
      <div class="page-title">BAã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼</div>
      <div class="page-sub">æ–½å·¥äº‹ä¾‹ã®Before/Afterã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’ç®¡ç†ã—ã¾ã™ã€‚è¿½åŠ ãƒ»å‰Šé™¤ãƒ»ä¸¦ã³æ›¿ãˆãŒå¯èƒ½ã§ã™ã€‚</div>
      <div id="ba-cards"></div>
      <button class="btn btn-add" onclick="addBaCard()">ï¼‹ ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’è¿½åŠ ã™ã‚‹</button>
    </div>

    <!-- ===== URL ===== -->
    <div class="page" id="page-urls">
      <div class="page-title">URL è¨­å®š</div>
      <div class="page-sub">LINEãƒ»Instagramãƒ»å‹•ç”»ã®URLã‚’è¨­å®šã—ã¾ã™ã€‚</div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ¨</span><span class="card-name">ãƒ†ãƒ¼ãƒ</span><span class="card-desc">æ›¸ãå‡ºã™LPã®é…è‰²</span></div>
        <div class="card-body">
          <div class="form-row">
            <label class="field-label">ãƒ†ãƒ¼ãƒã‚’é¸æŠ</label>
            <div class="theme-picker" id="theme-picker">
              <button class="theme-btn active" data-theme="dark"  onclick="selectTheme('dark',this)">
                <span class="theme-swatch dark-swatch"></span>
                <span class="theme-label">Dark</span>
                <span class="theme-desc">é»’èƒŒæ™¯ãƒ»é‡‘ã‚¢ã‚¯ã‚»ãƒ³ãƒˆ</span>
              </button>
              <button class="theme-btn" data-theme="light" onclick="selectTheme('light',this)">
                <span class="theme-swatch light-swatch"></span>
                <span class="theme-label">Light</span>
                <span class="theme-desc">ãƒ™ãƒ¼ã‚¸ãƒ¥ãƒ»æ¸©ã‹ã¿</span>
              </button>
              <button class="theme-btn" data-theme="ink"   onclick="selectTheme('ink',this)">
                <span class="theme-swatch ink-swatch"></span>
                <span class="theme-label">Ink</span>
                <span class="theme-desc">ç™½é»’ãƒ»ã‚·ãƒ£ãƒ¼ãƒ—</span>
              </button>
            </div>
            <div class="hint" style="margin-top:10px;">æ›¸ãå‡ºã—ãŸHTMLã¯ã“ã®ãƒ†ãƒ¼ãƒã§å®Œå…¨å›ºå®šã•ã‚Œã¾ã™ï¼ˆåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ãªã—ï¼‰ã€‚</div>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ“Š</span><span class="card-name">GA4 è¨­å®š</span><span class="card-desc">Google Analytics</span></div>
        <div class="card-body">
          <div class="form-row"><label class="field-label">æ¸¬å®šIDï¼ˆGA4ï¼‰</label><input type="text" id="ga4-id" placeholder="G-XXXXXXXXXX" oninput="markDirty()"><div class="hint">ç¾åœ¨ã®è¨­å®š: G-0VF277F6RXã€€å¤‰æ›´ã™ã‚‹å ´åˆã®ã¿å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div></div>
        </div>
      </div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ’¬</span><span class="card-name">LINE</span><span class="card-desc">ãƒ¡ã‚¤ãƒ³CTA ã‚¤ãƒ™ãƒ³ãƒˆ: click / cta / line_pr</span></div>
        <div class="card-body">
          <div class="form-row"><label class="field-label">LINE URL</label><input type="url" id="line-url" placeholder="https://lin.ee/xxxxxxx" oninput="markDirty()"><div class="hint"><a href="https://manager.line.biz/" target="_blank">LINE Official Account Manager</a> â†’ å‹ã ã¡è¿½åŠ ã‚¬ã‚¤ãƒ‰</div></div>
          <div class="form-row"><label class="field-label">CTAãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆ</label><input type="text" id="line-btn-text" placeholder="LINE ã§ãŠå•ã„åˆã‚ã›" oninput="markDirty()"></div>
        </div>
      </div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ“·</span><span class="card-name">Instagram</span><span class="card-desc">ã‚¤ãƒ™ãƒ³ãƒˆ: click / social / instagram_numan</span></div>
        <div class="card-body">
          <div class="form-row"><label class="field-label">Instagram URL</label><input type="url" id="ig-url" placeholder="https://www.instagram.com/cementart_numan/" oninput="markDirty()"></div>
        </div>
      </div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ¬</span><span class="card-name">å‹•ç”»</span><span class="card-desc">Cinematic View</span></div>
        <div class="card-body">
          <div class="form-row">
            <label class="field-label">Googleãƒ‰ãƒ©ã‚¤ãƒ–URL â†’ è‡ªå‹•å¤‰æ›</label>
            <div style="display:flex;gap:8px;">
              <input type="url" id="drive-raw-url" placeholder="https://drive.google.com/file/d/XXXXX/view" style="flex:1;" oninput="autoConvertDriveUrl(this.value)">
              <button class="btn btn-primary" style="white-space:nowrap;flex-shrink:0;" onclick="convertDriveUrl()">å¤‰æ›ã™ã‚‹</button>
            </div>
            <div class="hint">ãƒ‰ãƒ©ã‚¤ãƒ–ã®URLã‚’ãã®ã¾ã¾è²¼ã£ã¦ã€Œå¤‰æ›ã™ã‚‹ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚<br>å…±æœ‰è¨­å®šã¯ <strong style="color:var(--gold)">ã€Œãƒªãƒ³ã‚¯ã‚’çŸ¥ã£ã¦ã„ã‚‹å…¨å“¡ãŒé–²è¦§å¯ã€</strong> ã«ã—ã¦ãã ã•ã„ã€‚</div>
          </div>
          <div id="drive-results" style="display:none;">
            <div class="form-row">
              <label class="field-label">å¤‰æ›çµæœ â€” ä½¿ã†URLã‚’é¸ã‚“ã§ãã ã•ã„</label>
              <div id="drive-url-options" style="display:flex;flex-direction:column;gap:8px;"></div>
              <div class="hint" style="margin-top:8px;">
                <strong style="color:var(--gold)">â‘  ç›´æ¥DL</strong> ãŒä¸€ç•ªã‚·ãƒ³ãƒ—ãƒ«ã€‚å¤§ãã„ãƒ•ã‚¡ã‚¤ãƒ«(100MBè¶…)ã¯â‘¡ã‚’è©¦ã—ã¦ãã ã•ã„ã€‚<br>
                ã†ã¾ãå†ç”Ÿã§ããªã„å ´åˆã¯â‘¢ã®åŸ‹ã‚è¾¼ã¿iframeã‚’ãŠè©¦ã—ãã ã•ã„ï¼ˆè¦‹ãŸç›®ãŒå¤‰ã‚ã‚Šã¾ã™ï¼‰ã€‚
              </div>
            </div>
          </div>
          <div class="form-row">
            <label class="field-label">å‹•ç”»URLï¼ˆç›´æ¥å…¥åŠ›ãƒ»ã¾ãŸã¯ä¸Šã‹ã‚‰è‡ªå‹•å…¥åŠ›ï¼‰</label>
            <input type="url" id="video-url" placeholder="https://drive.google.com/uc?export=download&id=..." oninput="markDirty()">
          </div>
          <div class="form-row"><label class="field-label">ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒURLï¼ˆä»»æ„ï¼‰</label><input type="url" id="video-poster" placeholder="https://..." oninput="markDirty()"></div>
          <div class="form-row"><label class="field-label">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label><input type="text" id="video-title" placeholder="ç´ æã®ä¸–ç•Œã‚’ã€æ˜ åƒã§ã€‚" oninput="markDirty()"></div>
          <div class="form-row"><label class="field-label">èª¬æ˜æ–‡</label><textarea id="video-body" rows="2" oninput="markDirty()" placeholder="æ–½å·¥ã®è³ªæ„Ÿã¨ä»•ä¸ŠãŒã‚Šã‚’æ˜ åƒã§ãŠå±Šã‘ã—ã¾ã™ã€‚"></textarea></div>
          <div class="toggle-row">
            <div class="toggle-info"><div class="t-label">å‹•ç”»ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤ºã™ã‚‹</div><div class="t-desc">OFFã«ã™ã‚‹ã¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã”ã¨éè¡¨ç¤º</div></div>
            <label class="toggle"><input type="checkbox" id="video-visible" onchange="markDirty()"><span class="toggle-track"></span><span class="toggle-thumb"></span></label>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== TEXT ===== -->
    <div class="page" id="page-text">
      <div class="page-title">ãƒ†ã‚­ã‚¹ãƒˆ ç·¨é›†</div>
      <div class="page-sub">ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»CTAã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ç·¨é›†ã—ã¾ã™ã€‚</div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ†</span><span class="card-name">Heroï¼ˆãƒˆãƒƒãƒ—ï¼‰</span></div>
        <div class="card-body">
          <div class="form-row"><label class="field-label">ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼</label><textarea id="hero-catch" rows="3" oninput="markDirty()"></textarea><div class="hint">æ”¹è¡Œã¯ &lt;br&gt; ã‚’ä½¿ã„ã¾ã™ã€‚ä¾‹ï¼šæ–½å·¥ã®ç¾å ´ãŒã€&lt;br&gt;æœ€é«˜ã®ææ¡ˆæ›¸ã«ãªã‚‹ã€‚</div></div>
          <div class="form-row"><label class="field-label">ã‚µãƒ–ã‚³ãƒ”ãƒ¼</label><textarea id="hero-sub" rows="2" oninput="markDirty()"></textarea></div>
        </div>
      </div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ’Œ</span><span class="card-name">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹</span></div>
        <div class="card-body">
          <div class="form-row"><label class="field-label">ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</label><textarea id="msg-main" rows="3" oninput="markDirty()"></textarea><div class="hint">é‡‘è‰²ã«ã—ãŸã„éƒ¨åˆ†ã‚’ &lt;span&gt;ã€œ&lt;/span&gt; ã§å›²ã‚“ã§ãã ã•ã„ã€‚</div></div>
          <div class="form-row"><label class="field-label">ã‚µãƒ–ãƒ†ã‚­ã‚¹ãƒˆ</label><textarea id="msg-body" rows="3" oninput="markDirty()"></textarea></div>
        </div>
      </div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ“£</span><span class="card-name">CTA</span></div>
        <div class="card-body">
          <div class="form-row"><label class="field-label">CTAã‚¿ã‚¤ãƒˆãƒ«</label><textarea id="cta-title" rows="2" oninput="markDirty()"></textarea></div>
        </div>
      </div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ—‚</span><span class="card-name">ãã®ä»–ã®æ–½å·¥äº‹ä¾‹ï¼ˆã‚®ãƒ£ãƒ©ãƒªãƒ¼ï¼‰</span><span class="card-desc">æº–å‚™ä¸­ãƒãƒŠãƒ¼</span></div>
        <div class="card-body">
          <div class="form-row"><label class="field-label">ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒˆãƒ«</label><input type="text" id="gallery-title" placeholder="ãã®ä»–ã®æ–½å·¥äº‹ä¾‹ã¯ã“ã¡ã‚‰" oninput="markDirty()"></div>
          <div class="form-row"><label class="field-label">èª¬æ˜ãƒ†ã‚­ã‚¹ãƒˆ</label><textarea id="gallery-body" rows="2" placeholder="ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¥ãƒ»ç´ æåˆ¥ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚’æº–å‚™ã—ã¦ã„ã¾ã™ã€‚" oninput="markDirty()"></textarea></div>
          <div class="form-row"><label class="field-label">ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</label><input type="text" id="gallery-btn-text" placeholder="æ–½å·¥äº‹ä¾‹ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚’è¦‹ã‚‹" oninput="markDirty()"></div>
          <div class="form-row"><label class="field-label">ã‚®ãƒ£ãƒ©ãƒªãƒ¼URLï¼ˆå®Œæˆå¾Œã«å…¥åŠ›ï¼‰</label><input type="url" id="gallery-url" placeholder="https://... ï¼ˆç©ºæ¬„ã®ã¾ã¾ã ã¨ã€Œæº–å‚™ä¸­ã€è¡¨ç¤ºï¼‰" oninput="markDirty()"><div class="hint">URLã‚’å…¥åŠ›ã™ã‚‹ã¨ãƒœã‚¿ãƒ³ãŒãƒªãƒ³ã‚¯ã«ãªã‚Šã€ã€Œæº–å‚™ä¸­ã€ãƒãƒƒã‚¸ãŒæ¶ˆãˆã¾ã™ã€‚</div></div>
        </div>
      </div>
    </div>

    <!-- ===== LOGOS ===== -->
    <div class="page" id="page-logos">
      <div class="page-title">ãƒ­ã‚´</div>
      <div class="page-sub">ãƒ•ãƒƒã‚¿ãƒ¼ãƒ»é€ã‹ã—ã«ä½¿ç”¨ã™ã‚‹ãƒ­ã‚´ç”»åƒã‚’è¨­å®šã—ã¾ã™ã€‚</div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ·</span><span class="card-name">ãƒ­ã‚´ç”»åƒ</span></div>
        <div class="card-body">
          <div class="logo-grid">
            <div>
              <div class="img-drop-label">ãƒ€ãƒ¼ã‚¯ç”¨ãƒ­ã‚´</div>
              <div class="logo-drop" id="drop-fdark" onclick="triggerUpload('file-fdark')">
                <img class="preview" id="prev-fdark" src="images/footer_logo_dark.jpg" alt="">
                <div class="img-drop-overlay"><span class="img-drop-icon">ğŸ“·</span><span class="img-drop-text">ã‚¯ãƒªãƒƒã‚¯ã—ã¦å¤‰æ›´</span></div>
                <input type="file" id="file-fdark" accept="image/*" onchange="handleLogo(this,'footer-logo-dark','prev-fdark','drop-fdark')">
              </div>
            </div>
            <div>
              <div class="img-drop-label">ãƒ©ã‚¤ãƒˆç”¨ãƒ­ã‚´</div>
              <div class="logo-drop" id="drop-flight" onclick="triggerUpload('file-flight')">
                <img class="preview" id="prev-flight" src="images/footer_logo_light.jpg" alt="">
                <div class="img-drop-overlay"><span class="img-drop-icon">ğŸ“·</span><span class="img-drop-text">ã‚¯ãƒªãƒƒã‚¯ã—ã¦å¤‰æ›´</span></div>
                <input type="file" id="file-flight" accept="image/*" onchange="handleLogo(this,'footer-logo-light','prev-flight','drop-flight')">
              </div>
            </div>
            <div>
              <div class="img-drop-label">é€ã‹ã—ç”¨ï¼ˆPNGæ¨å¥¨ï¼‰</div>
              <div class="logo-drop" id="drop-logo" onclick="triggerUpload('file-logo')">
                <img class="preview" id="prev-logo" src="images/logo.png" alt="">
                <div class="img-drop-overlay"><span class="img-drop-icon">ğŸ“·</span><span class="img-drop-text">ã‚¯ãƒªãƒƒã‚¯ã—ã¦å¤‰æ›´</span></div>
                <input type="file" id="file-logo" accept="image/*" onchange="handleLogo(this,'logo','prev-logo','drop-logo')">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== PROFILE ===== -->
    <div class="page" id="page-profile">
      <div class="page-title">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</div>
      <div class="page-sub">ã¬ãƒ¼ã¾ã‚“ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç·¨é›†ã—ã¾ã™ã€‚</div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ‘¤</span><span class="card-name">åŸºæœ¬æƒ…å ±</span></div>
        <div class="card-body">
          <div class="form-grid form-row">
            <div><label class="field-label">åå‰ï¼ˆæ—¥æœ¬èªï¼‰</label><input type="text" id="numan-name-ja" placeholder="ã‚»ãƒ¡ãƒ³ãƒˆã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ ã¬ãƒ¼ã¾ã‚“" oninput="markDirty()"></div>
            <div><label class="field-label">åå‰ï¼ˆè‹±èªï¼‰</label><input type="text" id="numan-name-en" placeholder="Cement Artist Nuâ˜†Man" oninput="markDirty()"></div>
          </div>
          <div class="form-grid form-row">
            <div><label class="field-label">ğŸ“ å ´æ‰€</label><input type="text" id="numan-location" placeholder="ä¸‰é‡çœŒ æ¾é˜ªå¸‚" oninput="markDirty()"></div>
            <div><label class="field-label">ğŸ—“ çµŒæ­´</label><input type="text" id="numan-career" placeholder="ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¹ãƒˆãƒ¼ãƒ³æ­´ 2019å¹´ã€œ" oninput="markDirty()"></div>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ“–</span><span class="card-name">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ–‡</span></div>
        <div class="card-body">
          <div class="form-row"><textarea id="numan-body" rows="10" oninput="markDirty()"></textarea></div>
        </div>
      </div>
      <div class="card">
        <div class="card-head"><span class="card-icon">ğŸ–¼</span><span class="card-name">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å†™çœŸ</span></div>
        <div class="card-body">
          <div style="display:grid;grid-template-columns:200px 160px;gap:16px;">
            <div>
              <div class="img-drop-label">ãƒ¡ã‚¤ãƒ³å†™çœŸï¼ˆã‚«ãƒ©ãƒ¼ï¼‰</div>
              <div class="logo-drop" style="aspect-ratio:1;" id="drop-nm" onclick="triggerUpload('file-nm')">
                <img class="preview" id="prev-nm" src="images/numan_color.jpg" alt="">
                <div class="img-drop-overlay"><span class="img-drop-icon">ğŸ“·</span><span class="img-drop-text">å¤‰æ›´</span></div>
                <input type="file" id="file-nm" accept="image/*" onchange="handleLogo(this,'numan-color','prev-nm','drop-nm')">
              </div>
            </div>
            <div>
              <div class="img-drop-label">ã‚µãƒ–å†™çœŸ</div>
              <div class="logo-drop" style="aspect-ratio:1;" id="drop-ns" onclick="triggerUpload('file-ns')">
                <img class="preview" id="prev-ns" src="images/numan_portrait.jpg" alt="">
                <div class="img-drop-overlay"><span class="img-drop-icon">ğŸ“·</span><span class="img-drop-text">å¤‰æ›´</span></div>
                <input type="file" id="file-ns" accept="image/*" onchange="handleLogo(this,'numan-portrait','prev-ns','drop-ns')">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== SECTIONS ===== -->
    <div class="page" id="page-sections">
      <div class="page-title">ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¨­å®š</div>
      <div class="page-sub">å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®è¡¨ç¤ºãƒ»éè¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚</div>
      <div class="card">
        <div class="card-body">
          <div class="toggle-row"><div class="toggle-info"><div class="t-label">BAã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³</div></div><label class="toggle"><input type="checkbox" id="sec-ba" checked onchange="markDirty()"><span class="toggle-track"></span><span class="toggle-thumb"></span></label></div>
          <div class="toggle-row"><div class="toggle-info"><div class="t-label">å‹•ç”»ã‚»ã‚¯ã‚·ãƒ§ãƒ³</div></div><label class="toggle"><input type="checkbox" id="sec-video" onchange="markDirty()"><span class="toggle-track"></span><span class="toggle-thumb"></span></label></div>
          <div class="toggle-row"><div class="toggle-info"><div class="t-label">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚»ã‚¯ã‚·ãƒ§ãƒ³</div></div><label class="toggle"><input type="checkbox" id="sec-profile" checked onchange="markDirty()"><span class="toggle-track"></span><span class="toggle-thumb"></span></label></div>
          <div class="toggle-row"><div class="toggle-info"><div class="t-label">Why KIMARUã‚»ã‚¯ã‚·ãƒ§ãƒ³</div></div><label class="toggle"><input type="checkbox" id="sec-why" checked onchange="markDirty()"><span class="toggle-track"></span><span class="toggle-thumb"></span></label></div>
        </div>
      </div>
    </div>

  </main>
</div>

<!-- SAVE BAR -->
<div class="save-bar" id="save-bar">
  <div class="save-msg">âš  <strong>æœªä¿å­˜ã®å¤‰æ›´ãŒã‚ã‚Šã¾ã™ã€‚</strong></div>
  <div class="save-btns">
    <button class="btn btn-secondary" onclick="resetAll()">ãƒªã‚»ãƒƒãƒˆ</button>
    <button class="btn btn-primary" onclick="generateAndDownload()">â¬‡ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
  </div>
</div>
<div class="toast" id="toast"><span style="color:var(--green)">âœ…</span><span id="toast-msg"></span></div>

<script>
// ===== STATE =====
var dirty=false;
var imageData={};// keyâ†’{base64,filename}
var baCards=[];// array of {id,title,before,after,finish,color,grout,sample}

// ===== NAV =====
function showPage(id,el){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  document.getElementById('page-'+id).classList.add('active');
  el.classList.add('active');
}

// ===== DIRTY =====
// ===== Google Drive URL å¤‰æ› =====
function extractDriveId(url){
  var m=url.match(/\/file\/d\/([a-zA-Z0-9_-]+)/);
  if(m)return m[1];
  m=url.match(/[?&]id=([a-zA-Z0-9_-]+)/);
  if(m)return m[1];
  return null;
}

function autoConvertDriveUrl(val){
  if(!val) return;
  var id = extractDriveId(val);
  if(!id) return;
  // ãƒ‰ãƒ©ã‚¤ãƒ–URLã£ã½ã‘ã‚Œã°è‡ªå‹•ã§â‘ ã«å¤‰æ›ã—ã¦ã‚»ãƒƒãƒˆ
  var converted = 'https://drive.google.com/uc?export=download&id='+id;
  document.getElementById('video-url').value = converted;
  markDirty();
}

function convertDriveUrl(){
  var raw=document.getElementById('drive-raw-url').value.trim();
  if(!raw){showToast('âš  Googleãƒ‰ãƒ©ã‚¤ãƒ–URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');return;}
  var id=extractDriveId(raw);
  if(!id){showToast('âš  ãƒ•ã‚¡ã‚¤ãƒ«IDãŒå–å¾—ã§ãã¾ã›ã‚“ã€‚URLã‚’ç¢ºèªã—ã¦ãã ã•ã„');return;}

  // 3ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆ
  var opts=[
    {
      num:'â‘ ',
      label:'ç›´æ¥ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ãƒ»100MBä»¥ä¸‹ï¼‰',
      url:'https://drive.google.com/uc?export=download&id='+id
    },
    {
      num:'â‘¡',
      label:'å¼·åˆ¶ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆå¤§å®¹é‡ãƒ•ã‚¡ã‚¤ãƒ«å‘ã‘ï¼‰',
      url:'https://drive.usercontent.google.com/download?id='+id+'&export=download&authuser=0&confirm=t'
    },
    {
      num:'â‘¢',
      label:'ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼åŸ‹ã‚è¾¼ã¿ï¼ˆå†ç”Ÿã§ããªã„æ™‚ã®ä»£æ›¿ï¼‰',
      url:'https://drive.google.com/file/d/'+id+'/preview'
    }
  ];

  var container=document.getElementById('drive-url-options');
  // store urls globally for index access
  window._driveOpts=opts;
  container.innerHTML=opts.map(function(opt,i){
    return '<div class="drive-opt" onclick="selectDriveUrlByIndex('+i+',this)">'
      +'<span class="drive-opt-num">'+opt.num+'</span>'
      +'<div class="drive-opt-info">'
      +'<div class="drive-opt-label">'+opt.label+'</div>'
      +'<div class="drive-opt-url">'+opt.url+'</div>'
      +'</div>'
      +'</div>';
  }).join('');

  document.getElementById('drive-results').style.display='block';
  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆâ‘ ã‚’è‡ªå‹•ã‚»ãƒƒãƒˆ
  selectDriveUrlByIndex(0, container.firstChild);
  showToast('âœ… å¤‰æ›ã—ã¾ã—ãŸã€‚URLã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
}

function selectDriveUrlByIndex(i, el){
  var opts=window._driveOpts||[];
  if(!opts[i])return;
  selectDriveUrl(el, opts[i].url);
}

function selectDriveUrl(el, url){
  document.querySelectorAll('.drive-opt').forEach(function(o){o.classList.remove('selected');});
  el.classList.add('selected');
  document.getElementById('video-url').value=url;
  markDirty();
}

function selectTheme(theme, el){
  document.querySelectorAll('.theme-btn').forEach(function(btn){ btn.classList.remove('active'); });
  el.classList.add('active');
  markDirty();
}

function markDirty(){dirty=true;document.getElementById('save-bar').classList.add('show');}
function resetAll(){if(!confirm('å¤‰æ›´ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ'))return;dirty=false;document.getElementById('save-bar').classList.remove('show');loadDefaults();
  setupAllDragDrop();}

// ===== BA CARDS =====
var baIdCounter=0;

function addBaCard(data){
  if(!data)data={id:'ba_'+(baIdCounter++),title:'',before:'',after:'',finish:'',color:'',grout:'',sample:''};
  else if(!data.id)data.id='ba_'+(baIdCounter++);
  baCards.push(data);
  renderBaCards();
  markDirty();
}

function removeBaCard(id){
  baCards=baCards.filter(c=>c.id!==id);
  renderBaCards();
  markDirty();
}

function renderBaCards(){
  var container=document.getElementById('ba-cards');
  container.innerHTML='';
  baCards.forEach(function(item,i){
    var div=document.createElement('div');
    div.className='ba-card';
    div.id='card-'+item.id;
    div.innerHTML=buildBaCardHTML(item,i);
    container.appendChild(div);
    initBaPreview(item.id);
  });
}

function buildBaCardHTML(item,i){
  var num=(i+1<10?'0'+(i+1):String(i+1));
  var angles=item.angles||[];
  var anglesUI=angles.map(function(ang,ai){
    return '<div style="display:flex;gap:10px;align-items:flex-start;margin-bottom:10px;">'
      +'<div><div class="img-drop'+(ang.src?' has-img':'')+'" style="width:120px;height:90px;" id="drop-ang-'+item.id+'-'+ai+'" onclick="triggerUpload(\'file-ang-'+item.id+'-'+ai+'\')">'
      +(ang.src?'<img class="preview" src="'+ang.src+'" alt="">':'')
      +'<div class="img-drop-overlay"><span class="img-drop-icon" style="font-size:1.2rem;">&#128247;</span></div>'
      +'<input type="file" id="file-ang-'+item.id+'-'+ai+'" accept="image/*" onchange="handleAngleImage(this,\''+item.id+'\','+ai+')">'
      +'</div></div>'
      +'<div style="flex:1;">'
      +'<label class="field-label">ãƒ©ãƒ™ãƒ«</label>'
      +'<input type="text" style="margin-bottom:8px;" placeholder="ä¾‹ï¼šé³¥è¦³å›³ã€å¤œæ™¯ã€ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—" value="'+escHtml(ang.label||'')+'" oninput="updateAngleLabel(\''+item.id+'\','+ai+',this.value)">'
      +'<button class="btn btn-danger" style="padding:5px 12px;font-size:.7rem;" onclick="removeAngle(\''+item.id+'\','+ai+')">&#10005; å‰Šé™¤</button>'
      +'</div></div>';
  }).join('');

  var beforeHasImg=item.before?'has-img':'';
  var afterHasImg=item.after?'has-img':'';
  var sampleHasImg=item.sample?'has-img':'';

  return '<div class="ba-card-head">'
    +'<span class="ba-card-num">'+num+'</span>'
    +'<input class="ba-card-title-input" type="text" placeholder="ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆä¾‹ï¼šRSã‚¿ã‚¤ãƒ«èª¿ ç„é–¢ã‚¢ãƒ—ãƒ­ãƒ¼ãƒï¼‰" value="'+escHtml(item.title)+'" oninput="updateBaField(\''+item.id+'\',\'title\',this.value)">'
    +'<button class="btn btn-danger" onclick="removeBaCard(\''+item.id+'\')">å‰Šé™¤</button>'
    +'</div>'
    +'<div class="ba-card-body">'
    +'<div class="ba-preview-panel">'
    +'<div class="ba-preview-slider" id="preview-slider-'+item.id+'">'
    +(item.before?'<img class="ba-preview-img" src="'+item.before+'" alt="">':'')
    +(item.after?'<img class="ba-preview-img ba-preview-after" src="'+item.after+'" alt="">':'')
    +(item.before||item.after?'<div class="ba-preview-handle"><div class="ba-preview-line"></div><div class="ba-preview-pill">SLIDE</div></div>':'<div class="ba-preview-empty">ç”»åƒã‚’ã‚¢ãƒƒãƒ—ã™ã‚‹ã¨ã“ã“ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>')
    +'</div></div>'
    +'<div class="ba-img-grid">'
    +'<div><div class="img-drop-label">Beforeï¼ˆæ–½å·¥å‰ï¼‰</div>'
    +'<div class="img-drop '+beforeHasImg+'" id="drop-b-'+item.id+'" onclick="triggerUpload(\'file-b-'+item.id+'\')">'
    +(item.before?'<img class="preview" src="'+item.before+'" alt="">':'')
    +'<div class="img-drop-overlay"><span class="img-drop-icon">&#128247;</span><span class="img-drop-text">æ–½å·¥å‰ã®å†™çœŸ</span></div>'
    +'<input type="file" id="file-b-'+item.id+'" accept="image/*" onchange="handleBaImage(this,\''+item.id+'\',\'before\')">'
    +'</div></div>'
    +'<div><div class="img-drop-label">Afterï¼ˆæ–½å·¥å¾Œï¼‰</div>'
    +'<div class="img-drop '+afterHasImg+'" id="drop-a-'+item.id+'" onclick="triggerUpload(\'file-a-'+item.id+'\')">'
    +(item.after?'<img class="preview" src="'+item.after+'" alt="">':'')
    +'<div class="img-drop-overlay"><span class="img-drop-icon">&#128247;</span><span class="img-drop-text">æ–½å·¥å¾Œã®å†™çœŸ</span></div>'
    +'<input type="file" id="file-a-'+item.id+'" accept="image/*" onchange="handleBaImage(this,\''+item.id+'\',\'after\')">'
    +'</div></div>'
    +'</div>'
    +'<div class="info-fields">'
    +'<div><label class="field-label">ä»•ä¸Šã’å</label><input type="text" placeholder="RSã‚¿ã‚¤ãƒ«èª¿" value="'+escHtml(item.finish)+'" oninput="updateBaField(\''+item.id+'\',\'finish\',this.value)"></div>'
    +'<div><label class="field-label">ã‚«ãƒ©ãƒ¼</label><input type="text" placeholder="ã‚°ãƒ¬ãƒ¼" value="'+escHtml(item.color)+'" oninput="updateBaField(\''+item.id+'\',\'color\',this.value)"></div>'
    +'<div><label class="field-label">ç›®åœ°</label><input type="text" placeholder="ãƒ–ãƒ©ãƒƒã‚¯" value="'+escHtml(item.grout)+'" oninput="updateBaField(\''+item.id+'\',\'grout\',this.value)"></div>'
    +'</div>'
    +'<div class="sample-row" style="margin-bottom:16px;">'
    +'<div><div class="img-drop-label" style="margin-bottom:6px;">ç´ æã‚µãƒ³ãƒ—ãƒ«ç”»åƒï¼ˆä»»æ„ï¼‰</div>'
    +'<div class="img-drop '+sampleHasImg+'" style="width:80px;height:80px;aspect-ratio:1;" id="drop-s-'+item.id+'" onclick="triggerUpload(\'file-s-'+item.id+'\')">'
    +(item.sample?'<img class="preview" src="'+item.sample+'" alt="">':'')
    +'<div class="img-drop-overlay"><span class="img-drop-icon" style="font-size:1.2rem;">&#128247;</span></div>'
    +'<input type="file" id="file-s-'+item.id+'" accept="image/*" onchange="handleBaImage(this,\''+item.id+'\',\'sample\')">'
    +'</div></div>'
    +'<div style="font-size:.72rem;color:var(--text2);line-height:2;">ã‚¯ãƒªãƒƒã‚¯ã§æ‹¡å¤§ã§ãã‚‹å°ã•ãªã‚µãƒ ãƒã‚¤ãƒ«<br>ã¨ã—ã¦ä»•ä¸Šã’èª¬æ˜ã®æ¨ªã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>'
    +'</div>'
    +'<div><div class="img-drop-label" style="margin-bottom:8px;">è¿½åŠ ã‚¢ãƒ³ã‚°ãƒ«å†™çœŸï¼ˆé³¥è¦³å›³ãƒ»å¤œæ™¯ãƒ»ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ãªã©ï¼‰</div>'
    +'<div class="angles-list" id="angles-'+item.id+'">'
    +anglesUI
    +'</div>'
    +'<button class="btn btn-add" style="margin-top:10px;padding:10px;" onclick="addAngle(\''+item.id+'\')">ï¼‹ ã‚¢ãƒ³ã‚°ãƒ«å†™çœŸã‚’è¿½åŠ </button>'
    +'</div>'
    +'</div>';
}

function buildAnglesHTML(item){
  var angles=item.angles||[];
  return angles.map(function(ang,ai){
    return '<div style="display:flex;gap:10px;align-items:flex-start;margin-bottom:10px;">'
      +'<div><div class="img-drop'+(ang.src?' has-img':'')+'" style="width:120px;height:90px;" id="drop-ang-'+item.id+'-'+ai+'" onclick="triggerUpload(\'file-ang-'+item.id+'-'+ai+'\')">'
      +(ang.src?'<img class="preview" src="'+ang.src+'" alt="">':'')
      +'<div class="img-drop-overlay"><span class="img-drop-icon" style="font-size:1.2rem;">&#128247;</span></div>'
      +'<input type="file" id="file-ang-'+item.id+'-'+ai+'" accept="image/*" onchange="handleAngleImage(this,\''+item.id+'\','+ai+')">'
      +'</div></div>'
      +'<div style="flex:1;">'
      +'<label class="field-label">ãƒ©ãƒ™ãƒ«</label>'
      +'<input type="text" style="margin-bottom:8px;" placeholder="ä¾‹ï¼šé³¥è¦³å›³ã€å¤œæ™¯ã€ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—" value="'+escHtml(ang.label||'')+'" oninput="updateAngleLabel(\''+item.id+'\','+ai+',this.value)">'
      +'<button class="btn btn-danger" style="padding:5px 12px;font-size:.7rem;" onclick="removeAngle(\''+item.id+'\','+ai+')">&#10005; å‰Šé™¤</button>'
      +'</div></div>';
  }).join('');
}

function addAngle(cardId){
  var item=baCards.find(function(c){return c.id===cardId;});
  if(!item)return;
  if(!item.angles)item.angles=[];
  item.angles.push({src:'',label:''});
  var container=document.getElementById('angles-'+cardId);
  if(container)container.innerHTML=buildAnglesHTML(item);
  markDirty();
}

function removeAngle(cardId,ai){
  var item=baCards.find(function(c){return c.id===cardId;});
  if(!item||!item.angles)return;
  item.angles.splice(ai,1);
  var container=document.getElementById('angles-'+cardId);
  if(container)container.innerHTML=buildAnglesHTML(item);
  markDirty();
}

function updateAngleLabel(cardId,ai,val){
  var item=baCards.find(function(c){return c.id===cardId;});
  if(!item||!item.angles||!item.angles[ai])return;
  item.angles[ai].label=val;
  markDirty();
}

function handleAngleImage(input,cardId,ai){
  var file=input.files[0];if(!file)return;
  var reader=new FileReader();
  reader.onload=function(e){
    var item=baCards.find(function(c){return c.id===cardId;});
    if(!item)return;
    if(!item.angles)item.angles=[];
    if(!item.angles[ai])item.angles[ai]={src:'',label:''};
    item.angles[ai].src=e.target.result;
    var drop=document.getElementById('drop-ang-'+cardId+'-'+ai);
    if(drop){
      drop.classList.add('has-img');
      var prev=drop.querySelector('img.preview');
      if(prev)prev.src=e.target.result;
      else{var img=document.createElement('img');img.className='preview';img.src=e.target.result;drop.insertBefore(img,drop.firstChild);}
    }
    markDirty();
  };
  reader.readAsDataURL(file);
}

function escHtml(s){return (s||'').replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

function updateBaField(id,field,val){
  var item=baCards.find(c=>c.id===id);
  if(item){item[field]=val;markDirty();}
}

function handleBaImage(input,id,field){
  var file=input.files[0];if(!file)return;
  var reader=new FileReader();
  reader.onload=function(e){
    var b64=e.target.result;
    var item=baCards.find(c=>c.id===id);
    if(!item)return;
    item[field]=b64;
    markDirty();
    // Update preview in card
    var drop=document.getElementById('drop-'+field[0]+'-'+id);
    if(drop){
      drop.classList.add('has-img');
      var prev=drop.querySelector('img.preview');
      if(prev)prev.src=b64;
      else{var img=document.createElement('img');img.className='preview';img.src=b64;drop.insertBefore(img,drop.firstChild);}
    }
    var fn=document.getElementById('fn-'+field[0]+'-'+id);
    if(fn)fn.textContent='ç”»åƒè¨­å®šæ¸ˆã¿ï¼ˆ'+file.name+')';
    // Update slider preview
    if(field==='before'||field==='after'){
      var slider=document.getElementById('preview-slider-'+id);
      if(slider){
        // Rebuild preview
        var beforeSrc=item.before||'';
        var afterSrc=item.after||'';
        slider.innerHTML=(beforeSrc?'<img class="ba-preview-img" src="'+beforeSrc+'" alt="">':'')
          +(afterSrc?'<img class="ba-preview-img ba-preview-after" id="prev-after-'+id+'" src="'+afterSrc+'" alt="">':'')
          +((beforeSrc||afterSrc)?'<div class="ba-preview-handle"><div class="ba-preview-line"></div><div class="ba-preview-pill">SLIDE</div></div>':'<div class="ba-preview-empty">ç”»åƒã‚’ã‚¢ãƒƒãƒ—ã™ã‚‹ã¨ã“ã“ã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</div>');
        initBaPreview(id);
      }
    }
    if(field==='sample'){
      var sdrop=document.getElementById('drop-s-'+id);
      if(sdrop){
        var simg=sdrop.querySelector('img.preview');
        if(simg)simg.src=b64;
        else{var si=document.createElement('img');si.className='preview';si.src=b64;sdrop.insertBefore(si,sdrop.firstChild);}
      }
    }
  };
  reader.readAsDataURL(file);
}

function initBaPreview(id){
  var slider=document.getElementById('preview-slider-'+id);
  if(!slider)return;
  var afterImg=slider.querySelector('.ba-preview-after');
  if(!afterImg)return;
  var handle=slider.querySelector('.ba-preview-handle');
  var dragging=false;
  function update(clientX){
    var rect=slider.getBoundingClientRect();
    var pos=Math.max(0,Math.min(100,((clientX-rect.left)/rect.width)*100));
    afterImg.style.clipPath='inset(0 0 0 '+pos+'%)';
    if(handle){handle.style.left=pos+'%';handle.style.transform='translateX(-50%)';}
  }
  slider.addEventListener('mousedown',function(e){dragging=true;update(e.clientX);});
  window.addEventListener('mousemove',function(e){if(dragging)update(e.clientX);});
  window.addEventListener('mouseup',function(){dragging=false;});
  slider.addEventListener('touchstart',function(e){update(e.touches[0].clientX);},{passive:true});
  slider.addEventListener('touchmove',function(e){update(e.touches[0].clientX);},{passive:true});
}

// ===== LOGO UPLOAD =====
function triggerUpload(id){document.getElementById(id).click();}

function setupAllDragDrop(){
  document.querySelectorAll('.img-drop, .logo-drop').forEach(function(drop){
    if(drop._dd) return;
    drop._dd = true;
    var input = drop.querySelector('input[type=file]');
    if(!input) return;

    // ãƒ†ã‚­ã‚¹ãƒˆæ›´æ–°
    var txt = drop.querySelector('.img-drop-text');
    if(txt) txt.textContent = 'ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ãƒ‰ãƒ­ãƒƒãƒ—';

    drop.addEventListener('dragover', function(e){
      e.preventDefault(); e.stopPropagation();
      drop.style.borderColor = 'var(--gold)';
      drop.style.background  = 'rgba(201,168,76,.1)';
    });
    drop.addEventListener('dragleave', function(){
      drop.style.borderColor = '';
      drop.style.background  = '';
    });
    drop.addEventListener('drop', function(e){
      e.preventDefault(); e.stopPropagation();
      drop.style.borderColor = '';
      drop.style.background  = '';
      var file = e.dataTransfer.files[0];
      if(!file || !file.type.startsWith('image/')) return;
      try{
        var dt = new DataTransfer();
        dt.items.add(file);
        input.files = dt.files;
      }catch(ex){ return; }
      input.dispatchEvent(new Event('change'));
    });
  });
}

// ===== ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ— =====
function initDragDrop(dropEl, fileInput, onLoadFn){
  dropEl.addEventListener('dragover', function(e){
    e.preventDefault();
    dropEl.style.borderColor='var(--gold)';
    dropEl.style.background='rgba(201,168,76,.08)';
  });
  dropEl.addEventListener('dragleave', function(){
    dropEl.style.borderColor='';
    dropEl.style.background='';
  });
  dropEl.addEventListener('drop', function(e){
    e.preventDefault();
    dropEl.style.borderColor='';
    dropEl.style.background='';
    var file = e.dataTransfer.files[0];
    if(!file || !file.type.startsWith('image/')) return;
    // fileInputã«ã‚»ãƒƒãƒˆã—ã¦onchangeã¨åŒã˜å‡¦ç†ã‚’èµ°ã‚‰ã›ã‚‹
    var dt = new DataTransfer();
    dt.items.add(file);
    fileInput.files = dt.files;
    onLoadFn(fileInput);
  });
}

// å…¨ç”»åƒã‚¨ãƒªã‚¢ã«D&Dé©ç”¨ï¼ˆDOMæ§‹ç¯‰å¾Œã«å‘¼ã¶ï¼‰
function setupAllDragDrop(){
  document.querySelectorAll('.img-drop, .logo-drop').forEach(function(drop){
    var input = drop.querySelector('input[type=file]');
    if(!input || drop._ddInit) return;
    drop._ddInit = true;
    initDragDrop(drop, input, function(inp){
      var ev = new Event('change');
      inp.dispatchEvent(ev);
    });
    // ãƒ†ã‚­ã‚¹ãƒˆæ›´æ–°
    var txt = drop.querySelector('.img-drop-text');
    if(txt) txt.textContent = 'ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ãƒ‰ãƒ­ãƒƒãƒ—';
  });
}

function handleLogo(input,key,previewId,dropId){
  var file=input.files[0];if(!file)return;
  var reader=new FileReader();
  reader.onload=function(e){
    imageData[key]={base64:e.target.result,filename:file.name};
    var prev=document.getElementById(previewId);
    if(prev){prev.src=e.target.result;prev.style.display='block';}
    var drop=document.getElementById(dropId);
    if(drop)drop.classList.add('has-img');
    markDirty();
  };
  reader.readAsDataURL(file);
}

// ===== DEFAULTS =====
function loadDefaults(){
  var s={};
  try{s=JSON.parse(localStorage.getItem('kimaru-settings')||'{}');}catch(e){}
  setVal('ga4-id',s['ga4-id']||'');
  setVal('line-url',s['line-url']||'https://lin.ee/xxxxxxx');
  setVal('line-btn-text',s['line-btn-text']||'LINE ã§ãŠå•ã„åˆã‚ã›');
  setVal('ig-url',s['ig-url']||'https://www.instagram.com/cementart_numan/');
  setVal('video-url',s['video-url']||'');
  setVal('video-title',s['video-title']||'');
  setVal('video-body',s['video-body']||'');
  setVal('video-poster',s['video-poster']||'');
  setCheck('video-visible',s['video-visible']||false);
  setVal('hero-catch',s['hero-catch']||'æ–½å·¥ã®ç¾å ´ãŒã€ãã®ã¾ã¾<br>æœ€é«˜ã®ææ¡ˆæ›¸ã«ãªã‚‹ã€‚');
  setVal('hero-sub',s['hero-sub']||'æ–½å·¥ã®ç¾å ´ãŒã€ãã®ã¾ã¾æœ€é«˜ã®ææ¡ˆæ›¸ã«ãªã‚‹ã€‚\nKIMARUãŒã€ã‚ãªãŸã®å–¶æ¥­ã‚’å¤‰ãˆã¾ã™ã€‚');
  setVal('msg-main',s['msg-main']||'ã‚µãƒ³ãƒ—ãƒ«ã‚’æŒã£ã¦è¡Œã£ã¦ã‚‚å¥‘ç´„ãŒå–ã‚Œãªã„ã€\nãã‚“ãªæ™‚ä»£ã¯<span>ã‚‚ã†çµ‚ã‚ã‚Š</span>ã«ã—ã¾ã›ã‚“ã‹ã€‚');
  setVal('msg-body',s['msg-body']||'æŠ€è¡“ã¯æœ¬ç‰©ãªã®ã«ã€ä¼ãˆæ–¹ãŒè¿½ã„ã¤ã„ã¦ã„ãªã„ã ã‘ã€‚\nKIMARUã‚’ä½¿ãˆã°ã€ãŠå®¢æ§˜ãŒè‡ªåˆ†ã§ã€Œæ±ºã‚ã‚‹ã€ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚');
  setVal('cta-title',s['cta-title']||'æ°—ã«ãªã£ãŸæ–¹ã¯ã€\nã¾ãšLINEã§è©±ã—ã¾ã—ã‚‡ã†ã€‚');
  // ãƒ†ãƒ¼ãƒå¾©å…ƒ
  var savedTheme = s['theme'] || 'dark';
  document.querySelectorAll('.theme-btn').forEach(function(btn){
    btn.classList.toggle('active', btn.dataset.theme === savedTheme);
  });
  setVal('gallery-title',s['gallery-title']||'ãã®ä»–ã®æ–½å·¥äº‹ä¾‹ã¯ã“ã¡ã‚‰');
  setVal('gallery-body',s['gallery-body']||'ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¥ãƒ»ç´ æåˆ¥ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚’æº–å‚™ã—ã¦ã„ã¾ã™ã€‚');
  setVal('gallery-btn-text',s['gallery-btn-text']||'æ–½å·¥äº‹ä¾‹ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚’è¦‹ã‚‹');
  setVal('gallery-url',s['gallery-url']||'');
  setVal('numan-name-ja',s['numan-name-ja']||'ã‚»ãƒ¡ãƒ³ãƒˆã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ\nã¬ãƒ¼ã¾ã‚“');
  setVal('numan-name-en',s['numan-name-en']||'Cement Artist Nuâ˜†Man');
  setVal('numan-location',s['numan-location']||'ä¸‰é‡çœŒ æ¾é˜ªå¸‚');
  setVal('numan-career',s['numan-career']||'ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¹ãƒˆãƒ¼ãƒ³æ­´ 2019å¹´ã€œ');
  setVal('numan-body',s['numan-body']||'16æ­³ã‹ã‚‰å»ºè¨­æ¥­ç•Œã«é£›ã³è¾¼ã¿ã€é•·å¹´ã«ã‚ãŸã£ã¦ä»®è¨­äº‹æ¥­ãƒ»ä¸‹è«‹ã‘ã®ä¸–ç•Œã§åƒã„ã¦ããŸã€‚\n\nã„ã¤ã—ã‹ã€ã€Œã‚«ã‚¿ãƒã«æ®‹ã‚‹ä»•äº‹ãŒã—ãŸã„ã€ã¨æ€ã†ã‚ˆã†ã«ãªã£ãŸã€‚\nãã‚“ãªã¨ãå‡ºä¼šã£ãŸã®ãŒã€ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¹ãƒˆãƒ¼ãƒ³ã€‚\n\nãŠå®¢ã•ã‚“ã®å–œã¶å£°ã€ç¬‘é¡”ã«ç›´æ¥ãµã‚Œã‚‰ã‚Œã‚‹ä»•äº‹ã€‚\nãã—ã¦ã€ã“ã®ä»•äº‹ã«çœŸå‰£ã«å‘ãåˆã†ç†±ã„æ€ã„ã‚’æŒã£ãŸä»²é–“ãŸã¡ã¨å®šæœŸçš„ã«ä¼šãˆã‚‹ç’°å¢ƒã€‚\nå‡ºä¼šã†ãŸã³ã«æ°—ã¥ããŒã‚ã‚Šã€å­¦ã³ãŒã‚ã‚‹ã€‚\n\nã“ã®ç´ æ™´ã‚‰ã—ã„ä»•äº‹ã‚’ã€ã‚‚ã£ã¨å¤šãã®äººã«çŸ¥ã£ã¦ã‚‚ã‚‰ã„ãŸã„ã€‚\né«˜ã„æŠ€è¡“ã‚’æŒã¤ä»²é–“ãŸã¡ã«ã€ã‚‚ã£ã¨è‡ªä¿¡ã‚’æŒã£ã¦è¼ã‘ã‚‹æ©Ÿä¼šã‚’å±Šã‘ãŸã„ã€‚\nãã—ã¦ã€ç§è‡ªèº«ã‚’è‚²ã¦ã¦ãã‚ŒãŸROLLER STONEã¨ã„ã†æ¥­ç•Œã«ã€ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§æ©è¿”ã—ãŒã—ãŸã„ã€‚\n\nãã‚ŒãŒã€KIMARUã®åŸç‚¹ã§ã™ã€‚');
  setCheck('sec-ba',s['sec-ba']!==false);
  setCheck('sec-video',s['sec-video']||false);
  setCheck('sec-profile',s['sec-profile']!==false);
  setCheck('sec-why',s['sec-why']!==false);
  // BA cards
  baCards=[];
  baIdCounter=0;
  var savedCards=s['ba-cards']||[];
  if(savedCards.length){savedCards.forEach(function(c){c.id='ba_'+(baIdCounter++);baCards.push(c);});renderBaCards();}
  else{renderBaCards();}// empty state
}

function setVal(id,val){var el=document.getElementById(id);if(el)el.value=val;}
function setCheck(id,val){var el=document.getElementById(id);if(el)el.checked=val;}
function getVal(id){var el=document.getElementById(id);return el?el.value:'';}
function getCheck(id){var el=document.getElementById(id);return el?el.checked:false;}

// ===== SAVE SETTINGS =====
function saveSettings(){
  var s={
    'theme': document.querySelector('.theme-btn.active')?.dataset.theme || 'dark',
    'ga4-id':getVal('ga4-id'),
    'line-url':getVal('line-url'),
    'line-btn-text':getVal('line-btn-text'),
    'ig-url':getVal('ig-url'),
    'video-url':getVal('video-url'),
    'video-title':getVal('video-title'),
    'video-body':getVal('video-body'),
    'video-poster':getVal('video-poster'),
    'video-visible':getCheck('video-visible'),
    'hero-catch':getVal('hero-catch'),
    'hero-sub':getVal('hero-sub'),
    'msg-main':getVal('msg-main'),
    'msg-body':getVal('msg-body'),
    'cta-title':getVal('cta-title'),
    'gallery-title':getVal('gallery-title'),
    'gallery-body':getVal('gallery-body'),
    'gallery-btn-text':getVal('gallery-btn-text'),
    'gallery-url':getVal('gallery-url'),
    'numan-name-ja':getVal('numan-name-ja'),
    'numan-name-en':getVal('numan-name-en'),
    'numan-location':getVal('numan-location'),
    'numan-career':getVal('numan-career'),
    'numan-body':getVal('numan-body'),
    'sec-ba':getCheck('sec-ba'),
    'sec-video':getCheck('sec-video'),
    'sec-profile':getCheck('sec-profile'),
    'sec-why':getCheck('sec-why'),
    'ba-cards':baCards,
  };
  try{localStorage.setItem('kimaru-settings',JSON.stringify(s));}catch(e){}
  return s;
}

// ===== GENERATE HTML =====
// LPãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå†…è”µï¼ˆfetchãªã—ãƒ»GitHub Pagesã§å‹•ä½œï¼‰
var _LP_B64='PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImphIj4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9IlVURi04Ij4KPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAiPgo8dGl0bGU+S0lNQVJVIHwg5o+Q5qGI44GM5aSJ44KP44KL44Go44CB5aWR57SE44GM5aSJ44KP44KLPC90aXRsZT4KPCEtLSBHb29nbGUgdGFnIChndGFnLmpzKSAtLT4KPHNjcmlwdCBhc3luYyBzcmM9Imh0dHBzOi8vd3d3Lmdvb2dsZXRhZ21hbmFnZXIuY29tL2d0YWcvanM/aWQ9Ry0wVkYyNzdGNlJYIj48L3NjcmlwdD4KPHNjcmlwdD4KICB3aW5kb3cuZGF0YUxheWVyID0gd2luZG93LmRhdGFMYXllciB8fCBbXTsKICBmdW5jdGlvbiBndGFnKCl7ZGF0YUxheWVyLnB1c2goYXJndW1lbnRzKTt9CiAgZ3RhZygnanMnLCBuZXcgRGF0ZSgpKTsKICBndGFnKCdjb25maWcnLCAnRy0wVkYyNzdGNlJYJyk7Cjwvc2NyaXB0Pgo8bGluayByZWw9InByZWNvbm5lY3QiIGhyZWY9Imh0dHBzOi8vZm9udHMuZ29vZ2xlYXBpcy5jb20iPgo8bGluayBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2NzczI/ZmFtaWx5PU5vdG8rU2FucytKUDp3Z2h0QDMwMDs0MDA7NTAwOzcwMCZmYW1pbHk9Tm90bytTZXJpZitKUDp3Z2h0QDMwMDs0MDA7NjAwJmZhbWlseT1Db3Jtb3JhbnQrR2FyYW1vbmQ6d2dodEAzMDA7NDAwOzYwMCZkaXNwbGF5PXN3YXAiIHJlbD0ic3R5bGVzaGVldCI+CjxzdHlsZT4KOnJvb3QgeyAtLWdvbGQ6I0M5QTg0QzstLWdvbGQtZGltOnJnYmEoMjAxLDE2OCw3NiwwLjE1KTstLWdvbGQtbGluZTpyZ2JhKDIwMSwxNjgsNzYsMC4zKTstLXJhZGl1czo4cHg7IH0KW2RhdGEtdGhlbWU9ImRhcmsiXSAgeyAtLWJnOiMxMTE7LS1iZzI6IzE4MTgxODstLWJnMzojMjAyMDIwOy0tdGV4dDojZWVlYmU0Oy0tdGV4dDI6I2FhYTQ5YTstLWJvcmRlcjpyZ2JhKDIwMSwxNjgsNzYsMC4xOCk7LS13bS1vcGFjaXR5OjAuMDY7LS13bS1maWx0ZXI6bm9uZTstLWJhZGdlLWJnOnJnYmEoMjAxLDE2OCw3NiwwLjEyKTstLWNhcmQtYmc6IzE4MTgxODstLW1zZy1iZzojMTgxODE4OyB9CltkYXRhLXRoZW1lPSJsaWdodCJdIHsgLS1iZzojZjVmM2VmOy0tYmcyOiNlY2VhZTQ7LS1iZzM6I2UyZGZkODstLXRleHQ6IzFhMTgxNDstLXRleHQyOiM2YjY1NjA7LS1ib3JkZXI6cmdiYSgxMDAsODAsNDAsMC4xOCk7LS13bS1vcGFjaXR5OjAuMDc7LS13bS1maWx0ZXI6bm9uZTstLWJhZGdlLWJnOnJnYmEoMjAxLDE2OCw3NiwwLjE1KTstLWNhcmQtYmc6I2VjZWFlNDstLW1zZy1iZzojZWNlYWU0OyB9CltkYXRhLXRoZW1lPSJpbmsiXSAgIHsgLS1iZzojZjhmN2Y0Oy0tYmcyOiNmZmY7LS1iZzM6I2VlZWNlODstLXRleHQ6IzExMTstLXRleHQyOiM1NTU7LS1ib3JkZXI6cmdiYSgwLDAsMCwwLjEyKTstLWdvbGQ6IzFhMWExYTstLWdvbGQtZGltOnJnYmEoMCwwLDAsMC4wOCk7LS1nb2xkLWxpbmU6cmdiYSgwLDAsMCwwLjIpOy0td20tb3BhY2l0eTowLjA5Oy0td20tZmlsdGVyOm5vbmU7LS1iYWRnZS1iZzpyZ2JhKDAsMCwwLDAuMDYpOy0tY2FyZC1iZzojZmZmOy0tbXNnLWJnOiNmZmY7IH0KCiosKjo6YmVmb3JlLCo6OmFmdGVye2JveC1zaXppbmc6Ym9yZGVyLWJveDttYXJnaW46MDtwYWRkaW5nOjA7fQpodG1se3Njcm9sbC1iZWhhdmlvcjpzbW9vdGg7fQpib2R5e2JhY2tncm91bmQ6dmFyKC0tYmcpO2NvbG9yOnZhcigtLXRleHQpO2ZvbnQtZmFtaWx5OidOb3RvIFNhbnMgSlAnLHNhbnMtc2VyaWY7b3ZlcmZsb3cteDpoaWRkZW47bGluZS1oZWlnaHQ6MS43O3RyYW5zaXRpb246YmFja2dyb3VuZCAuNHMsY29sb3IgLjRzO30KCi8qIFdBVEVSTUFSSyAtIDPnrofmiYDjga7jgb8gKi8KLndte3Bvc2l0aW9uOmFic29sdXRlO2luc2V0OjA7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3BvaW50ZXItZXZlbnRzOm5vbmU7ei1pbmRleDowO292ZXJmbG93OmhpZGRlbjt9Ci53bSBpbWd7d2lkdGg6bWluKDY1JSw0ODBweCk7b3BhY2l0eTp2YXIoLS13bS1vcGFjaXR5KTtmaWx0ZXI6dmFyKC0td20tZmlsdGVyKTtvYmplY3QtZml0OmNvbnRhaW47dXNlci1zZWxlY3Q6bm9uZTt0cmFuc2l0aW9uOm9wYWNpdHkgLjRzO30KCi8qIE1PREUgQkFSICovCgovKiBBTklNUyAqLwpAa2V5ZnJhbWVzIGZhZGVVcHtmcm9te29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlWSgyMHB4KTt9dG97b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApO319CkBrZXlmcmFtZXMgZmFkZUlue2Zyb217b3BhY2l0eTowO310b3tvcGFjaXR5OjE7fX0KQGtleWZyYW1lcyBwdWxzZXswJSwxMDAle29wYWNpdHk6MC40O301MCV7b3BhY2l0eToxO319CgovKiBDQVRDSCAqLwouY2F0Y2gtaXRlbXtkaXNwbGF5Om5vbmU7Zm9udC1mYW1pbHk6J05vdG8gU2VyaWYgSlAnLHNlcmlmO2ZvbnQtc2l6ZTpjbGFtcCgxLjNyZW0sNS41dncsMi42cmVtKTtmb250LXdlaWdodDo0MDA7bGluZS1oZWlnaHQ6MS41O2xldHRlci1zcGFjaW5nOi41cHg7Y29sb3I6dmFyKC0tdGV4dCk7dGV4dC1hbGlnbjpjZW50ZXI7cGFkZGluZzowIDIwcHg7dHJhbnNpdGlvbjpjb2xvciAuNHM7fQouY2F0Y2gtaXRlbS5hY3RpdmV7ZGlzcGxheTpibG9jazthbmltYXRpb246ZmFkZVVwIC42cyBjdWJpYy1iZXppZXIoLjIyLDEsLjM2LDEpIGJvdGg7fQouY2F0Y2gtaXRlbSBzcGFue2NvbG9yOnZhcigtLWdvbGQpO3RyYW5zaXRpb246Y29sb3IgLjRzO30KCi8qIEhFUk8gKi8KLmhlcm97bWluLWhlaWdodDoxMDB2aDtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3RleHQtYWxpZ246Y2VudGVyO3BhZGRpbmc6ODBweCAyNHB4IDEyMHB4O3Bvc2l0aW9uOnJlbGF0aXZlO292ZXJmbG93OmhpZGRlbjt0cmFuc2l0aW9uOmJhY2tncm91bmQgLjRzO30KW2RhdGEtdGhlbWU9ImRhcmsiXSAuaGVyb3tiYWNrZ3JvdW5kOnJhZGlhbC1ncmFkaWVudChlbGxpcHNlIDgwJSA2MCUgYXQgNTAlIDQwJSxyZ2JhKDIwMSwxNjgsNzYsLjA2KSAwJSx0cmFuc3BhcmVudCA2NSUpLHZhcigtLWJnKTt9CltkYXRhLXRoZW1lPSJsaWdodCJdIC5oZXJve2JhY2tncm91bmQ6cmFkaWFsLWdyYWRpZW50KGVsbGlwc2UgODAlIDYwJSBhdCA1MCUgNDAlLHJnYmEoMjAxLDE2OCw3NiwuMDgpIDAlLHRyYW5zcGFyZW50IDY1JSksdmFyKC0tYmcpO30KW2RhdGEtdGhlbWU9ImluayJdIC5oZXJve2JhY2tncm91bmQ6dmFyKC0tYmcpO30KLmhlcm8+Kjpub3QoLndtKXtwb3NpdGlvbjpyZWxhdGl2ZTt6LWluZGV4OjE7fQouaGVyby1iYWRnZXtkaXNwbGF5OmlubGluZS1ibG9jaztiYWNrZ3JvdW5kOnZhcigtLWJhZGdlLWJnKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWdvbGQtbGluZSk7Y29sb3I6dmFyKC0tZ29sZCk7Zm9udC1zaXplOi43cmVtO2ZvbnQtd2VpZ2h0OjUwMDtsZXR0ZXItc3BhY2luZzo0cHg7cGFkZGluZzo3cHggMjBweDtib3JkZXItcmFkaXVzOjEwMHB4O21hcmdpbi1ib3R0b206NDBweDthbmltYXRpb246ZmFkZUluIC42cyAuMnMgYm90aDt0cmFuc2l0aW9uOmJhY2tncm91bmQgLjRzLGNvbG9yIC40cyxib3JkZXItY29sb3IgLjRzO30KLmhlcm8tY2F0Y2gtd3JhcHt3aWR0aDoxMDAlO21heC13aWR0aDo3NjBweDttaW4taGVpZ2h0OjEwMHB4O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjttYXJnaW4tYm90dG9tOjI0cHg7fQouaGVyby1kb3Rze2Rpc3BsYXk6ZmxleDtnYXA6OHB4O2p1c3RpZnktY29udGVudDpjZW50ZXI7bWFyZ2luLWJvdHRvbTozMnB4O2FuaW1hdGlvbjpmYWRlSW4gLjZzIC44cyBib3RoO30KLmhlcm8tZG90e3dpZHRoOjZweDtoZWlnaHQ6NnB4O2JvcmRlci1yYWRpdXM6NTAlO2JhY2tncm91bmQ6dmFyKC0tZ29sZC1kaW0pO2N1cnNvcjpwb2ludGVyO3RyYW5zaXRpb246YmFja2dyb3VuZCAuM3M7fQouaGVyby1kb3QuYWN0aXZle2JhY2tncm91bmQ6dmFyKC0tZ29sZCk7fQouaGVyby1zdWJ7Zm9udC1zaXplOmNsYW1wKC44NXJlbSwzLjV2dywxLjA1cmVtKTtjb2xvcjp2YXIoLS10ZXh0Mik7Zm9udC13ZWlnaHQ6MzAwO2xpbmUtaGVpZ2h0OjEuOTthbmltYXRpb246ZmFkZVVwIC42cyAuNXMgYm90aDt0cmFuc2l0aW9uOmNvbG9yIC40czt0ZXh0LWFsaWduOmNlbnRlcjtwYWRkaW5nOjAgNDhweCAwIDE2cHg7fQouaGVyby1zY3JvbGx7cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOjMycHg7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjZweDthbmltYXRpb246ZmFkZUluIC42cyAxLjJzIGJvdGg7fQouaGVyby1zY3JvbGwgc3Bhbntmb250LXNpemU6LjU1cmVtO2xldHRlci1zcGFjaW5nOjNweDtjb2xvcjp2YXIoLS10ZXh0Mik7dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlO30KLnNjcm9sbC1iYXJ7d2lkdGg6MXB4O2hlaWdodDoyOHB4O2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSx2YXIoLS1nb2xkKSx0cmFuc3BhcmVudCk7YW5pbWF0aW9uOnB1bHNlIDJzIGluZmluaXRlO30KCi8qIFNFQ1RJT05TICovCi5zZWN0aW9ue3BhZGRpbmc6ODBweCAyNHB4O3Bvc2l0aW9uOnJlbGF0aXZlO292ZXJmbG93OmhpZGRlbjt0cmFuc2l0aW9uOmJhY2tncm91bmQgLjRzO30KLnNlY3Rpb24taW5uZXJ7bWF4LXdpZHRoOjkwMHB4O21hcmdpbjowIGF1dG87cG9zaXRpb246cmVsYXRpdmU7ei1pbmRleDoxO30KLnNlY3Rpb24tdGFne2Rpc3BsYXk6aW5saW5lLWZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMHB4O2ZvbnQtc2l6ZTouNjhyZW07Zm9udC13ZWlnaHQ6NTAwO2xldHRlci1zcGFjaW5nOjRweDtjb2xvcjp2YXIoLS1nb2xkKTt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bWFyZ2luLWJvdHRvbToxNnB4O3RyYW5zaXRpb246Y29sb3IgLjRzO30KLnNlY3Rpb24tdGFnOjpiZWZvcmV7Y29udGVudDonJztkaXNwbGF5OmJsb2NrO3dpZHRoOjIwcHg7aGVpZ2h0OjFweDtiYWNrZ3JvdW5kOnZhcigtLWdvbGQpO3RyYW5zaXRpb246YmFja2dyb3VuZCAuNHM7fQouc2VjdGlvbi10aXRsZXtmb250LWZhbWlseTonTm90byBTZXJpZiBKUCcsc2VyaWY7Zm9udC1zaXplOmNsYW1wKDEuM3JlbSwzdncsMnJlbSk7Zm9udC13ZWlnaHQ6NDAwO2xpbmUtaGVpZ2h0OjEuNzttYXJnaW4tYm90dG9tOjE2cHg7dHJhbnNpdGlvbjpjb2xvciAuNHM7fQouc2VjdGlvbi1ib2R5e2ZvbnQtc2l6ZToxcmVtO2NvbG9yOnZhcigtLXRleHQyKTtmb250LXdlaWdodDozMDA7bGluZS1oZWlnaHQ6Mi40O3RyYW5zaXRpb246Y29sb3IgLjRzO30KCi8qIElOVFJPICovCi5pbnRyb3tiYWNrZ3JvdW5kOnZhcigtLWJnMik7Ym9yZGVyLXRvcDoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtib3JkZXItYm90dG9tOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO3RyYW5zaXRpb246YmFja2dyb3VuZCAuNHMsYm9yZGVyLWNvbG9yIC40czt9Ci5pbnRyby1jYXJkc3tkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdCgzLDFmcik7Z2FwOjFweDtiYWNrZ3JvdW5kOnZhcigtLWJvcmRlcik7bWFyZ2luLXRvcDo0MHB4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cyk7b3ZlcmZsb3c6aGlkZGVuO3RyYW5zaXRpb246YmFja2dyb3VuZCAuNHMsYm9yZGVyLWNvbG9yIC40czt9Ci5pbnRyby1jYXJke2JhY2tncm91bmQ6dmFyKC0tY2FyZC1iZyk7cGFkZGluZzoyOHB4IDIwcHg7dGV4dC1hbGlnbjpjZW50ZXI7dHJhbnNpdGlvbjpiYWNrZ3JvdW5kIC40czt9Ci5pbnRyby1jYXJkLW51bXtmb250LWZhbWlseTonQ29ybW9yYW50IEdhcmFtb25kJyxzZXJpZjtmb250LXNpemU6Mi40cmVtO2ZvbnQtd2VpZ2h0OjMwMDtjb2xvcjp2YXIoLS1nb2xkKTtvcGFjaXR5Oi40NTtsaW5lLWhlaWdodDoxO21hcmdpbi1ib3R0b206MTBweDt0cmFuc2l0aW9uOmNvbG9yIC40czt9Ci5pbnRyby1jYXJkLXRpdGxle2ZvbnQtc2l6ZTouOTJyZW07Zm9udC13ZWlnaHQ6NTAwO21hcmdpbi1ib3R0b206NnB4O30KLmludHJvLWNhcmQtYm9keXtmb250LXNpemU6LjhyZW07Y29sb3I6dmFyKC0tdGV4dDIpO2ZvbnQtd2VpZ2h0OjMwMDtsaW5lLWhlaWdodDoxLjg7dHJhbnNpdGlvbjpjb2xvciAuNHM7fQoKLyogQkEgKi8KLmJhLXdyYXB7bWFyZ2luLWJvdHRvbTo2MHB4O30KLmJhLWxhYmVsLXJvd3tkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMnB4O21hcmdpbi1ib3R0b206MTRweDt9Ci5iYS1udW17Zm9udC1mYW1pbHk6J0Nvcm1vcmFudCBHYXJhbW9uZCcsc2VyaWY7Zm9udC1zaXplOjEuOHJlbTtmb250LXdlaWdodDozMDA7Y29sb3I6dmFyKC0tZ29sZCk7b3BhY2l0eTouNDtsaW5lLWhlaWdodDoxO3RyYW5zaXRpb246Y29sb3IgLjRzO30KLmJhLXRpdGxle2ZvbnQtc2l6ZTouOTVyZW07Y29sb3I6dmFyKC0tdGV4dDIpO3RyYW5zaXRpb246Y29sb3IgLjRzO30KLmJhLWNvbnRhaW5lcntwb3NpdGlvbjpyZWxhdGl2ZTt3aWR0aDoxMDAlO2FzcGVjdC1yYXRpbzoxNi85O292ZXJmbG93OmhpZGRlbjtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cyk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2N1cnNvcjpldy1yZXNpemU7dXNlci1zZWxlY3Q6bm9uZTt0cmFuc2l0aW9uOmJvcmRlci1jb2xvciAuNHM7fQouYmEtaW1ne3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2xlZnQ6MDt3aWR0aDoxMDAlO2hlaWdodDoxMDAlO29iamVjdC1maXQ6Y292ZXI7cG9pbnRlci1ldmVudHM6bm9uZTt9Ci5iYS1hZnRlcntjbGlwLXBhdGg6aW5zZXQoMCAwIDAgNTAlKTt6LWluZGV4OjI7fQouYmEtaGFuZGxle3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO2JvdHRvbTowO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpO3dpZHRoOjQwcHg7ei1pbmRleDoxMDtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtwb2ludGVyLWV2ZW50czpub25lO30KLmJhLWhhbmRsZS1saW5le3dpZHRoOjJweDtmbGV4OjE7YmFja2dyb3VuZDp2YXIoLS1nb2xkKTtvcGFjaXR5Oi45O3RyYW5zaXRpb246YmFja2dyb3VuZCAuNHM7fQouYmEtaGFuZGxlLXBpbGx7YmFja2dyb3VuZDp2YXIoLS1nb2xkKTtjb2xvcjojZmZmO2ZvbnQtc2l6ZTouNXJlbTtmb250LXdlaWdodDo3MDA7bGV0dGVyLXNwYWNpbmc6MnB4O3BhZGRpbmc6NXB4IDhweDt0cmFuc2l0aW9uOmJhY2tncm91bmQgLjRzO30KLmJhLXRhZ3N7cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOjEycHg7bGVmdDowO3JpZ2h0OjA7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO3BhZGRpbmc6MCAxNHB4O3otaW5kZXg6NTtwb2ludGVyLWV2ZW50czpub25lO30KLmJhLXRhZ3tiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsLjU1KTtjb2xvcjojOTk5O2ZvbnQtc2l6ZTouNnJlbTtsZXR0ZXItc3BhY2luZzoycHg7cGFkZGluZzo0cHggMTBweDtib3JkZXItcmFkaXVzOjJweDtib3JkZXI6MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsLjEpO30KLmJhLXRhZy5hZnRlcntjb2xvcjp2YXIoLS1nb2xkKTtib3JkZXItY29sb3I6cmdiYSgyMDEsMTY4LDc2LC40KTt0cmFuc2l0aW9uOmNvbG9yIC40czt9Ci5iYS1jYXB0aW9ue21hcmdpbi10b3A6MTBweDtmb250LXNpemU6Ljg1cmVtO2NvbG9yOnZhcigtLXRleHQyKTtmb250LXdlaWdodDozMDA7dHJhbnNpdGlvbjpjb2xvciAuNHM7fQovKiBCQSBpbmZvIHBhbmVsICovCi5iYS1pbmZve2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpmbGV4LXN0YXJ0O2dhcDoxNHB4O21hcmdpbi10b3A6MTRweDtwYWRkaW5nOjE0cHggMThweDtiYWNrZ3JvdW5kOnZhcigtLWJnMik7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JvcmRlci1yYWRpdXM6OHB4O3RyYW5zaXRpb246YmFja2dyb3VuZCAuNHMsYm9yZGVyLWNvbG9yIC40czt9Ci5iYS1pbmZvLmhpZGRlbntkaXNwbGF5Om5vbmU7fQouYmEtaW5mby10ZXh0e2ZsZXg6MTttaW4td2lkdGg6MDt9Ci5iYS1pbmZvLW5hbWV7Zm9udC1zaXplOi45cmVtO2ZvbnQtd2VpZ2h0OjUwMDtjb2xvcjp2YXIoLS10ZXh0KTttYXJnaW4tYm90dG9tOjZweDt0cmFuc2l0aW9uOmNvbG9yIC40czt9Ci5iYS1pbmZvLXRhZ3N7ZGlzcGxheTpmbGV4O2ZsZXgtd3JhcDp3cmFwO2dhcDo2cHg7fQouYmEtaW5mby1jaGlwe2ZvbnQtc2l6ZTouN3JlbTtjb2xvcjp2YXIoLS10ZXh0Mik7YmFja2dyb3VuZDp2YXIoLS1iZzMpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtwYWRkaW5nOjNweCAxMHB4O2JvcmRlci1yYWRpdXM6MTAwcHg7dHJhbnNpdGlvbjphbGwgLjRzO30KLmJhLXNhbXBsZS10aHVtYnt3aWR0aDo1MnB4O2hlaWdodDo1MnB4O2JvcmRlci1yYWRpdXM6NnB4O29iamVjdC1maXQ6Y292ZXI7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2N1cnNvcjpwb2ludGVyO2ZsZXgtc2hyaW5rOjA7dHJhbnNpdGlvbjpvcGFjaXR5IC4ycyx0cmFuc2Zvcm0gLjJzO30KLmJhLXNhbXBsZS10aHVtYjpob3ZlcntvcGFjaXR5Oi44NTt0cmFuc2Zvcm06c2NhbGUoMS4wNSk7fQovKiDov73liqDjgqLjg7PjgrDjg6vlhpnnnJ8gKi8KLmJhLWFuZ2xlc3tkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmciAxZnI7Z2FwOjEwcHg7bWFyZ2luLXRvcDoxNHB4O30KLmJhLWFuZ2xlLWl0ZW17cG9zaXRpb246cmVsYXRpdmU7Y3Vyc29yOnBvaW50ZXI7fQouYmEtYW5nbGUtaW1ne3dpZHRoOjEwMCU7YXNwZWN0LXJhdGlvOjQvMztvYmplY3QtZml0OmNvdmVyO2JvcmRlci1yYWRpdXM6OHB4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtkaXNwbGF5OmJsb2NrO3RyYW5zaXRpb246b3BhY2l0eSAuMnMsdHJhbnNmb3JtIC4yczt9Ci5iYS1hbmdsZS1pbWc6aG92ZXJ7b3BhY2l0eTouODU7dHJhbnNmb3JtOnNjYWxlKDEuMDQpO30KLmJhLWFuZ2xlLWxhYmVse3Bvc2l0aW9uOmFic29sdXRlO2JvdHRvbTowO2xlZnQ6MDtyaWdodDowO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuNik7Y29sb3I6I2RkZDtmb250LXNpemU6LjY1cmVtO2xldHRlci1zcGFjaW5nOjFweDt0ZXh0LWFsaWduOmNlbnRlcjtwYWRkaW5nOjVweCA2cHg7Ym9yZGVyLXJhZGl1czowIDAgOHB4IDhweDt9Ci8qIExpZ2h0Ym94ICovCi5saWdodGJveHtwb3NpdGlvbjpmaXhlZDtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuODgpO3otaW5kZXg6OTAwMDtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7b3BhY2l0eTowO3BvaW50ZXItZXZlbnRzOm5vbmU7dHJhbnNpdGlvbjpvcGFjaXR5IC4yNXM7fQoubGlnaHRib3gub3BlbntvcGFjaXR5OjE7cG9pbnRlci1ldmVudHM6YWxsO30KLmxpZ2h0Ym94IGltZ3ttYXgtd2lkdGg6OTB2dzttYXgtaGVpZ2h0Ojg4dmg7Ym9yZGVyLXJhZGl1czo4cHg7Ym94LXNoYWRvdzowIDIwcHggNjBweCByZ2JhKDAsMCwwLC42KTt9Ci5saWdodGJveC1jbG9zZXtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MjBweDtyaWdodDoyNHB4O2NvbG9yOiNmZmY7Zm9udC1zaXplOjJyZW07Y3Vyc29yOnBvaW50ZXI7b3BhY2l0eTouNztsaW5lLWhlaWdodDoxO30KCi8qIFZJREVPICovCi52aWRlby1zZWN0aW9ue2JhY2tncm91bmQ6dmFyKC0tYmcyKTtib3JkZXItdG9wOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7dHJhbnNpdGlvbjpiYWNrZ3JvdW5kIC40cyxib3JkZXItY29sb3IgLjRzO30KLnZpZGVvLXdyYXB7cG9zaXRpb246cmVsYXRpdmU7d2lkdGg6MTAwJTthc3BlY3QtcmF0aW86MTYvOTtiYWNrZ3JvdW5kOnZhcigtLWJnMyk7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtvdmVyZmxvdzpoaWRkZW47bWFyZ2luLXRvcDozMnB4O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt0cmFuc2l0aW9uOmJhY2tncm91bmQgLjRzLGJvcmRlci1jb2xvciAuNHM7fQoudmlkZW8td3JhcCB2aWRlb3t3aWR0aDoxMDAlO2hlaWdodDoxMDAlO29iamVjdC1maXQ6Y292ZXI7fQoudmlkZW8tcGxhY2Vob2xkZXJ7cG9zaXRpb246YWJzb2x1dGU7aW5zZXQ6MDtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2dhcDoxMnB4O2NvbG9yOnZhcigtLXRleHQyKTt9Ci52aWRlby1pY29ue3dpZHRoOjUycHg7aGVpZ2h0OjUycHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JvcmRlci1yYWRpdXM6NTAlO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt0cmFuc2l0aW9uOmJvcmRlci1jb2xvciAuNHM7fQoudmlkZW8tcGxhY2Vob2xkZXIgc3Bhbntmb250LXNpemU6LjcycmVtO2xldHRlci1zcGFjaW5nOjJweDt9CgovKiBNRVNTQUdFICovCi5tZXNzYWdlLWJveHtiYWNrZ3JvdW5kOnZhcigtLW1zZy1iZyk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtwYWRkaW5nOjQ4cHggNDBweDt0ZXh0LWFsaWduOmNlbnRlcjt0cmFuc2l0aW9uOmJhY2tncm91bmQgLjRzLGJvcmRlci1jb2xvciAuNHM7fQoubWVzc2FnZS1tYWlue2ZvbnQtZmFtaWx5OidOb3RvIFNlcmlmIEpQJyxzZXJpZjtmb250LXNpemU6Y2xhbXAoLjk1cmVtLDR2dywxLjRyZW0pO2ZvbnQtd2VpZ2h0OjQwMDtsaW5lLWhlaWdodDoxLjg7bWFyZ2luLWJvdHRvbToyMHB4O30KLm1lc3NhZ2UtbWFpbiBzcGFue2NvbG9yOnZhcigtLWdvbGQpO3RyYW5zaXRpb246Y29sb3IgLjRzO30KLm1lc3NhZ2UtYm9keXtmb250LXNpemU6Ljg4cmVtO2NvbG9yOnZhcigtLXRleHQyKTtmb250LXdlaWdodDozMDA7bGluZS1oZWlnaHQ6Mi4wO3RyYW5zaXRpb246Y29sb3IgLjRzO30KCi8qIENUQSAqLwouY3RhLXNlY3Rpb257cGFkZGluZzo4MHB4IDI0cHggMTAwcHg7dGV4dC1hbGlnbjpjZW50ZXI7cG9zaXRpb246cmVsYXRpdmU7b3ZlcmZsb3c6aGlkZGVuO30KLmN0YS1zZWN0aW9uPio6bm90KC53bSl7cG9zaXRpb246cmVsYXRpdmU7ei1pbmRleDoxO30KLmN0YS1pbm5lcnttYXgtd2lkdGg6NTYwcHg7bWFyZ2luOjAgYXV0bzt9Ci5jdGEtdGl0bGV7Zm9udC1mYW1pbHk6J05vdG8gU2VyaWYgSlAnLHNlcmlmO2ZvbnQtc2l6ZTpjbGFtcCgxLjJyZW0sM3Z3LDEuN3JlbSk7Zm9udC13ZWlnaHQ6NDAwO2xpbmUtaGVpZ2h0OjEuODttYXJnaW4tYm90dG9tOjEwcHg7fQouY3RhLXN1Yntmb250LXNpemU6Ljg4cmVtO2NvbG9yOnZhcigtLXRleHQyKTttYXJnaW4tYm90dG9tOjM2cHg7Zm9udC13ZWlnaHQ6MzAwO3RyYW5zaXRpb246Y29sb3IgLjRzO30KLmN0YS1idG57ZGlzcGxheTppbmxpbmUtZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtnYXA6MTJweDtiYWNrZ3JvdW5kOiMwNkM3NTU7Y29sb3I6I2ZmZjt0ZXh0LWRlY29yYXRpb246bm9uZTtwYWRkaW5nOjIwcHggNDhweDtmb250LXNpemU6MXJlbTtmb250LXdlaWdodDo1MDA7bGV0dGVyLXNwYWNpbmc6MnB4O2JvcmRlci1yYWRpdXM6MTAwcHg7dHJhbnNpdGlvbjpvcGFjaXR5IC4ycyx0cmFuc2Zvcm0gLjJzO21pbi13aWR0aDoyNzBweDtib3gtc2hhZG93OjAgNnB4IDI4cHggcmdiYSg2LDE5OSw4NSwuMik7fQouY3RhLWJ0bjpob3ZlcntvcGFjaXR5Oi44ODt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMnB4KTt9Ci5jdGEtbm90ZXttYXJnaW4tdG9wOjE2cHg7Zm9udC1zaXplOi43NXJlbTtjb2xvcjp2YXIoLS10ZXh0Mik7dHJhbnNpdGlvbjpjb2xvciAuNHM7fQovKiBHYWxsZXJ5IHRlYXNlciAqLwouZ2FsbGVyeS10ZWFzZXItc2VjdGlvbntib3JkZXItdG9wOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7YmFja2dyb3VuZDp2YXIoLS1iZzIpO3RyYW5zaXRpb246YmFja2dyb3VuZCAuNHMsYm9yZGVyLWNvbG9yIC40czt9Ci5nYWxsZXJ5LXRlYXNlci1idG57ZGlzcGxheTppbmxpbmUtZmxleDthbGlnbi1pdGVtczpjZW50ZXI7Z2FwOjEwcHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JvcmRlci1yYWRpdXM6MTAwcHg7cGFkZGluZzoxM3B4IDI4cHg7Zm9udC1zaXplOi44NXJlbTtjb2xvcjp2YXIoLS10ZXh0Mik7dGV4dC1kZWNvcmF0aW9uOm5vbmU7dHJhbnNpdGlvbjphbGwgLjNzO2N1cnNvcjpub3QtYWxsb3dlZDtvcGFjaXR5Oi43O30KLmdhbGxlcnktdGVhc2VyLWJ0bjpob3Zlcntib3JkZXItY29sb3I6dmFyKC0tZ29sZCk7Y29sb3I6dmFyKC0tdGV4dCk7fQouZ2FsbGVyeS10ZWFzZXItYmFkZ2V7YmFja2dyb3VuZDpyZ2JhKDIwMSwxNjgsNzYsLjE1KTtjb2xvcjp2YXIoLS1nb2xkKTtmb250LXNpemU6LjYycmVtO2xldHRlci1zcGFjaW5nOjJweDtwYWRkaW5nOjNweCA4cHg7Ym9yZGVyLXJhZGl1czo0cHg7Ym9yZGVyOjFweCBzb2xpZCByZ2JhKDIwMSwxNjgsNzYsLjMpO30KCi8qIEZPT1RFUiAqLwpmb290ZXJ7cGFkZGluZzo0OHB4IDI0cHg7dGV4dC1hbGlnbjpjZW50ZXI7Ym9yZGVyLXRvcDoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtwb3NpdGlvbjpyZWxhdGl2ZTtvdmVyZmxvdzpoaWRkZW47dHJhbnNpdGlvbjpib3JkZXItY29sb3IgLjRzO30KZm9vdGVyPio6bm90KC53bSl7cG9zaXRpb246cmVsYXRpdmU7ei1pbmRleDoxO30KLmZvb3Rlci1sb2dvLWRhcmssLmZvb3Rlci1sb2dvLWxpZ2h0e21hcmdpbjowIGF1dG8gMjBweDtkaXNwbGF5OmJsb2NrO3RyYW5zaXRpb246b3BhY2l0eSAuNHM7bWF4LXdpZHRoOm1pbig1OCUsNTYwcHgpO3dpZHRoOjEwMCU7fQouZm9vdGVyLWxvZ28tZGFya3tvcGFjaXR5Oi45NTt9Ci5mb290ZXItbG9nby1saWdodHtvcGFjaXR5Oi44NTt9CltkYXRhLXRoZW1lPSJkYXJrIl0gIC5mb290ZXItbG9nby1kYXJrICB7ZGlzcGxheTpibG9jazt9CltkYXRhLXRoZW1lPSJkYXJrIl0gIC5mb290ZXItbG9nby1saWdodCB7ZGlzcGxheTpub25lO30KW2RhdGEtdGhlbWU9ImxpZ2h0Il0gLmZvb3Rlci1sb2dvLWRhcmsgIHtkaXNwbGF5Om5vbmU7fQpbZGF0YS10aGVtZT0ibGlnaHQiXSAuZm9vdGVyLWxvZ28tbGlnaHQge2Rpc3BsYXk6YmxvY2s7fQpbZGF0YS10aGVtZT0iaW5rIl0gICAuZm9vdGVyLWxvZ28tZGFyayAge2Rpc3BsYXk6bm9uZTt9CltkYXRhLXRoZW1lPSJpbmsiXSAgIC5mb290ZXItbG9nby1saWdodCB7ZGlzcGxheTpibG9jaztvcGFjaXR5Oi43NTt9CltkYXRhLXRoZW1lPSJsaWdodCJdIC5mb290ZXItbG9nb3tvcGFjaXR5Oi4zNTt9CltkYXRhLXRoZW1lPSJpbmsiXSAuZm9vdGVyLWxvZ297b3BhY2l0eTouNTU7fQouZm9vdGVyLXRhZ2xpbmV7Zm9udC1mYW1pbHk6J0Nvcm1vcmFudCBHYXJhbW9uZCcsc2VyaWY7Zm9udC1zaXplOi45NXJlbTtmb250LXdlaWdodDozMDA7bGV0dGVyLXNwYWNpbmc6NHB4O2NvbG9yOnZhcigtLXRleHQyKTttYXJnaW4tYm90dG9tOjEwcHg7dHJhbnNpdGlvbjpjb2xvciAuNHM7fQouZm9vdGVyLWNvcHl7Zm9udC1zaXplOi42cmVtO2xldHRlci1zcGFjaW5nOjJweDtjb2xvcjp2YXIoLS10ZXh0Mik7b3BhY2l0eTouNTt0cmFuc2l0aW9uOmNvbG9yIC40czt9CgoKLyogTlVNQU4gU0VDVElPTiAqLwoubnVtYW4tc2VjdGlvbiB7IGJhY2tncm91bmQ6IHZhcigtLWJnMik7IGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOyBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAuNHMsIGJvcmRlci1jb2xvciAuNHM7IH0KLm51bWFuLWlubmVyIHsgbWF4LXdpZHRoOiA5MDBweDsgbWFyZ2luOiAwIGF1dG87IGRpc3BsYXk6IGdyaWQ7IGdyaWQtdGVtcGxhdGUtY29sdW1uczogMjgwcHggMWZyOyBnYXA6IDYwcHg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IH0KLm51bWFuLXBob3RvcyB7IGRpc3BsYXk6IGZsZXg7IGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47IGdhcDogMTZweDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgfQoubnVtYW4tcGhvdG8tbWFpbiB7IHdpZHRoOiAyMDBweDsgaGVpZ2h0OiAyMDBweDsgYm9yZGVyLXJhZGl1czogNTAlOyBvYmplY3QtZml0OiBjb3ZlcjsgYm9yZGVyOiAzcHggc29saWQgdmFyKC0tZ29sZC1saW5lKTsgdHJhbnNpdGlvbjogYm9yZGVyLWNvbG9yIC40czsgfQoubnVtYW4tcGhvdG8tc3ViIHsgd2lkdGg6IDE0MHB4OyBoZWlnaHQ6IDE0MHB4OyBib3JkZXItcmFkaXVzOiA1MCU7IG9iamVjdC1maXQ6IGNvdmVyOyBvcGFjaXR5OiAuNzU7IGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWJvcmRlcik7IHRyYW5zaXRpb246IGJvcmRlci1jb2xvciAuNHMsIG9wYWNpdHkgLjRzOyB9Ci5udW1hbi1uYW1lIHsgZm9udC1mYW1pbHk6ICdOb3RvIFNlcmlmIEpQJywgc2VyaWY7IGZvbnQtc2l6ZTogY2xhbXAoMS40cmVtLDN2dywxLjlyZW0pOyBmb250LXdlaWdodDogNDAwOyBsZXR0ZXItc3BhY2luZzogMnB4OyBtYXJnaW4tYm90dG9tOiA0cHg7IH0KLm51bWFuLXRpdGxlIHsgZm9udC1zaXplOiAuNzVyZW07IGxldHRlci1zcGFjaW5nOiA0cHg7IGNvbG9yOiB2YXIoLS1nb2xkKTsgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsgbWFyZ2luLWJvdHRvbTogMjRweDsgZm9udC13ZWlnaHQ6IDUwMDsgdHJhbnNpdGlvbjogY29sb3IgLjRzOyB9Ci5udW1hbi10aXRsZTo6YmVmb3JlIHsgY29udGVudDogJ+KAlCAnOyB9Ci5udW1hbi1ib2R5IHsgZm9udC1zaXplOiAuOTVyZW07IGNvbG9yOiB2YXIoLS10ZXh0Mik7IGZvbnQtd2VpZ2h0OiAzMDA7IGxpbmUtaGVpZ2h0OiAyLjY7IG1hcmdpbi1ib3R0b206IDI4cHg7IHRyYW5zaXRpb246IGNvbG9yIC40czsgfQoubnVtYW4tYm9keSBzdHJvbmcgeyBjb2xvcjogdmFyKC0tdGV4dCk7IGZvbnQtd2VpZ2h0OiA1MDA7IH0KLm51bWFuLW1ldGEgeyBkaXNwbGF5OiBmbGV4OyBmbGV4LXdyYXA6IHdyYXA7IGdhcDogMTJweDsgbWFyZ2luLWJvdHRvbTogMjhweDsgfQoubnVtYW4tdGFnIHsgZGlzcGxheTogaW5saW5lLWZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogNnB4OyBmb250LXNpemU6IC43MnJlbTsgbGV0dGVyLXNwYWNpbmc6IDJweDsgY29sb3I6IHZhcigtLXRleHQyKTsgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tYm9yZGVyKTsgcGFkZGluZzogNXB4IDE0cHg7IGJvcmRlci1yYWRpdXM6IDEwMHB4OyB0cmFuc2l0aW9uOiBjb2xvciAuNHMsIGJvcmRlci1jb2xvciAuNHM7IH0KLm51bWFuLWlnIHsgZGlzcGxheTogaW5saW5lLWZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGdhcDogOHB4OyBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCM4MzNhYjQsI2ZkMWQxZCwjZmNiMDQ1KTsgY29sb3I6ICNmZmY7IHRleHQtZGVjb3JhdGlvbjogbm9uZTsgZm9udC1zaXplOiAuOHJlbTsgZm9udC13ZWlnaHQ6IDUwMDsgbGV0dGVyLXNwYWNpbmc6IDJweDsgcGFkZGluZzogMTJweCAyOHB4OyBib3JkZXItcmFkaXVzOiAxMDBweDsgdHJhbnNpdGlvbjogb3BhY2l0eSAuMnMsIHRyYW5zZm9ybSAuMnM7IH0KLm51bWFuLWlnOmhvdmVyIHsgb3BhY2l0eTogLjg4OyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTJweCk7IH0KQG1lZGlhKG1heC13aWR0aDo3MDBweCkgewogICAgLm51bWFuLWlubmVyIHsgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnI7IGdhcDogMzJweDsgfQogICAgLm51bWFuLXBob3RvcyB7IGZsZXgtZGlyZWN0aW9uOiByb3c7IGp1c3RpZnktY29udGVudDogY2VudGVyOyB9CiAgICAubnVtYW4tcGhvdG8tbWFpbiB7IHdpZHRoOiAxNTBweDsgaGVpZ2h0OiAxNTBweDsgfQogICAgLm51bWFuLXBob3RvLXN1YiB7IHdpZHRoOiAxMDBweDsgaGVpZ2h0OiAxMDBweDsgfQp9CgoKLyogV0hZIEtJTUFSVSBTVE9SWSBTRUNUSU9OICovCi53aHktc2VjdGlvbiB7IGJhY2tncm91bmQ6IHZhcigtLWJnKTsgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAuNHM7IH0KLndoeS1pbm5lciB7IG1heC13aWR0aDogNzYwcHg7IG1hcmdpbjogMCBhdXRvOyB9Ci53aHktbGVhZCB7IGZvbnQtZmFtaWx5OiAnTm90byBTZXJpZiBKUCcsIHNlcmlmOyBmb250LXNpemU6IGNsYW1wKDEuMDVyZW0sMy41dncsMS41cmVtKTsgZm9udC13ZWlnaHQ6IDQwMDsgbGluZS1oZWlnaHQ6IDEuOTsgbGV0dGVyLXNwYWNpbmc6IC41cHg7IGNvbG9yOiB2YXIoLS10ZXh0KTsgbWFyZ2luLWJvdHRvbTogMzJweDsgYm9yZGVyLWxlZnQ6IDJweCBzb2xpZCB2YXIoLS1nb2xkLWxpbmUpOyBwYWRkaW5nLWxlZnQ6IDIwcHg7IHRyYW5zaXRpb246IGNvbG9yIC40cywgYm9yZGVyLWNvbG9yIC40czsgfQoud2h5LWxlYWQgZW0geyBjb2xvcjogdmFyKC0tZ29sZCk7IGZvbnQtc3R5bGU6IG5vcm1hbDsgdHJhbnNpdGlvbjogY29sb3IgLjRzOyB9Ci53aHktYm9keSB7IGZvbnQtc2l6ZTogLjkycmVtOyBjb2xvcjogdmFyKC0tdGV4dDIpOyBsaW5lLWhlaWdodDogMi4yOyBmb250LXdlaWdodDogMzAwOyBtYXJnaW4tYm90dG9tOiAyNHB4OyB0cmFuc2l0aW9uOiBjb2xvciAuNHM7IH0KLndoeS1ib2R5IHN0cm9uZyB7IGNvbG9yOiB2YXIoLS10ZXh0KTsgZm9udC13ZWlnaHQ6IDUwMDsgfQoud2h5LWRpdmlkZXIgeyB3aWR0aDogNDBweDsgaGVpZ2h0OiAxcHg7IGJhY2tncm91bmQ6IHZhcigtLWdvbGQtbGluZSk7IG1hcmdpbjogNDBweCAwOyB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIC40czsgfQoud2h5LXF1b3RlIHsgcG9zaXRpb246IHJlbGF0aXZlOyBiYWNrZ3JvdW5kOiB2YXIoLS1iZzIpOyBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOyBib3JkZXItcmFkaXVzOiAxMnB4OyBwYWRkaW5nOiAzMnB4IDM2cHg7IG1hcmdpbjogNDBweCAwOyB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIC40cywgYm9yZGVyLWNvbG9yIC40czsgfQoud2h5LXF1b3RlOjpiZWZvcmUgeyBjb250ZW50OiAnIic7IHBvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAtMThweDsgbGVmdDogMjhweDsgZm9udC1mYW1pbHk6ICdDb3Jtb3JhbnQgR2FyYW1vbmQnLCBzZXJpZjsgZm9udC1zaXplOiA1cmVtOyBsaW5lLWhlaWdodDogMTsgY29sb3I6IHZhcigtLWdvbGQpOyBvcGFjaXR5OiAuNDsgdHJhbnNpdGlvbjogY29sb3IgLjRzOyB9Ci53aHktcXVvdGUgcCB7IGZvbnQtZmFtaWx5OiAnTm90byBTZXJpZiBKUCcsIHNlcmlmOyBmb250LXNpemU6IC45NXJlbTsgbGluZS1oZWlnaHQ6IDIuNDsgY29sb3I6IHZhcigtLXRleHQyKTsgZm9udC1zdHlsZTogaXRhbGljOyB0cmFuc2l0aW9uOiBjb2xvciAuNHM7IH0KLndoeS1xdW90ZSBjaXRlIHsgZGlzcGxheTogYmxvY2s7IG1hcmdpbi10b3A6IDE2cHg7IGZvbnQtc2l6ZTogLjcycmVtOyBsZXR0ZXItc3BhY2luZzogM3B4OyBjb2xvcjogdmFyKC0tZ29sZCk7IGZvbnQtc3R5bGU6IG5vcm1hbDsgdHJhbnNpdGlvbjogY29sb3IgLjRzOyB9Ci53aHktY29uY2x1c2lvbiB7IGZvbnQtZmFtaWx5OiAnTm90byBTZXJpZiBKUCcsIHNlcmlmOyBmb250LXNpemU6IGNsYW1wKDFyZW0sMnZ3LDEuMjVyZW0pOyBsaW5lLWhlaWdodDogMi40OyBjb2xvcjogdmFyKC0tdGV4dCk7IGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1ib3JkZXIpOyBwYWRkaW5nLXRvcDogMzZweDsgbWFyZ2luLXRvcDogMzZweDsgdHJhbnNpdGlvbjogY29sb3IgLjRzLCBib3JkZXItY29sb3IgLjRzOyB9Ci53aHktY29uY2x1c2lvbiBzdHJvbmcgeyBjb2xvcjogdmFyKC0tZ29sZCk7IGZvbnQtd2VpZ2h0OiA2MDA7IHRyYW5zaXRpb246IGNvbG9yIC40czsgfQoKLyogUkVWRUFMICovCi5yZXZlYWx7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDIwcHgpO3RyYW5zaXRpb246b3BhY2l0eSAuN3MgY3ViaWMtYmV6aWVyKC4yMiwxLC4zNiwxKSx0cmFuc2Zvcm0gLjdzIGN1YmljLWJlemllciguMjIsMSwuMzYsMSk7fQoucmV2ZWFsLnZpc2libGV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApO30KCkBtZWRpYShtYXgtd2lkdGg6NjQwcHgpewogICAgLmludHJvLWNhcmRze2dyaWQtdGVtcGxhdGUtY29sdW1uczoxZnI7fQogICAgLm1lc3NhZ2UtYm94e3BhZGRpbmc6MjhweCAxOHB4O30KICAgIC5jdGEtYnRue21pbi13aWR0aDp1bnNldDt3aWR0aDoxMDAlO21heC13aWR0aDozMDBweDt9CiAgICAuaGVyby1jYXRjaC13cmFwe21pbi1oZWlnaHQ6MTIwcHg7fQp9Cjwvc3R5bGU+CjwvaGVhZD4KPGJvZHkgZGF0YS10aGVtZT0iJSVLSU1BUlVfVEhFTUUlJSI+CgoKPCEtLSBIRVJP77yI6YCP44GL44GX44GC44KK77yJIC0tPgo8c2VjdGlvbiBjbGFzcz0iaGVybyI+CiAgICA8ZGl2IGNsYXNzPSJ3bSI+PGltZyBzcmM9ImltYWdlcy9sb2dvLnBuZyIgYWx0PSIiPjwvZGl2PgogICAgPGRpdiBjbGFzcz0iaGVyby1iYWRnZSI+S0lNQVJVIOKAlCBOZXcgV2F5IHRvIFByb3Bvc2U8L2Rpdj4KICAgIDxkaXYgY2xhc3M9Imhlcm8tY2F0Y2gtd3JhcCI+CiAgICAgICAgPGRpdiBjbGFzcz0iY2F0Y2gtaXRlbSBhY3RpdmUiPuOBguOBquOBn+OBruaKgOihk+OBr+OAgeOCguOBo+OBqDxzcGFuPuS8neOCj+OCizwvc3Bhbj7jgII8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJjYXRjaC1pdGVtIj7ogbfkurrjga7ku5XkuovjgYzjgIHnlLvpnaLjga7kuK3jgac8c3Bhbj7li5XjgY3lh7rjgZk8L3NwYW4+44CCPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0iY2F0Y2gtaXRlbSI+5o+Q5qGI44GM5aSJ44KP44KM44Gw44CBPHNwYW4+5aWR57SEPC9zcGFuPuOBjOWkieOCj+OCi+OAgjwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9ImNhdGNoLWl0ZW0iPuOCueODnuODm+S4gOOBpOOBp+OAgTxzcGFuPuODl+ODrTwvc3Bhbj7jga7mj5DmoYjmm7jjgII8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJjYXRjaC1pdGVtIj7opovjgZvmlrnjgpLlpInjgYjjgovjgaDjgZHjgafjgIE8c3Bhbj7ntZDmnpw8L3NwYW4+44GM5aSJ44KP44KL44CCPC9kaXY+CiAgICA8L2Rpdj4KICAgIDxkaXYgY2xhc3M9Imhlcm8tZG90cyI+CiAgICAgICAgPGRpdiBjbGFzcz0iaGVyby1kb3QgYWN0aXZlIiBkYXRhLWRvdD0iMCI+PC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0iaGVyby1kb3QiIGRhdGEtZG90PSIxIj48L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJoZXJvLWRvdCIgZGF0YS1kb3Q9IjIiPjwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9Imhlcm8tZG90IiBkYXRhLWRvdD0iMyI+PC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0iaGVyby1kb3QiIGRhdGEtZG90PSI0Ij48L2Rpdj4KICAgIDwvZGl2PgogICAgPHAgY2xhc3M9Imhlcm8tc3ViIj7mlr3lt6Xjga7nj77loLTjgYzjgIHjgZ3jga7jgb7jgb7mnIDpq5jjga7mj5DmoYjmm7jjgavjgarjgovjgII8YnI+S0lNQVJV44GM44CB44GC44Gq44Gf44Gu5Za25qWt44KS5aSJ44GI44G+44GZ44CCPC9wPgogICAgPGRpdiBjbGFzcz0iaGVyby1zY3JvbGwiPjxzcGFuPlNjcm9sbDwvc3Bhbj48ZGl2IGNsYXNzPSJzY3JvbGwtYmFyIj48L2Rpdj48L2Rpdj4KPC9zZWN0aW9uPgoKPCEtLSBJTlRST++8iOmAj+OBi+OBl+OBquOBl++8iSAtLT4KPHNlY3Rpb24gY2xhc3M9InNlY3Rpb24gaW50cm8iPgogICAgPGRpdiBjbGFzcz0ic2VjdGlvbi1pbm5lciI+CiAgICAgICAgPGRpdiBjbGFzcz0icmV2ZWFsIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic2VjdGlvbi10YWciPldoYXQgaXMgS0lNQVJVPC9kaXY+CiAgICAgICAgICAgIDxoMiBjbGFzcz0ic2VjdGlvbi10aXRsZSI+44GT44KT44Gq44GT44Go44GM44CB44Gn44GN44KL44KI44GG44Gr44Gq44KK44G+44GX44Gf44CCPC9oMj4KICAgICAgICAgICAgPHAgY2xhc3M9InNlY3Rpb24tYm9keSI+44GK5a6i5qeY44Gu54++5aC05YaZ55yf44Gr5LuV5LiK44GM44KK44Kk44Oh44O844K444KS6YeN44Gt44Gf44OT44OV44Kp44O844Ki44OV44K/44O85o+Q5qGI5pu444KS44CBVVJM44Gy44Go44Gk44Gn5bGK44GR44KL44CC44K544Oe44Ob44Gn6Kem44KM44KL44CB44Kk44Oz44K/44Op44Kv44OG44Kj44OW44Gq5o+Q5qGI44Gu5b2i44Gn44GZ44CCPC9wPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9ImludHJvLWNhcmRzIHJldmVhbCI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImludHJvLWNhcmQiPjxkaXYgY2xhc3M9ImludHJvLWNhcmQtbnVtIj4wMTwvZGl2PjxkaXYgY2xhc3M9ImludHJvLWNhcmQtdGl0bGUiPuWGmeecn+OCkuW9k+OBpui+vOOCgDwvZGl2PjxkaXYgY2xhc3M9ImludHJvLWNhcmQtYm9keSI+5pa95bel5YmN44Gu54++5aC05YaZ55yf44Gr5LuV5LiK44GM44KK44Kk44Oh44O844K444KS6YeN44Gt44KLPC9kaXY+PC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImludHJvLWNhcmQiPjxkaXYgY2xhc3M9ImludHJvLWNhcmQtbnVtIj4wMjwvZGl2PjxkaXYgY2xhc3M9ImludHJvLWNhcmQtdGl0bGUiPlVSTOOBp+WxiuOBkeOCizwvZGl2PjxkaXYgY2xhc3M9ImludHJvLWNhcmQtYm9keSI+TElOReOBp+mAgeOCi+OBoOOBkeOAgueJueWIpeOBquOCouODl+ODquOBr+S4jeimgTwvZGl2PjwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJpbnRyby1jYXJkIj48ZGl2IGNsYXNzPSJpbnRyby1jYXJkLW51bSI+MDM8L2Rpdj48ZGl2IGNsYXNzPSJpbnRyby1jYXJkLXRpdGxlIj7nv4zmnJ3jgIHpgKPntaHjgYzmnaXjgos8L2Rpdj48ZGl2IGNsYXNzPSJpbnRyby1jYXJkLWJvZHkiPuOBiuWuouanmOOBjOWutuOBp+imi+OBpuOAgeiHquWIhuOBp+axuuOCgeOCizwvZGl2PjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgPC9kaXY+Cjwvc2VjdGlvbj4KCjwhLS0gQkEgREFUQSAoSlNPTikg4oCUIOeuoeeQhueUu+mdouOBi+OCieiHquWLleeUn+aIkCAtLT4KPHNjcmlwdCB0eXBlPSJhcHBsaWNhdGlvbi9qc29uIiBpZD0iYmEtZGF0YSI+W108L3NjcmlwdD4KPCEtLSBCQe+8iOmAj+OBi+OBl+OBquOBl++8iSAtLT4KPHNlY3Rpb24gY2xhc3M9InNlY3Rpb24iIGlkPSJiYS1zZWN0aW9uIj4KICAgIDxkaXYgY2xhc3M9InNlY3Rpb24taW5uZXIiPgogICAgICAgIDxkaXYgY2xhc3M9InJldmVhbCI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InNlY3Rpb24tdGFnIj5CZWZvcmUgLyBBZnRlcjwvZGl2PgogICAgICAgICAgICA8aDIgY2xhc3M9InNlY3Rpb24tdGl0bGUiPuWun+mam+OBq+inpuOBo+OBpuOBv+OBpuOBj+OBoOOBleOBhOOAgjwvaDI+CiAgICAgICAgICAgIDxwIGNsYXNzPSJzZWN0aW9uLWJvZHkiPuOCueODqeOCpOODgOODvOOCkuWLleOBi+OBmeOBqOOAgeaWveW3peWJjeOBqOaWveW3peW+jOOBjOWIh+OCiuabv+OCj+OCiuOBvuOBmeOAgjwvcD4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGlkPSJiYS1saXN0IiBzdHlsZT0ibWFyZ2luLXRvcDozNnB4OyI+PC9kaXY+CiAgICA8L2Rpdj4KPC9zZWN0aW9uPgo8IS0tIExpZ2h0Ym94IC0tPgo8ZGl2IGNsYXNzPSJsaWdodGJveCIgaWQ9ImxpZ2h0Ym94IiBvbmNsaWNrPSJjbG9zZUxpZ2h0Ym94KCkiPgogIDxzcGFuIGNsYXNzPSJsaWdodGJveC1jbG9zZSI+w5c8L3NwYW4+CiAgPGltZyBpZD0ibGlnaHRib3gtaW1nIiBzcmM9IiIgYWx0PSIiPgo8L2Rpdj4KCjwhLS0gR0FMTEVSWSBURUFTRVIgLS0+CjxzZWN0aW9uIGNsYXNzPSJzZWN0aW9uIGdhbGxlcnktdGVhc2VyLXNlY3Rpb24gcmV2ZWFsIiBpZD0iZ2FsbGVyeS10ZWFzZXIiPgogIDxkaXYgY2xhc3M9InNlY3Rpb24taW5uZXIiIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgPGRpdiBjbGFzcz0ic2VjdGlvbi10YWciIHN0eWxlPSJqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyOyI+UG9ydGZvbGlvPC9kaXY+CiAgICA8aDIgY2xhc3M9InNlY3Rpb24tdGl0bGUiIHN0eWxlPSJtYXJnaW4tYm90dG9tOjEycHg7Ij7jgZ3jga7ku5bjga7mlr3lt6Xkuovkvovjga/jgZPjgaHjgok8L2gyPgogICAgPHAgY2xhc3M9InNlY3Rpb24tYm9keSIgc3R5bGU9Im1heC13aWR0aDo0ODBweDttYXJnaW46MCBhdXRvIDI4cHg7Ij7jg5Hjgr/jg7zjg7PliKXjg7vntKDmnZDliKXjga7jg53jg7zjg4jjg5Xjgqnjg6rjgqrjgq7jg6Pjg6njg6rjg7zjgpLmupblgpnjgZfjgabjgYTjgb7jgZnjgII8L3A+CiAgICA8YSBocmVmPSIjIiBjbGFzcz0iZ2FsbGVyeS10ZWFzZXItYnRuIiBvbmNsaWNrPSJyZXR1cm4gZmFsc2U7Ij4KICAgICAgPHNwYW4gY2xhc3M9ImdhbGxlcnktdGVhc2VyLWJhZGdlIj7mupblgpnkuK08L3NwYW4+CiAgICAgIOaWveW3peS6i+S+i+OCruODo+ODqeODquODvOOCkuimi+OCiwogICAgICA8c3ZnIHdpZHRoPSIxNCIgaGVpZ2h0PSIxNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIj48cGF0aCBkPSJNNSAxMmgxNE0xMiA1bDcgNy03IDciLz48L3N2Zz4KICAgIDwvYT4KICAgIDxwIHN0eWxlPSJmb250LXNpemU6LjcycmVtO2NvbG9yOnZhcigtLXRleHQyKTttYXJnaW4tdG9wOjE0cHg7bGV0dGVyLXNwYWNpbmc6MXB4OyI+Q09NSU5HIFNPT048L3A+CiAgPC9kaXY+Cjwvc2VjdGlvbj4KCjwhLS0gVklERU/vvIjpgI/jgYvjgZfjgarjgZfvvIkgLS0+CjxzZWN0aW9uIGNsYXNzPSJzZWN0aW9uIHZpZGVvLXNlY3Rpb24iPgogICAgPGRpdiBjbGFzcz0ic2VjdGlvbi1pbm5lciI+CiAgICAgICAgPGRpdiBjbGFzcz0icmV2ZWFsIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic2VjdGlvbi10YWciPkNpbmVtYXRpYyBWaWV3PC9kaXY+CiAgICAgICAgICAgIDxoMiBjbGFzcz0ic2VjdGlvbi10aXRsZSI+57Sg5p2Q44Gu5LiW55WM44KS44CB5pig5YOP44Gn44CCPC9oMj4KICAgICAgICAgICAgPHAgY2xhc3M9InNlY3Rpb24tYm9keSI+5pa95bel44Gu6LOq5oSf44Go5LuV5LiK44GM44KK44KS44CB5pig5YOP44Gn44GK5bGK44GR44GX44G+44GZ44CCPC9wPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9InZpZGVvLXdyYXAgcmV2ZWFsIj4KICAgICAgICAgICAgPHZpZGVvIGlkPSJwcm9tby12aWRlbyIgc3JjPSIiIHBvc3Rlcj0iIiBhdXRvcGxheSBtdXRlZCBsb29wIHBsYXlzaW5saW5lPjwvdmlkZW8+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InZpZGVvLXBsYWNlaG9sZGVyIiBpZD0idmlkZW8tcGxhY2Vob2xkZXIiPgogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0idmlkZW8taWNvbiI+PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMTgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0iY3VycmVudENvbG9yIiBzdHlsZT0iY29sb3I6dmFyKC0tZ29sZCkiPjxwYXRoIGQ9Ik04IDV2MTRsMTEtN3oiLz48L3N2Zz48L2Rpdj4KICAgICAgICAgICAgICAgIDxzcGFuPnNyYyDjgavli5XnlLsgVVJMIOOCkuWFpeOCjOOBpuOBj+OBoOOBleOBhDwvc3Bhbj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICA8L2Rpdj4KPC9zZWN0aW9uPgoKPCEtLSBNRVNTQUdF77yI6YCP44GL44GX44Gq44GX77yJIC0tPgo8c2VjdGlvbiBjbGFzcz0ic2VjdGlvbiI+CiAgICA8ZGl2IGNsYXNzPSJzZWN0aW9uLWlubmVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJtZXNzYWdlLWJveCByZXZlYWwiPgogICAgICAgICAgICA8cCBjbGFzcz0ibWVzc2FnZS1tYWluIj7jgrXjg7Pjg5fjg6vjgpLmjIHjgaPjgabooYzjgaPjgabjgoLlpZHntITjgYzlj5bjgozjgarjgYTjgIE8YnI+44Gd44KT44Gq5pmC5Luj44GvPHNwYW4+44KC44GG57WC44KP44KKPC9zcGFuPuOBq+OBl+OBvuOBm+OCk+OBi+OAgjwvcD4KICAgICAgICAgICAgPHAgY2xhc3M9Im1lc3NhZ2UtYm9keSI+5oqA6KGT44Gv5pys54mp44Gq44Gu44Gr44CB5Lyd44GI5pa544GM6L+944GE44Gk44GE44Gm44GE44Gq44GE44Gg44GR44CCPGJyPktJTUFSVeOCkuS9v+OBiOOBsOOAgeOBiuWuouanmOOBjOiHquWIhuOBp+OAjOaxuuOCgeOCi+OAjeOCiOOBhuOBq+OBquOCiuOBvuOBmeOAgjwvcD4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2Pgo8L3NlY3Rpb24+CgoKPCEtLSBOVU1BTiBTRUNUSU9OIC0tPgo8c2VjdGlvbiBjbGFzcz0ic2VjdGlvbiBudW1hbi1zZWN0aW9uIj4KICAgIDxkaXYgY2xhc3M9Im51bWFuLWlubmVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJudW1hbi1waG90b3MgcmV2ZWFsIj4KICAgICAgICAgICAgPGltZyBjbGFzcz0ibnVtYW4tcGhvdG8tbWFpbiIgc3JjPSJpbWFnZXMvbnVtYW5fY29sb3IuanBnIiBhbHQ9IuOCu+ODoeODs+ODiOOCouODvOODhuOCo+OCueODiCDjgazjg7zjgb7jgpMiPgogICAgICAgICAgICA8aW1nIGNsYXNzPSJudW1hbi1waG90by1zdWIiICBzcmM9ImltYWdlcy9udW1hbl9wb3J0cmFpdC5qcGciIGFsdD0i44Gs44O844G+44KTIj4KICAgICAgICA8L2Rpdj4KICAgICAgICA8ZGl2IGNsYXNzPSJudW1hbi10ZXh0Ij4KICAgICAgICAgICAgPGRpdiBjbGFzcz0icmV2ZWFsIj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InNlY3Rpb24tdGFnIj5BYm91dDwvZGl2PgogICAgICAgICAgICAgICAgPGgyIGNsYXNzPSJudW1hbi1uYW1lIj7jgrvjg6Hjg7Pjg4jjgqLjg7zjg4bjgqPjgrnjg4g8YnI+44Gs44O844G+44KTPC9oMj4KICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9Im51bWFuLXRpdGxlIj5DZW1lbnQgQXJ0aXN0IE514piGTWFuPC9kaXY+CiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJudW1hbi1tZXRhIHJldmVhbCI+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibnVtYW4tdGFnIj7wn5ONIOS4iemHjeecjCDmnb7pmKrluII8L3NwYW4+CiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0ibnVtYW4tdGFnIj7wn5eTIOODreODvOODqeODvOOCueODiOODvOODs+attCAyMDE55bm044CcPC9zcGFuPgogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPHAgY2xhc3M9Im51bWFuLWJvZHkgcmV2ZWFsIj4KICAgICAgICAgICAgICAgIDxzdHJvbmc+MTbmrbPjgYvjgonlu7roqK3mpa3nlYw8L3N0cm9uZz7jgavpo5vjgbPovrzjgb/jgIHplbflubTjgavjgo/jgZ/jgaPjgabku67oqK3kuovmpa3jg7vkuIvoq4vjgZHjga7kuJbnlYzjgaflg43jgYTjgabjgY3jgZ/jgII8YnI+PGJyPgogICAgICAgICAgICAgICAg44GE44Gk44GX44GL44CB44CMPHN0cm9uZz7jgqvjgr/jg4Hjgavmrovjgovku5XkuovjgYzjgZfjgZ/jgYQ8L3N0cm9uZz7jgI3jgajmgJ3jgYbjgojjgYbjgavjgarjgaPjgZ/jgII8YnI+CiAgICAgICAgICAgICAgICDjgZ3jgpPjgarjgajjgY3lh7rkvJrjgaPjgZ/jga7jgYzjgIHjg63jg7zjg6njg7zjgrnjg4jjg7zjg7PjgII8YnI+PGJyPgogICAgICAgICAgICAgICAg44GK5a6i44GV44KT44Gu5Zac44G25aOw44CB56yR6aGU44Gr55u05o6l44G144KM44KJ44KM44KL5LuV5LqL44CCPGJyPgogICAgICAgICAgICAgICAg44Gd44GX44Gm44CB44GT44Gu5LuV5LqL44Gr55yf5Ymj44Gr5ZCR44GN5ZCI44GGPHN0cm9uZz7nhrHjgYTmgJ3jgYTjgpLmjIHjgaPjgZ/ku7LplpPjgZ/jgaHjgajlrprmnJ/nmoTjgavkvJrjgYjjgovnkrDlooM8L3N0cm9uZz7jgII8YnI+CiAgICAgICAgICAgICAgICDlh7rkvJrjgYbjgZ/jgbPjgavmsJfjgaXjgY3jgYzjgYLjgorjgIHlrabjgbPjgYzjgYLjgovjgII8YnI+PGJyPgogICAgICAgICAgICAgICAg44GT44Gu57Sg5pm044KJ44GX44GE5LuV5LqL44KS44CB44KC44Gj44Go5aSa44GP44Gu5Lq644Gr55+l44Gj44Gm44KC44KJ44GE44Gf44GE44CCPGJyPgogICAgICAgICAgICAgICAg6auY44GE5oqA6KGT44KS5oyB44Gk5Luy6ZaT44Gf44Gh44Gr44CB44KC44Gj44Go6Ieq5L+h44KS5oyB44Gj44Gm6Lyd44GR44KL5qmf5Lya44KS5bGK44GR44Gf44GE44CCPGJyPgogICAgICAgICAgICAgICAg44Gd44GX44Gm44CBPHN0cm9uZz7np4Hoh6rouqvjgpLogrLjgabjgabjgY/jgozjgZ9ST0xMRVIgU1RPTkXjgajjgYTjgYbmpa3nlYzjgas8L3N0cm9uZz7jgIHjgZPjga7jg5fjg63jgrjjgqfjgq/jg4jjgafmganov5TjgZfjgYzjgZfjgZ/jgYTjgII8YnI+PGJyPgogICAgICAgICAgICAgICAg44Gd44KM44GM44CBS0lNQVJV44Gu5Y6f54K544Gn44GZ44CCCiAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgPGEgaHJlZj0iaHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS9jZW1lbnRhcnRfbnVtYW4vIiBjbGFzcz0ibnVtYW4taWcgcmV2ZWFsIiB0YXJnZXQ9Il9ibGFuayIgcmVsPSJub29wZW5lciI+CiAgICAgICAgICAgICAgICA8c3ZnIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJjdXJyZW50Q29sb3IiPjxwYXRoIGQ9Ik0xMiAyLjE2M2MzLjIwNCAwIDMuNTg0LjAxMiA0Ljg1LjA3IDMuMjUyLjE0OCA0Ljc3MSAxLjY5MSA0LjkxOSA0LjkxOS4wNTggMS4yNjUuMDY5IDEuNjQ1LjA2OSA0Ljg0OSAwIDMuMjA1LS4wMTIgMy41ODQtLjA2OSA0Ljg0OS0uMTQ5IDMuMjI1LTEuNjY0IDQuNzcxLTQuOTE5IDQuOTE5LTEuMjY2LjA1OC0xLjY0NC4wNy00Ljg1LjA3LTMuMjA0IDAtMy41ODQtLjAxMi00Ljg0OS0uMDctMy4yNi0uMTQ5LTQuNzcxLTEuNjk5LTQuOTE5LTQuOTItLjA1OC0xLjI2NS0uMDctMS42NDQtLjA3LTQuODQ5IDAtMy4yMDQuMDEzLTMuNTgzLjA3LTQuODQ5LjE0OS0zLjIyNyAxLjY2NC00Ljc3MSA0LjkxOS00LjkxOSAxLjI2Ni0uMDU3IDEuNjQ1LS4wNjkgNC44NDktLjA2OXptMC0yLjE2M2MtMy4yNTkgMC0zLjY2Ny4wMTQtNC45NDcuMDcyLTQuMzU4LjItNi43OCAyLjYxOC02Ljk4IDYuOTgtLjA1OSAxLjI4MS0uMDczIDEuNjg5LS4wNzMgNC45NDggMCAzLjI1OS4wMTQgMy42NjguMDcyIDQuOTQ4LjIgNC4zNTggMi42MTggNi43OCA2Ljk4IDYuOTggMS4yODEuMDU4IDEuNjg5LjA3MiA0Ljk0OC4wNzIgMy4yNTkgMCAzLjY2OC0uMDE0IDQuOTQ4LS4wNzIgNC4zNTQtLjIgNi43ODItMi42MTggNi45NzktNi45OC4wNTktMS4yOC4wNzMtMS42ODkuMDczLTQuOTQ4IDAtMy4yNTktLjAxNC0zLjY2Ny0uMDcyLTQuOTQ3LS4xOTYtNC4zNTQtMi42MTctNi43OC02Ljk3OS02Ljk4LTEuMjgxLS4wNTktMS42OS0uMDczLTQuOTQ5LS4wNzN6bTAgNS44MzhjLTMuNDAzIDAtNi4xNjIgMi43NTktNi4xNjIgNi4xNjJzMi43NTkgNi4xNjMgNi4xNjIgNi4xNjMgNi4xNjItMi43NTkgNi4xNjItNi4xNjNjMC0zLjQwMy0yLjc1OS02LjE2Mi02LjE2Mi02LjE2MnptMCAxMC4xNjJjLTIuMjA5IDAtNC0xLjc5LTQtNCAwLTIuMjA5IDEuNzkxLTQgNC00czQgMS43OTEgNCA0YzAgMi4yMS0xLjc5MSA0LTQgNHptNi40MDYtMTEuODQ1Yy0uNzk2IDAtMS40NDEuNjQ1LTEuNDQxIDEuNDRzLjY0NSAxLjQ0IDEuNDQxIDEuNDRjLjc5NSAwIDEuNDM5LS42NDUgMS40MzktMS40NHMtLjY0NC0xLjQ0LTEuNDM5LTEuNDR6Ii8+PC9zdmc+CiAgICAgICAgICAgICAgICBAY2VtZW50YXJ0X251bWFuCiAgICAgICAgICAgIDwvYT4KICAgICAgICA8L2Rpdj4KICAgIDwvZGl2Pgo8L3NlY3Rpb24+CgoKPCEtLSBXSFkgS0lNQVJVIFNUT1JZIC0tPgo8c2VjdGlvbiBjbGFzcz0ic2VjdGlvbiB3aHktc2VjdGlvbiIgaWQ9IndoeS1raW1hcnUiPgogICAgPGRpdiBjbGFzcz0id2h5LWlubmVyIj4KICAgICAgICA8ZGl2IGNsYXNzPSJzZWN0aW9uLXRhZyByZXZlYWwiPldoeSBLSU1BUlU8L2Rpdj4KCiAgICAgICAgPHAgY2xhc3M9IndoeS1sZWFkIHJldmVhbCI+CiAgICAgICAgICAgIOODreODvOODqeODvOOCueODiOODvOODs+OBr+OAgeijveWTgeOBp+OBr+OBquOBhOOAgjxicj4KICAgICAgICAgICAgPGVtPuOBmeOBueOBpuOBjOODleODquODvOODj+ODs+ODieOBp+OAgeePvuWgtOOBp+OBv+OCk+OBquOBjOS7leS4iuOBkuOBpuOBhOOBj+aKgOihkzwvZW0+44Gg44CCCiAgICAgICAgPC9wPgoKICAgICAgICA8cCBjbGFzcz0id2h5LWJvZHkgcmV2ZWFsIj4KICAgICAgICAgICAg5ZSv5LiA54Sh5LqM44Gu44Kq44Oq44K444OK44Or44OH44K244Kk44Oz44CC44Gd44KM44Gv44Ot44O844Op44O844K544OI44O844Oz44Gu5pyA5aSn44Gu5by344G/44Gn44GC44KK44CB5ZCM5pmC44GrPHN0cm9uZz7lpKfjgY3jgaroqrLpoYw8L3N0cm9uZz7jgafjgoLjgYLjgaPjgZ/jgII8YnI+PGJyPgogICAgICAgICAgICDjgYrlrqLjgZXjgpPjga/lrozmiJDlvaLjgpLopovjgZ/jgYTjgILml6Loo73lk4HjgarjgonjgrXjg7Pjg5fjg6vjgpLopovjgZvjgonjgozjgovjgILjgafjgoLjg63jg7zjg6njg7zjgrnjg4jjg7zjg7Pjga/jgIE8c3Ryb25nPuS7leS4iuOBjOOCiuOCpOODoeODvOOCuOOBr+iBt+S6uuOBrumgreOBruS4reOBq+OBl+OBi+OBquOBhOOAgjwvc3Ryb25nPjxicj48YnI+CiAgICAgICAgICAgIOOBoOOBi+OCieengeOBn+OBoeOBq+OBp+OBjeOCi+OBk+OBqOOBr+OAgemBjuWOu+OBruaWveW3peS6i+S+i+OCkuS4puOBueOBn+ODkeODs+ODleODrOODg+ODiOOCkuimi+OBm+OBpuOAjOaDs+WDj+OBl+OBpuOCguOCieOBhuOAjeOBk+OBqOOBoOOBkeOBoOOBo+OBn+OAggogICAgICAgIDwvcD4KCiAgICAgICAgPGRpdiBjbGFzcz0id2h5LXF1b3RlIHJldmVhbCI+CiAgICAgICAgICAgIDxwPuOAjOengeOBq+S7u+OBm+OBpuOBj+OBoOOBleOBhOOAguOBjeOBo+OBqOS8vOWQiOOBhuOBqOaAneOBhOOBvuOBmeOAgue1tuWvvuOBq+OBi+OBo+OBk+OBhOOBhOOBr+OBmuOBp+OBmeOAguOAjTwvcD4KICAgICAgICAgICAgPGNpdGU+4oCUIOWkmuOBj+OBruiBt+S6uuOBjOOAgeePvuWgtOOBp+e5sOOCiui/lOOBl+OBpuOBjeOBn+iogOiRiTwvY2l0ZT4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPHAgY2xhc3M9IndoeS1ib2R5IHJldmVhbCI+CiAgICAgICAgICAgIOa0i+acjeOBoOOBo+OBpuOAgeippuedgOWupOOBp+iHquWIhuOBq+S8vOWQiOOBhuOBi+eiuuOBi+OCgeOBpuOBi+OCieiyt+OBhuOAgjxicj4KICAgICAgICAgICAg6auY6aGN44Gq44Oq44OV44Kp44O844Og44Gq44KJ44CB44Gq44GK44GV44KJ44Gd44GG44Gn44GC44KL44G544GN44Gg44CCPGJyPjxicj4KICAgICAgICAgICAgPHN0cm9uZz7jgIzkv6HjgZjjgabjgY/jgaDjgZXjgYTjgI3jgajjgYTjgYboqIDokYnjgaDjgZHjgafjgIHoqrDjgYzpq5jpoY3llYblk4HjgpLosrfjgYbjgaDjgo3jgYbjgYvjgII8L3N0cm9uZz48YnI+PGJyPgogICAgICAgICAgICDnp4Hjga/jgZrjgaPjgajjgZ3jgZPjgavnlpHllY/jgajmra/jgYzjgobjgZXjgpLmhJ/jgZjjgabjgYTjgZ/jgII8YnI+CiAgICAgICAgICAgIOeGseOBhOaAneOBhOOCguOAgemrmOOBhOaKgOihk+OCguOAgTxzdHJvbmc+44CM5Lyd44GI44KL5Yqb44CN44GM44Gq44GR44KM44Gw5bGK44GL44Gq44GE44CCPC9zdHJvbmc+CiAgICAgICAgPC9wPgoKICAgICAgICA8ZGl2IGNsYXNzPSJ3aHktZGl2aWRlciByZXZlYWwiPjwvZGl2PgoKICAgICAgICA8cCBjbGFzcz0id2h5LWNvbmNsdXNpb24gcmV2ZWFsIj4KICAgICAgICAgICAgS0lNQVJV44Gv44CB44Gd44Gu44GZ44G544Gm44KS6Kej5rG644GZ44KL44Gf44KB44Gu44OX44Ot44K444Kn44Kv44OI44Gg44CCPGJyPjxicj4KICAgICAgICAgICAg5a6M5oiQ44Kk44Oh44O844K444KS5Lyd44GI44KJ44KM44KL5o+Q5qGI5pu444CC44GK5a6i44GV44KT44GM44CM44GT44KM44Gr44GX44Gf44GE44CN44Go6KiA44GI44KL5L2T6aiT44CCPGJyPgogICAgICAgICAgICDogbfkurrjgYzoh6rkv6HjgpLmjIHjgaPjgabjgIHmraPlvZPjgarlr77kvqHjgpLlvpfjgonjgozjgovku5XntYTjgb/jgII8YnI+PGJyPgogICAgICAgICAgICDjgZPjgozjga/np4HkuIDkurrjga7jgZ/jgoHjgZjjgoPjgarjgYTjgII8YnI+CiAgICAgICAgICAgIDxzdHJvbmc+5ZCM44GY5oCd44GE44KS5oyB44Gk44CB44GZ44G544Gm44Gu44Ot44O844Op44O844K544OI44O844Oz6IG35Lq644G444CCPC9zdHJvbmc+CiAgICAgICAgPC9wPgogICAgPC9kaXY+Cjwvc2VjdGlvbj4KCjwhLS0gQ1RB77yI6YCP44GL44GX44GC44KK77yJIC0tPgo8ZGl2IGNsYXNzPSJjdGEtc2VjdGlvbiI+CiAgICA8ZGl2IGNsYXNzPSJ3bSI+PGltZyBzcmM9ImltYWdlcy9sb2dvLnBuZyIgYWx0PSIiPjwvZGl2PgogICAgPGRpdiBjbGFzcz0iY3RhLWlubmVyIj4KICAgICAgICA8aDIgY2xhc3M9ImN0YS10aXRsZSByZXZlYWwiPuawl+OBq+OBquOBo+OBn+aWueOBr+OAgTxicj7jgb7jgZpMSU5F44Gn6Kmx44GX44G+44GX44KH44GG44CCPC9oMj4KICAgICAgICA8cCBjbGFzcz0iY3RhLXN1YiByZXZlYWwiPuips+OBl+OBhOiqrOaYjuODu+ODh+ODouOCguOBiuawl+i7veOBq+OBqeOBhuOBnjwvcD4KICAgICAgICA8YSBocmVmPSJodHRwczovL2xpbi5lZS94eHh4eHh4IiBjbGFzcz0iY3RhLWJ0biByZXZlYWwiIHRhcmdldD0iX2JsYW5rIiByZWw9Im5vb3BlbmVyIj4KICAgICAgICAgICAgPHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCA0MCAzOCIgZmlsbD0iY3VycmVudENvbG9yIj48cGF0aCBkPSJNMjAgMEM5IDAgMCA3LjIgMCAxNmMwIDUuNSAzLjQgMTAuMyA4LjcgMTMuMy0uNCAxLjQtMS40IDUuMS0xLjYgNS45LS4yIDEgLjQgMSAuOC43LjMtLjIgNC44LTMuMyA2LjctNC42LjkuMSAxLjkuMiAyLjkuMiAxMSAwIDIwLTcuMiAyMC0xNlMzMSAwIDIwIDB6Ii8+PC9zdmc+CiAgICAgICAgICAgIExJTkUg44Gn44GK5ZWP44GE5ZCI44KP44GbCiAgICAgICAgPC9hPgogICAgICAgIDxwIGNsYXNzPSJjdGEtbm90ZSByZXZlYWwiPueEoeaWmeOBp+OBlOebuOirh+OBhOOBn+OBoOOBkeOBvuOBmTwvcD4KICAgIDwvZGl2Pgo8L2Rpdj4KCjwhLS0gRk9PVEVS77yI6YCP44GL44GX77yL44Ot44K044GC44KK77yJIC0tPgo8Zm9vdGVyPgogICAgPGltZyBjbGFzcz0iZm9vdGVyLWxvZ28tZGFyayIgIHNyYz0iaW1hZ2VzL2Zvb3Rlcl9sb2dvX2RhcmsuanBnIiAgYWx0PSJLSU1BUlUiPgogICAgPGltZyBjbGFzcz0iZm9vdGVyLWxvZ28tbGlnaHQiIHNyYz0iaW1hZ2VzL2Zvb3Rlcl9sb2dvX2xpZ2h0LmpwZyIgYWx0PSJLSU1BUlUiPgogICAgPGRpdiBjbGFzcz0iZm9vdGVyLXRhZ2xpbmUiPlByb3Bvc2FsIFN5c3RlbSBmb3IgQ29uc3RydWN0aW9uIFByb2Zlc3Npb25hbHM8L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImZvb3Rlci1jb3B5Ij4mY29weTsgMjAyNSBLSU1BUlUuIEFsbCByaWdodHMgcmVzZXJ2ZWQuPC9kaXY+CjwvZm9vdGVyPgoKPHNjcmlwdD4KLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgS0lNQVJVIExQIOKAlCDjg6HjgqTjg7Pjgrnjgq/jg6rjg5fjg4gKICAgR0E0IOa4rOWumklEOiBHLTBWRjI3N0Y2UlgKICAg44Kk44OZ44Oz44OI6Kit6KiI5pu4IHYyLjAKICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KCi8vIC0tLS0tIOOCreODo+ODg+ODgeOCs+ODlOODvCDjg63jg7zjg4bjg7zjgrfjg6fjg7MgLS0tLS0KdmFyIGNhdGNoZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2F0Y2gtaXRlbScpOwp2YXIgZG90cyAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5oZXJvLWRvdCcpOwp2YXIgY3VycmVudCA9IDAsIHRpbWVyOwpmdW5jdGlvbiBzaG93Q2F0Y2goaWR4KXsKICBjYXRjaGVzW2N1cnJlbnRdLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogIGRvdHNbY3VycmVudF0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7CiAgY3VycmVudCA9IGlkeDsKICBjYXRjaGVzW2N1cnJlbnRdLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogIGRvdHNbY3VycmVudF0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7Cn0KdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpeyBzaG93Q2F0Y2goKGN1cnJlbnQgKyAxKSAlIGNhdGNoZXMubGVuZ3RoKTsgfSwgNDAwMCk7CmRvdHMuZm9yRWFjaChmdW5jdGlvbihkb3QpewogIGRvdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7CiAgICBjbGVhckludGVydmFsKHRpbWVyKTsKICAgIHNob3dDYXRjaChwYXJzZUludChkb3QuZGF0YXNldC5kb3QpKTsKICAgIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXsgc2hvd0NhdGNoKChjdXJyZW50ICsgMSkgJSBjYXRjaGVzLmxlbmd0aCk7IH0sIDQwMDApOwogIH0pOwp9KTsKCi8vIC0tLS0tIEJBIOOCueODqeOCpOODgOODvO+8iEpTT07pp4bli5XvvIkgLS0tLS0KdmFyIFBMQUNFSE9MREVSX0JFRk9SRSA9ICdodHRwczovL3ZpYS5wbGFjZWhvbGRlci5jb20vMTIwMHg2NzUvMTExLzFlMWUxZT90ZXh0PUJFRk9SRSc7CnZhciBQTEFDRUhPTERFUl9BRlRFUiAgPSAnaHR0cHM6Ly92aWEucGxhY2Vob2xkZXIuY29tLzEyMDB4Njc1LzFhMTIwOC8yYTIwMTA/dGV4dD1BRlRFUic7CgpmdW5jdGlvbiBpbml0QmFTbGlkZXJzKCl7CiAgdmFyIGxpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmEtbGlzdCcpOwogIGlmKCFsaXN0KSByZXR1cm47CiAgdmFyIGRhdGEgPSBbXTsKICB0cnl7IGRhdGEgPSBKU09OLnBhcnNlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiYS1kYXRhJykudGV4dENvbnRlbnQgfHwgJ1tdJyk7IH1jYXRjaChlKXt9CiAgaWYoIWRhdGEubGVuZ3RoKXsKICAgIGRhdGEgPSBbCiAgICAgIHt0aXRsZTon5pa95bel5LqL5L6LIOKAlCDjgr/jgqTjg4jjg6vjgpLlhaXjgozjgabjgY/jgaDjgZXjgYQnLCBiZWZvcmU6UExBQ0VIT0xERVJfQkVGT1JFLCBhZnRlcjpQTEFDRUhPTERFUl9BRlRFUiwgZmluaXNoOicnLCBjb2xvcjonJywgZ3JvdXQ6JycsIHNhbXBsZTonJywgYW5nbGVzOltdfSwKICAgICAge3RpdGxlOifmlr3lt6Xkuovkvosg4oCUIOOCv+OCpOODiOODq+OCkuWFpeOCjOOBpuOBj+OBoOOBleOBhCcsIGJlZm9yZTpQTEFDRUhPTERFUl9CRUZPUkUsIGFmdGVyOlBMQUNFSE9MREVSX0FGVEVSLCBmaW5pc2g6JycsIGNvbG9yOicnLCBncm91dDonJywgc2FtcGxlOicnLCBhbmdsZXM6W119CiAgICBdOwogIH0KICBsaXN0LmlubmVySFRNTCA9ICcnOwogIGRhdGEuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpKXsKICAgIHZhciBjaGlwcyA9ICcnOwogICAgaWYoaXRlbS5maW5pc2gpIGNoaXBzICs9ICc8c3BhbiBjbGFzcz0iYmEtaW5mby1jaGlwIj4nICsgaXRlbS5maW5pc2ggKyAnPC9zcGFuPic7CiAgICBpZihpdGVtLmNvbG9yKSAgY2hpcHMgKz0gJzxzcGFuIGNsYXNzPSJiYS1pbmZvLWNoaXAiPuOCq+ODqeODvO+8micgKyBpdGVtLmNvbG9yICsgJzwvc3Bhbj4nOwogICAgaWYoaXRlbS5ncm91dCkgIGNoaXBzICs9ICc8c3BhbiBjbGFzcz0iYmEtaW5mby1jaGlwIj7nm67lnLDvvJonICsgaXRlbS5ncm91dCArICc8L3NwYW4+JzsKICAgIHZhciBhbmdsZXNIdG1sID0gJyc7CiAgICBpZihpdGVtLmFuZ2xlcyAmJiBpdGVtLmFuZ2xlcy5sZW5ndGgpewogICAgICBhbmdsZXNIdG1sID0gJzxkaXYgY2xhc3M9ImJhLWFuZ2xlcyI+JzsKICAgICAgaXRlbS5hbmdsZXMuZm9yRWFjaChmdW5jdGlvbihhbmcpewogICAgICAgIGlmKCFhbmcuc3JjKSByZXR1cm47CiAgICAgICAgYW5nbGVzSHRtbCArPSAnPGRpdiBjbGFzcz0iYmEtYW5nbGUtaXRlbSIgb25jbGljaz0ib3BlbkxpZ2h0Ym94KFwnJyArIGFuZy5zcmMgKyAnXCcpIj4nCiAgICAgICAgICArICc8aW1nIGNsYXNzPSJiYS1hbmdsZS1pbWciIHNyYz0iJyArIGFuZy5zcmMgKyAnIiBhbHQ9IicgKyBlc2NIdG1sTFAoYW5nLmxhYmVsfHwnJykgKyAnIj4nCiAgICAgICAgICArIChhbmcubGFiZWwgPyAnPGRpdiBjbGFzcz0iYmEtYW5nbGUtbGFiZWwiPicgKyBlc2NIdG1sTFAoYW5nLmxhYmVsKSArICc8L2Rpdj4nIDogJycpCiAgICAgICAgICArICc8L2Rpdj4nOwogICAgICB9KTsKICAgICAgYW5nbGVzSHRtbCArPSAnPC9kaXY+JzsKICAgIH0KICAgIHZhciBpbmZvSHRtbCA9ICcnOwogICAgaWYoY2hpcHMgfHwgaXRlbS5zYW1wbGUgfHwgYW5nbGVzSHRtbCl7CiAgICAgIGluZm9IdG1sID0gJzxkaXYgY2xhc3M9ImJhLWluZm8iPicKICAgICAgICArIChpdGVtLnNhbXBsZSA/ICc8aW1nIGNsYXNzPSJiYS1zYW1wbGUtdGh1bWIiIHNyYz0iJyArIGl0ZW0uc2FtcGxlICsgJyIgYWx0PSLntKDmnZDjgrXjg7Pjg5fjg6siIG9uY2xpY2s9Im9wZW5MaWdodGJveChcJycgKyBpdGVtLnNhbXBsZSArICdcJykiPicgOiAnJykKICAgICAgICArICc8ZGl2IGNsYXNzPSJiYS1pbmZvLXRleHQiPicKICAgICAgICArIChpdGVtLmZpbmlzaHx8aXRlbS5jb2xvcnx8aXRlbS5ncm91dCA/ICc8ZGl2IGNsYXNzPSJiYS1pbmZvLW5hbWUiPicgKyAoaXRlbS5maW5pc2h8fCcnKSArICc8L2Rpdj4nIDogJycpCiAgICAgICAgKyAoY2hpcHMgPyAnPGRpdiBjbGFzcz0iYmEtaW5mby10YWdzIj4nICsgY2hpcHMgKyAnPC9kaXY+JyA6ICcnKQogICAgICAgICsgYW5nbGVzSHRtbAogICAgICAgICsgJzwvZGl2PjwvZGl2Pic7CiAgICB9CiAgICB2YXIgbnVtU3RyID0gKGkgKyAxIDwgMTAgPyAnMCcgKyAoaSArIDEpIDogJycgKyAoaSArIDEpKTsKICAgIHZhciB3cmFwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICB3cmFwLmNsYXNzTmFtZSA9ICdiYS13cmFwJzsKICAgIGlmKGkgPT09IDApIHdyYXAuc3R5bGUubWFyZ2luVG9wID0gJzAnOwogICAgd3JhcC5pbm5lckhUTUwgPQogICAgICAgICc8ZGl2IGNsYXNzPSJiYS1sYWJlbC1yb3cgcmV2ZWFsIj48c3BhbiBjbGFzcz0iYmEtbnVtIj4nICsgbnVtU3RyICsgJzwvc3Bhbj48c3BhbiBjbGFzcz0iYmEtdGl0bGUiPicgKyBpdGVtLnRpdGxlICsgJzwvc3Bhbj48L2Rpdj4nCiAgICAgICsgJzxkaXYgY2xhc3M9ImJhLWNvbnRhaW5lciByZXZlYWwiIGlkPSJiYS0nICsgaSArICciPicKICAgICAgKyAgICc8aW1nIHNyYz0iJyArIChpdGVtLmJlZm9yZSB8fCBQTEFDRUhPTERFUl9CRUZPUkUpICsgJyIgY2xhc3M9ImJhLWltZyIgYWx0PSJCZWZvcmUiPicKICAgICAgKyAgICc8aW1nIHNyYz0iJyArIChpdGVtLmFmdGVyICB8fCBQTEFDRUhPTERFUl9BRlRFUikgICsgJyIgY2xhc3M9ImJhLWltZyBiYS1hZnRlciIgYWx0PSJBZnRlciI+JwogICAgICArICAgJzxkaXYgY2xhc3M9ImJhLWhhbmRsZSI+PGRpdiBjbGFzcz0iYmEtaGFuZGxlLWxpbmUiPjwvZGl2PjxkaXYgY2xhc3M9ImJhLWhhbmRsZS1waWxsIj5TTElERTwvZGl2PjwvZGl2PicKICAgICAgKyAgICc8ZGl2IGNsYXNzPSJiYS10YWdzIj48c3BhbiBjbGFzcz0iYmEtdGFnIj5CRUZPUkU8L3NwYW4+PHNwYW4gY2xhc3M9ImJhLXRhZyBhZnRlciI+QUZURVI8L3NwYW4+PC9kaXY+JwogICAgICArICc8L2Rpdj4nCiAgICAgICsgJzxwIGNsYXNzPSJiYS1jYXB0aW9uIHJldmVhbCI+4oaQIOOCueODqeOCpOODieOBl+OBpuWkieWMluOCkueiuuiqjeOBl+OBpuOBj+OBoOOBleOBhDwvcD4nCiAgICAgICsgaW5mb0h0bWw7CiAgICBsaXN0LmFwcGVuZENoaWxkKHdyYXApOwogIH0pOwoKICAvLyDjgrnjg6njgqTjg4Djg7zmk43kvZzjgqTjg5njg7Pjg4gKICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYmEtY29udGFpbmVyJykuZm9yRWFjaChmdW5jdGlvbihjb250YWluZXIpewogICAgdmFyIGhhbmRsZSAgID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5iYS1oYW5kbGUnKTsKICAgIHZhciBhZnRlckltZyA9IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuYmEtYWZ0ZXInKTsKICAgIHZhciBkcmFnZ2luZyA9IGZhbHNlOwogICAgZnVuY3Rpb24gdXBkYXRlKGNsaWVudFgpewogICAgICB2YXIgcmVjdCA9IGNvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgdmFyIHBvcyAgPSBNYXRoLm1heCgwLCBNYXRoLm1pbigxMDAsICgoY2xpZW50WCAtIHJlY3QubGVmdCkgLyByZWN0LndpZHRoKSAqIDEwMCkpOwogICAgICBhZnRlckltZy5zdHlsZS5jbGlwUGF0aCAgPSAnaW5zZXQoMCAwIDAgJyArIHBvcyArICclKSc7CiAgICAgIGhhbmRsZS5zdHlsZS5sZWZ0ICAgICAgICA9IHBvcyArICclJzsKICAgICAgaGFuZGxlLnN0eWxlLnRyYW5zZm9ybSAgID0gJ3RyYW5zbGF0ZVgoLTUwJSknOwogICAgfQogICAgY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIGZ1bmN0aW9uKGUpeyBkcmFnZ2luZyA9IHRydWU7IHVwZGF0ZShlLmNsaWVudFgpOyB9KTsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCAgICBmdW5jdGlvbihlKXsgaWYoZHJhZ2dpbmcpIHVwZGF0ZShlLmNsaWVudFgpOyB9KTsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgICAgICBmdW5jdGlvbigpeyBkcmFnZ2luZyA9IGZhbHNlOyB9KTsKICAgIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24oZSl7IHVwZGF0ZShlLnRvdWNoZXNbMF0uY2xpZW50WCk7IH0sIHtwYXNzaXZlOnRydWV9KTsKICAgIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCAgZnVuY3Rpb24oZSl7IHVwZGF0ZShlLnRvdWNoZXNbMF0uY2xpZW50WCk7IH0sIHtwYXNzaXZlOnRydWV9KTsKICB9KTsKCiAgLy8gQkEg44K544Op44Kk44OA44O85LiL44GuIHJldmVhbCDopoHntKDjgpLnm6PoppYKICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjYmEtbGlzdCAucmV2ZWFsJykuZm9yRWFjaChmdW5jdGlvbihlbCl7IG9ic2VydmVyLm9ic2VydmUoZWwpOyB9KTsKfQoKZnVuY3Rpb24gZXNjSHRtbExQKHMpeyByZXR1cm4gKHN8fCcnKS5yZXBsYWNlKC8mL2csJyZhbXA7JykucmVwbGFjZSgvIi9nLCcmcXVvdDsnKS5yZXBsYWNlKC88L2csJyZsdDsnKS5yZXBsYWNlKC8+L2csJyZndDsnKTsgfQpmdW5jdGlvbiBvcGVuTGlnaHRib3goc3JjKXsgdmFyIGxiPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsaWdodGJveCcpOyBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGlnaHRib3gtaW1nJykuc3JjPXNyYzsgbGIuY2xhc3NMaXN0LmFkZCgnb3BlbicpOyB9CmZ1bmN0aW9uIGNsb3NlTGlnaHRib3goKXsgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xpZ2h0Ym94JykuY2xhc3NMaXN0LnJlbW92ZSgnb3BlbicpOyB9CgovLyAtLS0tLSDli5XnlLvooajnpLrliLblvqEgLS0tLS0KdmFyIHZpZGVvICAgICAgID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb21vLXZpZGVvJyk7CnZhciBwbGFjZWhvbGRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWRlby1wbGFjZWhvbGRlcicpOwp2YXIgdmlkZW9TcmMgICAgPSB2aWRlbyA/IHZpZGVvLmdldEF0dHJpYnV0ZSgnc3JjJykgOiAnJzsKaWYodmlkZW9TcmMgJiYgdmlkZW9TcmMudHJpbSgpICE9PSAnJyl7CiAgaWYocGxhY2Vob2xkZXIpIHBsYWNlaG9sZGVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgdmlkZW8uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7Cn0gZWxzZSB7CiAgaWYodmlkZW8pICAgICAgIHZpZGVvLnN0eWxlLmRpc3BsYXkgICAgICAgPSAnbm9uZSc7CiAgaWYocGxhY2Vob2xkZXIpIHBsYWNlaG9sZGVyLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7Cn0KCi8vIC0tLS0tIFJldmVhbCDjgrnjgq/jg63jg7zjg6vjgqLjg4vjg6Hjg7zjgrfjg6fjg7MgLS0tLS0KdmFyIG9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKGZ1bmN0aW9uKGVudHJpZXMpewogIGVudHJpZXMuZm9yRWFjaChmdW5jdGlvbihlKXsgaWYoZS5pc0ludGVyc2VjdGluZykgZS50YXJnZXQuY2xhc3NMaXN0LmFkZCgndmlzaWJsZScpOyB9KTsKfSwge3RocmVzaG9sZDogMC4xMn0pOwpkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucmV2ZWFsJykuZm9yRWFjaChmdW5jdGlvbihlbCl7IG9ic2VydmVyLm9ic2VydmUoZWwpOyB9KTsKCi8vIEJBIOOCueODqeOCpOODgOODvOWIneacn+WMlu+8iG9ic2VydmVyIOWumue+qeW+jO+8iQppbml0QmFTbGlkZXJzKCk7CgovKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICBHQTQg44Kk44OZ44Oz44OI6KiI5ris77yI6Kit6KiI5pu4IHYyLjDvvIkKICAgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8KCi8vIFsxXSBMSU5FIENUQeODnOOCv+ODsyDigJQgZXZlbnRfY2F0ZWdvcnk6J2N0YScsIGV2ZW50X2xhYmVsOidsaW5lX3ByJwpkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY3RhLWJ0bicpLmZvckVhY2goZnVuY3Rpb24oYnRuKXsKICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpewogICAgZ3RhZygnZXZlbnQnLCAnY2xpY2snLCB7CiAgICAgIGV2ZW50X2NhdGVnb3J5IDogJ2N0YScsCiAgICAgIGV2ZW50X2xhYmVsICAgIDogJ2xpbmVfcHInCiAgICB9KTsKICB9KTsKfSk7CgovLyBbMl0gSW5zdGFncmFtIOODnOOCv+ODsyDigJQgZXZlbnRfY2F0ZWdvcnk6J3NvY2lhbCcsIGV2ZW50X2xhYmVsOidpbnN0YWdyYW1fbnVtYW4nCmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5udW1hbi1pZycpLmZvckVhY2goZnVuY3Rpb24oYnRuKXsKICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpewogICAgZ3RhZygnZXZlbnQnLCAnY2xpY2snLCB7CiAgICAgIGV2ZW50X2NhdGVnb3J5IDogJ3NvY2lhbCcsCiAgICAgIGV2ZW50X2xhYmVsICAgIDogJ2luc3RhZ3JhbV9udW1hbicKICAgIH0pOwogIH0pOwp9KTsKCi8vIFszXSBCQeOCueODqeOCpOODgOODvOaTjeS9nCDigJQgc2xpZGVyX2ludGVyYWN0IC8gMVBW44Gr44Gk44GNMeWbnuOBruOBvwp2YXIgc2xpZGVyVHJhY2tlZCA9IGZhbHNlOwpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBmdW5jdGlvbihlKXsKICBpZighc2xpZGVyVHJhY2tlZCAmJiBlLnRhcmdldC5jbG9zZXN0ICYmIGUudGFyZ2V0LmNsb3Nlc3QoJy5iYS1jb250YWluZXInKSl7CiAgICBzbGlkZXJUcmFja2VkID0gdHJ1ZTsKICAgIGd0YWcoJ2V2ZW50JywgJ3NsaWRlcl9pbnRlcmFjdCcsIHsKICAgICAgZXZlbnRfY2F0ZWdvcnkgOiAnZW5nYWdlbWVudCcsCiAgICAgIGV2ZW50X2xhYmVsICAgIDogJ2JhX3NsaWRlcicKICAgIH0pOwogIH0KfSwge3Bhc3NpdmU6dHJ1ZX0pOwpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgZnVuY3Rpb24oZSl7CiAgaWYoIXNsaWRlclRyYWNrZWQgJiYgZS50YXJnZXQuY2xvc2VzdCAmJiBlLnRhcmdldC5jbG9zZXN0KCcuYmEtY29udGFpbmVyJykpewogICAgc2xpZGVyVHJhY2tlZCA9IHRydWU7CiAgICBndGFnKCdldmVudCcsICdzbGlkZXJfaW50ZXJhY3QnLCB7CiAgICAgIGV2ZW50X2NhdGVnb3J5IDogJ2VuZ2FnZW1lbnQnLAogICAgICBldmVudF9sYWJlbCAgICA6ICdiYV9zbGlkZXInCiAgICB9KTsKICB9Cn0sIHtwYXNzaXZlOnRydWV9KTsKCi8vIFs0XSBXaHkgS0lNQVJV44K544OI44O844Oq44O86Kqt5LqGIOKAlCByZWFkX3N0b3J5IC8gMzAl6KGo56S6IMOXIDXnp5Lku6XkuIoKdmFyIHN0b3J5VHJhY2tlZCA9IGZhbHNlOwp2YXIgc3RvcnlUaW1lciAgID0gbnVsbDsKdmFyIHN0b3J5T2JzZXJ2ZXIgPSBuZXcgSW50ZXJzZWN0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24oZW50cmllcyl7CiAgZW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uKGVudHJ5KXsKICAgIGlmKGVudHJ5LmlzSW50ZXJzZWN0aW5nICYmICFzdG9yeVRyYWNrZWQpewogICAgICAvLyA156eS6ZaT57aZ57aa6KGo56S644Gn44Kr44Km44Oz44OICiAgICAgIHN0b3J5VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7CiAgICAgICAgc3RvcnlUcmFja2VkID0gdHJ1ZTsKICAgICAgICBndGFnKCdldmVudCcsICdyZWFkX3N0b3J5JywgewogICAgICAgICAgZXZlbnRfY2F0ZWdvcnkgOiAnZW5nYWdlbWVudCcsCiAgICAgICAgICBldmVudF9sYWJlbCAgICA6ICd3aHlfa2ltYXJ1JwogICAgICAgIH0pOwogICAgICB9LCA1MDAwKTsKICAgIH0gZWxzZSB7CiAgICAgIC8vIOOCueOCr+ODreODvOODq+OCouOCpuODiOOBl+OBn+OCieOCv+OCpOODnuODvOODquOCu+ODg+ODiAogICAgICBjbGVhclRpbWVvdXQoc3RvcnlUaW1lcik7CiAgICAgIHN0b3J5VGltZXIgPSBudWxsOwogICAgfQogIH0pOwp9LCB7dGhyZXNob2xkOiAwLjN9KTsKdmFyIHdoeVNlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2h5LWtpbWFydScpOwppZih3aHlTZWN0aW9uKSBzdG9yeU9ic2VydmVyLm9ic2VydmUod2h5U2VjdGlvbik7Cjwvc2NyaXB0Pgo8L2JvZHk+CjwvaHRtbD4=';
function _getLp(){
  try{ return decodeURIComponent(escape(atob(_LP_B64))); }catch(e){ return ''; }
}
function generateAndDownload(){
  var s=saveSettings();
  var html=_getLp();
  if(!html){ showToast('âš  ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼'); return; }
  html=applySettings(html,s);
  var theme=s['theme']||'dark';
  var themeName=theme.charAt(0).toUpperCase()+theme.slice(1);
  downloadHTML(html,'KIMARU_'+themeName+'.html');
  dirty=false;
  document.getElementById('save-bar').classList.remove('show');
  showToast('âœ… KIMARU_'+themeName+'.html ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ãŸï¼');
}

function applySettings(html,s){
  // BA data JSON
  var baJson=JSON.stringify(baCards.map(function(item){
    return {
      title  : item.title   || '',
      before : item.before  || '',
      after  : item.after   || '',
      finish : item.finish  || '',
      color  : item.color   || '',
      grout  : item.grout   || '',
      sample : item.sample  || '',
      angles : (item.angles || []).map(function(a){ return {src:a.src||'', label:a.label||''}; })
    };
  }));
  html=html.replace(/(<script type="application\/json" id="ba-data">)([\s\S]*?)(<\/script>)/,'$1'+baJson+'$3');

  // ãƒ†ãƒ¼ãƒå›ºå®šï¼ˆåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã¯å‰Šé™¤æ¸ˆã¿ï¼‰
  var theme = s['theme'] || 'dark';
  html = html.replace(/data-theme="%%KIMARU_THEME%%"/, 'data-theme="'+theme+'"');

  // GA4 æ¸¬å®šID
  if(s['ga4-id'] && s['ga4-id'].trim()){
    html=html.replace(/G-0VF277F6RX/g, s['ga4-id'].trim());
  }
  // LINE URL
  html=html.replace(/href="[^"]*"(\s*class="cta-btn)/g,'href="'+s['line-url']+'"$1');
  // Instagram URL
  html=html.replace(/href="[^"]*"(\s*class="numan-ig)/g,'href="'+s['ig-url']+'"$1');
  // Video
  html=html.replace(/(<video[^>]*src=")[^"]*(")/,'$1'+s['video-url']+'$2');
  if(s['video-title']) html=html.replace(/(<h2 class="section-title">)ç´ æã®ä¸–ç•Œã‚’ã€æ˜ åƒã§ã€‚(<\/h2>)/,'$1'+s['video-title']+'$2');
  if(s['video-body'])  html=html.replace(/(<p class="section-body">)é³¥è¦³å›³ã‹ã‚‰[^<]*(<\/p>)/,'$1'+s['video-body']+'$2');
  html=html.replace(/(<video[^>]*poster=")[^"]*(")/,'$1'+s['video-poster']+'$2');

  // Hero catch
  var catchLines=s['hero-catch'].split('\n').filter(l=>l.trim());
  if(catchLines.length){
    var newCatch=catchLines.map(l=>'<span>'+l+'</span>').join('');
    html=html.replace(/(<div class="hero-catch">)([\s\S]*?)(<\/div>[\s\n]*<\/div>[\s\n]*<p class="hero-sub">)/,function(m,p1,p2,p3){return p1+newCatch+p3.replace(/^(<\/div>[\s\n]*<\/div>[\s\n]*)/,'</div>\n    </div>\n    ');});
  }
  // Hero sub
  html=html.replace(/(<p class="hero-sub">)([\s\S]*?)(<\/p>)/,'$1'+s['hero-sub'].replace(/\n/g,'<br>')+'$3');
  // Message
  html=html.replace(/(<p class="message-main">)([\s\S]*?)(<\/p>)/,'$1'+s['msg-main'].replace(/\n/g,'<br>')+'$3');
  html=html.replace(/(<p class="message-body">)([\s\S]*?)(<\/p>)/,'$1'+s['msg-body'].replace(/\n/g,'<br>')+'$3');
  // CTA title
  html=html.replace(/(<h2 class="cta-title reveal">)([\s\S]*?)(<\/h2>)/,'$1'+s['cta-title'].replace(/\n/g,'<br>')+'$3');
  // Gallery teaser
  var galleryTitle   = s['gallery-title']   || 'ãã®ä»–ã®æ–½å·¥äº‹ä¾‹ã¯ã“ã¡ã‚‰';
  var galleryBody    = s['gallery-body']    || 'ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¥ãƒ»ç´ æåˆ¥ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚’æº–å‚™ã—ã¦ã„ã¾ã™ã€‚';
  var galleryBtnText = s['gallery-btn-text']|| 'æ–½å·¥äº‹ä¾‹ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚’è¦‹ã‚‹';
  var galleryUrl     = s['gallery-url']     || '';
  html = html.replace(/(<h2 class="section-title" style="margin-bottom:12px;">)[^<]*(<\/h2>)/, '$1'+galleryTitle+'$2');
  html = html.replace(/(<p class="section-body" style="max-width:480px;margin:0 auto 28px;">)[^<]*(<\/p>)/, '$1'+galleryBody+'$2');
  // ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼ˆSVGã®å‰ã®ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ï¼‰
  html = html.replace(/(gallery-teaser-btn[^>]*>[\s\S]*?<\/span>\s*)([^<]+)(\s*<svg)/, '$1'+galleryBtnText+'$3');
  if(galleryUrl){
    // URLã‚ã‚Š â†’ ãƒªãƒ³ã‚¯æœ‰åŠ¹åŒ–ãƒ»ãƒãƒƒã‚¸éè¡¨ç¤º
    html = html.replace(/href="#" class="gallery-teaser-btn" onclick="return false;"/, 'href="'+galleryUrl+'" class="gallery-teaser-btn" target="_blank" rel="noopener"');
    html = html.replace(/<span class="gallery-teaser-badge">æº–å‚™ä¸­<\/span>\s*/, '');
  }
  // Numan name
  html=html.replace(/(<h2 class="numan-name">)([\s\S]*?)(<\/h2>)/,'$1'+s['numan-name-ja'].replace(/\n/g,'<br>')+'$3');
  html=html.replace(/(<p class="numan-title">)([\s\S]*?)(<\/p>)/,'$1'+s['numan-name-en']+'$3');
  html=html.replace(/(<span class="numan-meta-text">ä¸‰é‡çœŒ[^<]*)(<\/span>)/,'<span class="numan-meta-text">'+s['numan-location']+'$2');
  html=html.replace(/(<span class="numan-meta-text">ãƒ­ãƒ¼ãƒ©ãƒ¼ã‚¹ãƒˆãƒ¼ãƒ³æ­´[^<]*)(<\/span>)/,'<span class="numan-meta-text">'+s['numan-career']+'$2');
  // Numan body
  var nbHtml=s['numan-body'].replace(/\n\n/g,'</p>\n<p class="numan-body reveal">').replace(/\n/g,'<br>');
  html=html.replace(/(<p class="numan-body reveal">)([\s\S]*?)(<\/p>\s*<a)/,'$1'+nbHtml+'$3');

  // Images (logo / numan photos)
  var imgMap={'numan-color':'images/numan_color.jpg','numan-portrait':'images/numan_portrait.jpg','footer-logo-dark':'images/footer_logo_dark.jpg','footer-logo-light':'images/footer_logo_light.jpg','logo':'images/logo.png'};
  Object.keys(imageData).forEach(function(key){
    if(!imgMap[key])return;
    var src=imgMap[key].replace(/\./g,'\\.').replace(/\//g,'\\/');
    html=html.replace(new RegExp('src="'+src+'"','g'),'src="'+imageData[key].base64+'"');
  });

  // Section visibility
  if(!s['sec-ba'])html=html.replace(/(id="ba-section"[^>]*>)([\s\S]*?)(<\/section>[\s\S]*?<!-- VIDEO)/,function(m,p1,p2,p3){return p1+'<div style="display:none">'+p2+'</div>'+p3;});
  if(!s['sec-video'])html=html.replace(/(class="[^"]*video-section[^"]*"[^>]*>)([\s\S]*?)(<\/section>[\s\S]*?<!-- MESSAGE)/,function(m,p1,p2,p3){return p1+'<div style="display:none">'+p2+'</div>'+p3;});
  if(!s['sec-profile'])html=html.replace(/(<!-- NUMAN SECTION -->)([\s\S]*?)(<!-- WHY)/, '$1<div style="display:none">$2</div>$3');
  if(!s['sec-why'])html=html.replace(/(<!-- WHY KIMARU STORY -->)([\s\S]*?)(<!-- CTA)/,'$1<div style="display:none">$2</div>$3');

  return html;
}

function downloadHTML(html,filename){
  var blob=new Blob([html],{type:'text/html;charset=utf-8'});
  var a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=filename;a.click();URL.revokeObjectURL(a.href);
}

function previewLP(){
  var s=saveSettings();
  var _ph=_getLp();
  if(_ph){var m=applySettings(_ph,s);var blob=new Blob([m],{type:'text/html'});window.open(URL.createObjectURL(blob),'_blank');}
}

function showToast(msg){
  var t=document.getElementById('toast');document.getElementById('toast-msg').textContent=msg;
  t.classList.add('show');setTimeout(()=>t.classList.remove('show'),3500);
}


// ===== PROJECT SAVE / LOAD =====
function openSaveModal(){
  document.getElementById('proj-save-name').value='';
  document.getElementById('modal-save').classList.add('open');
  setTimeout(()=>document.getElementById('proj-save-name').focus(),100);
}
function openLoadModal(){
  renderProjList();
  document.getElementById('modal-load').classList.add('open');
}
function closeProjModal(id){document.getElementById(id).classList.remove('open');}

function saveProject(){
  var name=document.getElementById('proj-save-name').value.trim();
  if(!name){alert('ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');return;}
  var s=saveSettings();
  var projects={};
  try{projects=JSON.parse(localStorage.getItem('kimaru-projects')||'{}');}catch(e){}
  projects[name]={settings:s,savedAt:new Date().toLocaleString('ja-JP')};
  localStorage.setItem('kimaru-projects',JSON.stringify(projects));
  closeProjModal('modal-save');
  showToast('ã€Œ'+name+'ã€ã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚');
}

function renderProjList(){
  var projects={};
  try{projects=JSON.parse(localStorage.getItem('kimaru-projects')||'{}');}catch(e){}
  var names=Object.keys(projects);
  var list=document.getElementById('proj-list');
  if(!names.length){list.innerHTML='<div class="proj-empty">ä¿å­˜æ¸ˆã¿ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒã‚ã‚Šã¾ã›ã‚“</div>';return;}
  window._projNames=names;
  list.innerHTML=names.map(function(name,idx){
    var p=projects[name];
    return '<div class="proj-item">'
      +'<div style="flex:1;min-width:0;">'
      +'<div class="proj-item-name">'+escHtml(name)+'</div>'
      +'<div class="proj-item-date">'+p.savedAt+'</div>'
      +'</div>'
      +'<div class="proj-item-btns">'
      +'<button class="btn btn-primary" style="padding:6px 14px;font-size:.7rem;" onclick="loadProjectByIndex('+idx+')">å‘¼ã³å‡ºã™</button>'
      +'<button class="btn btn-danger" style="padding:6px 10px;" onclick="deleteProjectByIndex('+idx+')">&#10005;</button>'
      +'</div>'
      +'</div>';
  }).join('');
}

function loadProjectByIndex(i){
  var name=window._projNames&&window._projNames[i];
  if(name)loadProject(name);
}
function deleteProjectByIndex(i){
  var name=window._projNames&&window._projNames[i];
  if(name)deleteProject(name);
}

function loadProject(name){
  var projects={};
  try{projects=JSON.parse(localStorage.getItem('kimaru-projects')||'{}');}catch(e){}
  if(!projects[name])return;
  if(!confirm('ã€Œ'+name+'ã€ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚ç¾åœ¨ã®ç·¨é›†å†…å®¹ã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ'))return;
  localStorage.setItem('kimaru-settings',JSON.stringify(projects[name].settings));
  closeProjModal('modal-load');
  loadDefaults();
  setupAllDragDrop();
  showToast('ã€Œ'+name+'ã€ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸã€‚');
}

function deleteProject(name){
  if(!confirm('ã€Œ'+name+'ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ'))return;
  var projects={};
  try{projects=JSON.parse(localStorage.getItem('kimaru-projects')||'{}');}catch(e){}
  delete projects[name];
  localStorage.setItem('kimaru-projects',JSON.stringify(projects));
  renderProjList();
  showToast('å‰Šé™¤ã—ã¾ã—ãŸã€‚');
}

// INIT
loadDefaults();
  setupAllDragDrop();
</script>

<!-- PROJECT SAVE MODAL -->
<div class="proj-modal" id="modal-save" onclick="if(event.target===this)closeProjModal('modal-save')">
  <div class="proj-box">
    <h3>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¿å­˜</h3>
    <div class="form-row"><label class="field-label">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå</label><input type="text" id="proj-save-name" placeholder="ä¾‹ï¼šç„é–¢ã‚¢ãƒ—ãƒ­ãƒ¼ãƒææ¡ˆ Aãƒ‘ã‚¿ãƒ¼ãƒ³"></div>
    <div style="display:flex;gap:10px;margin-top:16px;">
      <button class="btn btn-primary" style="flex:1;" onclick="saveProject()">ğŸ’¾ ä¿å­˜ã™ã‚‹</button>
      <button class="btn btn-secondary" onclick="closeProjModal('modal-save')">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
    </div>
  </div>
</div>
<!-- PROJECT LOAD MODAL -->
<div class="proj-modal" id="modal-load" onclick="if(event.target===this)closeProjModal('modal-load')">
  <div class="proj-box">
    <h3>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å‘¼ã³å‡ºã™</h3>
    <div id="proj-list"></div>
    <button class="btn btn-secondary" style="width:100%;margin-top:12px;" onclick="closeProjModal('modal-load')">é–‰ã˜ã‚‹</button>
  </div>
</div>
</body>
</html>
