<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Case Generator | RollerStone</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--bg:#0a0a0a;--surface:#111;--surface2:#1a1a1a;--gold:#D4AF37;--gold2:#B8860B;--border:rgba(255,255,255,0.08);--text:#fff;--sub:rgba(255,255,255,0.35);--body:rgba(255,255,255,0.65);--line:#06C755;--radius:14px}
body{background:var(--bg);color:var(--text);font-family:'Noto Sans JP',sans-serif;min-height:100vh;padding-bottom:80px}
header{background:rgba(0,0,0,0.9);backdrop-filter:blur(12px);border-bottom:1px solid var(--border);padding:14px 16px;position:sticky;top:0;z-index:50}
header .in{max-width:900px;margin:0 auto;display:flex;align-items:center;justify-content:space-between}
.logo{font-size:11px;font-weight:900;letter-spacing:.2em;color:var(--gold)}
.logo span{color:rgba(255,255,255,0.3)}
.wrap{max-width:900px;margin:0 auto;padding:24px 16px;display:grid;grid-template-columns:1fr 1fr;gap:24px}
@media(max-width:700px){.wrap{grid-template-columns:1fr}}
.panel{background:var(--surface);border:1px solid var(--border);border-radius:20px;padding:20px;height:fit-content}
.panel-title{font-size:10px;font-weight:900;letter-spacing:.2em;color:var(--gold);text-transform:uppercase;margin-bottom:20px;display:flex;align-items:center;gap:8px}
.panel-title::after{content:'';flex:1;height:1px;background:var(--border)}
.fg{margin-bottom:16px}
.fg label{display:block;font-size:10px;font-weight:900;letter-spacing:.1em;color:var(--sub);margin-bottom:6px;text-transform:uppercase}
.fg input,.fg select,.fg textarea{width:100%;background:var(--surface2);border:1px solid var(--border);border-radius:10px;padding:10px 12px;color:var(--text);font-family:inherit;font-size:13px;transition:border-color .2s;outline:none}
.fg input:focus,.fg select:focus,.fg textarea:focus{border-color:rgba(212,175,55,0.4)}
.fg textarea{resize:vertical;min-height:80px;line-height:1.7}
.fg select option{background:#111}
.fg .hint{font-size:10px;color:var(--sub);margin-top:5px;line-height:1.7;background:rgba(255,255,255,0.03);border-radius:8px;padding:8px 10px;border-left:2px solid var(--gold)44}
.fg .hint em{color:var(--gold);font-style:normal}
.color-row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.color-wrap{display:flex;gap:6px;align-items:center}
.color-wrap input[type=color]{width:36px;height:36px;border-radius:8px;padding:2px;cursor:pointer;flex-shrink:0;border:1px solid var(--border);background:var(--surface2)}
.color-wrap input[type=text]{flex:1}
.photo-set{background:var(--surface2);border:1px solid var(--border);border-radius:12px;padding:14px;margin-bottom:10px;position:relative}
.photo-set input{width:100%;background:#0a0a0a;border:1px solid var(--border);border-radius:8px;padding:9px 11px;color:var(--text);font-family:inherit;font-size:12px;outline:none;margin-top:6px}
.photo-set input:first-child{margin-top:0}
.photo-set input:focus{border-color:rgba(212,175,55,0.4)}
.badge{font-size:9px;font-weight:900;padding:3px 10px;border-radius:999px;display:inline-block;margin-bottom:8px}
.b-before{background:rgba(255,255,255,0.1);color:rgba(255,255,255,0.7)}
.b-after{background:var(--gold);color:#000}
.b-sub{background:rgba(255,255,255,0.05);color:var(--sub);border:1px solid var(--border)}
.b-material{background:rgba(255,255,255,0.05);color:var(--sub);border:1px solid var(--border)}
.b-video{background:rgba(6,199,85,0.15);color:var(--line);border:1px solid rgba(6,199,85,0.3)}
.del-btn{position:absolute;top:10px;right:10px;background:none;border:none;color:rgba(255,255,255,0.2);font-size:15px;cursor:pointer;padding:2px 6px;border-radius:6px;transition:color .2s}
.del-btn:hover{color:rgba(255,80,80,0.7)}
.add-btns{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px}
.add-btn{background:var(--surface2);border:1px solid var(--border);color:var(--sub);font-size:11px;font-weight:700;padding:7px 14px;border-radius:999px;cursor:pointer;transition:all .2s}
.add-btn:hover{border-color:var(--gold);color:var(--gold)}
.comment-item{display:flex;gap:8px;margin-bottom:8px;align-items:start}
.comment-item textarea{flex:1;min-height:65px;background:var(--surface2);border:1px solid var(--border);border-radius:10px;padding:10px 12px;color:var(--text);font-family:inherit;font-size:13px;outline:none;resize:vertical;line-height:1.7}
.comment-item textarea:focus{border-color:rgba(212,175,55,0.4)}
.cdel{background:none;border:none;color:rgba(255,255,255,0.2);font-size:15px;cursor:pointer;padding:8px 4px;flex-shrink:0;transition:color .2s;margin-top:4px}
.cdel:hover{color:rgba(255,80,80,0.7)}
.actions{display:flex;gap:10px;margin-top:20px;flex-wrap:wrap}
.btn-prev{flex:1;padding:14px;background:var(--surface2);border:1px solid rgba(212,175,55,0.3);border-radius:12px;color:var(--gold);font-weight:900;font-size:13px;cursor:pointer;transition:all .2s;font-family:inherit}
.btn-prev:hover{background:rgba(212,175,55,0.08)}
.btn-gen{flex:1;padding:14px;background:linear-gradient(135deg,var(--gold),var(--gold2));border:none;border-radius:12px;color:#000;font-weight:900;font-size:13px;cursor:pointer;transition:opacity .2s;font-family:inherit}
.btn-gen:hover{opacity:.9}
.preview-area{background:var(--surface2);border:1px solid var(--border);border-radius:14px;overflow:hidden;min-height:220px}
.preview-empty{display:flex;align-items:center;justify-content:center;min-height:220px;color:var(--sub);font-size:12px;flex-direction:column;gap:8px}
.pv-icon{font-size:32px;opacity:.25}
.pv-card{padding:16px}
.pv-disc{font-size:9px;font-weight:900;padding:4px 12px;border-radius:999px;display:inline-block;margin-bottom:12px;border:1px solid rgba(212,175,55,0.3);color:var(--gold);background:rgba(0,0,0,0.6)}
.pv-disc.real{color:#06C755;border-color:rgba(6,199,85,0.3)}
.pv-cat{display:inline-block;font-size:8px;font-weight:900;padding:2px 10px;border-radius:999px;margin-bottom:6px}
.pv-cat.random{background:rgba(255,255,255,0.9);color:#111}
.pv-cat.tile{background:var(--gold);color:#000}
.pv-cat.original{background:transparent;color:#fff;border:1px solid var(--border)}
.pv-title{font-size:18px;font-weight:900;margin-bottom:2px}
.pv-g{background:linear-gradient(135deg,#D4AF37,#B8860B);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.pv-sub{font-size:11px;color:var(--sub);margin-bottom:10px}
.pv-chips{display:flex;gap:10px;margin-bottom:14px;flex-wrap:wrap}
.pv-chip{display:flex;align-items:center;gap:5px;font-size:10px;color:var(--sub)}
.pv-dot{width:10px;height:10px;border-radius:50%;border:1px solid var(--border)}
.pv-sl{position:relative;width:100%;aspect-ratio:4/3;background:#1a1a1a;border-radius:10px;overflow:hidden;margin-bottom:10px;cursor:ew-resize;user-select:none;touch-action:pan-y}
.pv-sl-empty{display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:11px;color:var(--sub)}
.pv-sl-line{position:absolute;top:0;bottom:0;left:50%;width:2px;background:#fff;transform:translateX(-50%)}
.pv-sl-hdl{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:36px;height:36px;border-radius:50%;background:#fff;display:flex;align-items:center;justify-content:center;font-size:11px;color:#333;font-weight:900;letter-spacing:-2px;box-shadow:0 2px 10px rgba(0,0,0,.5)}
.pv-sl-bl{position:absolute;top:8px;left:8px;font-size:8px;font-weight:900;padding:3px 8px;border-radius:999px;background:rgba(0,0,0,.7);color:rgba(255,255,255,.8)}
.pv-sl-ar{position:absolute;top:8px;right:8px;font-size:8px;font-weight:900;padding:3px 8px;border-radius:999px;background:rgba(212,175,55,0.9);color:#000}
.pv-grid{display:grid;grid-template-columns:1fr 1fr;gap:3px;margin-bottom:10px}
.pv-ph{aspect-ratio:1;background:#1a1a1a;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:10px;color:var(--sub);overflow:hidden}
.pv-ph img{width:100%;height:100%;object-fit:cover}
.pv-cm{font-size:11px;color:var(--body);line-height:1.8;margin-bottom:6px}
.pv-cta{background:var(--surface);border:1px solid var(--border);border-radius:14px;padding:16px;text-align:center;margin-top:10px}
.pv-cta-t{font-size:12px;font-weight:900;margin-bottom:4px}
.pv-cta-s{font-size:10px;color:var(--sub);margin-bottom:10px;line-height:1.6}
.pv-cta-b{display:block;background:#06C755;color:#fff;font-weight:900;font-size:12px;padding:12px;border-radius:10px;text-decoration:none}
.output-area{margin-top:16px}
.out-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.out-lbl{font-size:10px;font-weight:900;color:var(--sub);letter-spacing:.1em}
.copy-btn{background:var(--surface2);border:1px solid var(--border);color:var(--gold);font-size:11px;font-weight:700;padding:5px 14px;border-radius:999px;cursor:pointer;transition:all .2s;font-family:inherit}
.copy-btn:hover{background:rgba(212,175,55,0.08)}
.copy-btn.ok{color:#06C755;border-color:rgba(6,199,85,0.3)}
.code-box{background:#050505;border:1px solid var(--border);border-radius:12px;padding:14px;font-family:monospace;font-size:11px;color:rgba(255,255,255,0.55);line-height:1.7;overflow-x:auto;white-space:pre;max-height:280px;overflow-y:auto}
.out-guide{margin-top:10px;font-size:10px;color:var(--sub);line-height:1.8;background:rgba(255,255,255,0.03);border-radius:8px;padding:10px 12px}
.out-guide em{color:var(--gold);font-style:normal}
.theme-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:6px}
.th-opt{border:2px solid transparent;border-radius:10px;padding:8px 4px;cursor:pointer;text-align:center;transition:all .2s;font-size:9px;font-weight:900;color:var(--sub);background:var(--surface2)}
.th-opt.on{border-color:var(--gold);color:var(--gold)}
.th-dot{width:26px;height:26px;border-radius:50%;margin:0 auto 4px;border:1px solid rgba(255,255,255,0.1)}
</style>
</head>
<body>

<header>
  <div class="in">
    <div class="logo">ROLLER<span>STONE</span> / Case Generator</div>
    <div style="font-size:10px;color:var(--sub)">ãƒ­ãƒ¼ã‚«ãƒ«ãƒ„ãƒ¼ãƒ«</div>
  </div>
</header>

<div class="wrap">

  <!-- å·¦ï¼šå…¥åŠ› -->
  <div>
    <div class="panel">
      <div class="panel-title">åŸºæœ¬æƒ…å ±</div>

      <div class="fg">
        <label>äº‹ä¾‹ç•ªå·</label>
        <input type="text" id="f-id" placeholder="001" value="001" oninput="upd()">
      </div>

      <div class="fg">
        <label>ã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚¿ã‚¤ãƒ—</label>
        <select id="f-type" onchange="upd()">
          <option value="paas">åˆ¶ä½œäº‹ä¾‹ï¼ˆAIãƒ‘ãƒ¼ã‚¹ãƒ»æ–½å·¥å‰ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰</option>
          <option value="construction">æ–½å·¥äº‹ä¾‹ï¼ˆå®Ÿéš›ã®æ–½å·¥å†™çœŸï¼‰</option>
        </select>
      </div>

      <div class="fg">
        <label>ãƒ†ãƒ¼ãƒ</label>
        <div class="theme-grid">
          <div class="th-opt on" data-t="DARK" onclick="selTheme(this)"><div class="th-dot" style="background:#0a0a0a;border-color:#D4AF37"></div>DARK</div>
          <div class="th-opt" data-t="LIGHT" onclick="selTheme(this)"><div class="th-dot" style="background:#f5f5f0;border-color:#B8860B"></div>LIGHT</div>
          <div class="th-opt" data-t="ELEGANT" onclick="selTheme(this)"><div class="th-dot" style="background:#0d1b2a;border-color:#C0C0C0"></div>ELEGANT</div>
          <div class="th-opt" data-t="NATURAL" onclick="selTheme(this)"><div class="th-dot" style="background:#f0ebe3;border-color:#8B6335"></div>NATURAL</div>
          <div class="th-opt" data-t="BOLD" onclick="selTheme(this)"><div class="th-dot" style="background:#000;border-color:#fff"></div>BOLD</div>
        </div>
      </div>

      <div class="fg">
        <label>ã‚«ãƒ†ã‚´ãƒª</label>
        <select id="f-cat" onchange="upd()">
          <option value="ä¹±å½¢çŸ³èª¿">ä¹±å½¢çŸ³èª¿</option>
          <option value="ã‚¿ã‚¤ãƒ«èª¿">ã‚¿ã‚¤ãƒ«èª¿</option>
          <option value="ç‰¹æ®Šãƒ»ãƒ­ã‚´">ç‰¹æ®Šãƒ»ãƒ­ã‚´</option>
        </select>
      </div>

      <div class="fg">
        <label>ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«</label>
        <input type="text" id="f-sub" placeholder="é§è»Šå ´ â€” ä¸€æˆ¸å»ºã¦" oninput="upd()">
      </div>

      <div class="fg">
        <label>ä»•ä¸Šã’ã‚«ãƒ©ãƒ¼ï¼ˆä»»æ„ï¼‰</label>
        <div class="color-row">
          <div>
            <div style="font-size:9px;color:var(--sub);margin-bottom:4px">ãƒ¡ã‚¤ãƒ³ã‚«ãƒ©ãƒ¼</div>
            <div class="color-wrap">
              <input type="color" id="f-mc" value="#c8b89a" oninput="upd()">
              <input type="text" id="f-mct" value="ãƒ™ãƒ¼ã‚¸ãƒ¥" placeholder="ä¾‹ï¼šãƒ™ãƒ¼ã‚¸ãƒ¥" oninput="upd()">
            </div>
          </div>
          <div>
            <div style="font-size:9px;color:var(--sub);margin-bottom:4px">ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚«ãƒ©ãƒ¼</div>
            <div class="color-wrap">
              <input type="color" id="f-ac" value="#888888" oninput="upd()">
              <input type="text" id="f-act" value="ã‚°ãƒ¬ãƒ¼" placeholder="ä¾‹ï¼šã‚°ãƒ¬ãƒ¼" oninput="upd()">
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="panel" style="margin-top:16px">
      <div class="panel-title">ç”»åƒãƒ»å‹•ç”»</div>
      <div id="photos-list"></div>
      <div class="add-btns">
        <button class="add-btn" onclick="addPh('before')">ï¼‹ Before</button>
        <button class="add-btn" onclick="addPh('after')">ï¼‹ After</button>
        <button class="add-btn" onclick="addPh('sub')">ï¼‹ è¿½åŠ ã‚«ãƒƒãƒˆ</button>
        <button class="add-btn" onclick="addPh('material')">ï¼‹ ç´ æç”»åƒ</button>
        <button class="add-btn" onclick="addPh('video')">ï¼‹ å‹•ç”»</button>
      </div>
    </div>

    <div class="panel" style="margin-top:16px">
      <div class="panel-title">ã‚³ãƒ¡ãƒ³ãƒˆ</div>
      <div class="fg">
        <div class="hint">
          <em>ä¾‹æ–‡ï¼š</em>ã€Œé§è»Šå ´ã‚¹ãƒšãƒ¼ã‚¹ã«ä¹±å½¢çŸ³èª¿ã‚’æ–½å·¥ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚æ—¢å­˜ã®ã‚³ãƒ³ã‚¯ãƒªãƒ¼ãƒˆã‚’å£Šã•ãšä¸Šã‹ã‚‰æ–½å·¥ã§ãã‚‹ãŸã‚ã€è§£ä½“å·¥äº‹ãªã—ã§é«˜ç´šæ„Ÿã‚ã‚‹ä»•ä¸ŠãŒã‚ŠãŒå®Ÿç¾ã§ãã¾ã™ã€‚ã€<br>
          ã€ŒãƒŠãƒãƒ¥ãƒ©ãƒ«ãªçŸ³ã®é¢¨åˆã„ãŒä½å®…ã®å¤–è¦³ã‚’ä¸Šå“ã«æ¼”å‡ºã—ã€å¤œã¯ç…§æ˜ã¨ã®ç›¸æ€§ã‚‚æŠœç¾¤ã§ã™ã€‚ãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„ã€‚ã€
        </div>
      </div>
      <div id="comments-list"></div>
      <button class="add-btn" onclick="addCm()" style="margin-top:4px">ï¼‹ ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ </button>
    </div>

    <div class="actions">
      <button class="btn-prev" onclick="upd()">ğŸ‘ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°</button>
      <button class="btn-gen" onclick="genCode()">âœ¦ ã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ</button>
    </div>

    <div id="output-area" style="display:none" class="output-area">
      <div class="out-header">
        <span class="out-lbl">case_<span id="out-id">001</span>.html ã®ã‚³ãƒ¼ãƒ‰</span>
        <button class="copy-btn" id="copy-btn" onclick="copyCode()">ã‚³ãƒ”ãƒ¼</button>
      </div>
      <div class="code-box" id="code-box"></div>
      <div class="out-guide">
        â‘  ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼<br>
        â‘¡ GitHubã§ <em>Nu-Man/pa-su/works/case_<span id="out-id2">001</span>.html</em> ã‚’æ–°è¦ä½œæˆ<br>
        â‘¢ è²¼ã‚Šä»˜ã‘ã¦ä¿å­˜ãƒ»å®Œäº†
      </div>
    </div>
  </div>

  <!-- å³ï¼šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
  <div>
    <div class="panel" style="position:sticky;top:76px">
      <div class="panel-title">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>
      <div class="preview-area" id="preview-area">
        <div class="preview-empty">
          <div class="pv-icon">ğŸ‘</div>
          <div>å…¥åŠ›å¾Œã€Œãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„</div>
        </div>
      </div>
    </div>
  </div>

</div>

<script>
let photos = [{type:'before',url:'',label:''},{type:'after',url:'',label:''}];
let comments = [''];
let theme = 'DARK';

renderPh(); renderCm();

function selTheme(el){
  document.querySelectorAll('.th-opt').forEach(e=>e.classList.remove('on'));
  el.classList.add('on'); theme=el.dataset.t; upd();
}

function renderPh(){
  const bm={before:['b-before','BEFORE'],after:['b-after','AFTER'],sub:['b-sub','è¿½åŠ ã‚«ãƒƒãƒˆ'],material:['b-material','ç´ æç”»åƒ'],video:['b-video','å‹•ç”»']};
  document.getElementById('photos-list').innerHTML=photos.map((p,i)=>{
    const[bc,bl]=bm[p.type]||['b-sub',p.type];
    const needLabel=(p.type==='sub')||(p.type==='before'&&i>0)||(p.type==='after'&&i>0);
    return `<div class="photo-set">
      <div class="badge ${bc}">${bl}</div><button class="del-btn" onclick="delPh(${i})">âœ•</button>
      <input type="text" placeholder="${p.type==='video'?'Cloudinaryå‹•ç”»URLï¼ˆmp4ï¼‰':'Cloudinaryç”»åƒURL'}" value="${p.url||''}" oninput="photos[${i}].url=this.value;upd()">
      ${needLabel?`<input type="text" placeholder="ãƒ©ãƒ™ãƒ«ï¼ˆä¾‹ï¼šå¤œã®ãƒ©ã‚¤ãƒˆã‚¢ãƒƒãƒ—ï¼‰" value="${p.label||''}" oninput="photos[${i}].label=this.value">` :''}
      ${p.type==='video'?`<input type="text" placeholder="ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒURLï¼ˆä»»æ„ï¼‰" value="${p.poster||''}" oninput="photos[${i}].poster=this.value">`:''}
    </div>`;
  }).join('');
}
function addPh(t){photos.push({type:t,url:'',label:''});renderPh();}
function delPh(i){photos.splice(i,1);renderPh();upd();}

function renderCm(){
  document.getElementById('comments-list').innerHTML=comments.map((c,i)=>
    `<div class="comment-item"><textarea placeholder="æ–½å·¥ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚„ç´ æã®ç‰¹å¾´ã‚’ã‚ã‹ã‚Šã‚„ã™ãå…¥åŠ›ã—ã¦ãã ã•ã„" oninput="comments[${i}]=this.value;upd()">${c}</textarea><button class="cdel" onclick="delCm(${i})">âœ•</button></div>`
  ).join('');
}
function addCm(){comments.push('');renderCm();}
function delCm(i){comments.splice(i,1);renderCm();upd();}

function upd(){
  const id=document.getElementById('f-id').value||'001';
  const tp=document.getElementById('f-type').value;
  const cat=document.getElementById('f-cat').value;
  const sub=document.getElementById('f-sub').value;
  const mc=document.getElementById('f-mc').value;
  const mct=document.getElementById('f-mct').value;
  const ac=document.getElementById('f-ac').value;
  const act=document.getElementById('f-act').value;
  const isPaas=tp==='paas';
  const catCls={'ä¹±å½¢çŸ³èª¿':'random','ã‚¿ã‚¤ãƒ«èª¿':'tile','ç‰¹æ®Šãƒ»ãƒ­ã‚´':'original'}[cat]||'random';
  const ctaBtn=isPaas?'LINEã§ç„¡æ–™ã‚¤ãƒ¡ãƒ¼ã‚¸ä½œæˆã‚’ä¾é ¼':'LINEã§ç„¡æ–™è¦‹ç©ã‚‚ã‚Šã‚’ä¾é ¼';
  const ctaSub=isPaas?'ã‚ãªãŸã®ãŠå®¶ã®å†™çœŸã‚’é€ã‚‹ã ã‘ã§<br>ç„¡æ–™ã§å®Œæˆã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™':'ç„¡æ–™ã§ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™<br>ãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„';
  const mainBf=photos.find(p=>p.type==='before');
  const mainAf=photos.find(p=>p.type==='after');
  const subs=photos.filter(p=>p.type==='sub');

  let slHtml='';
  if(mainBf||mainAf){
    slHtml=`<div class="pv-sl" id="pvsl">
      ${mainAf?.url?`<img src="${mainAf.url}" style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover">`:''}
      <div id="pvslbf" style="position:absolute;inset:0;clip-path:inset(0 50% 0 0);overflow:hidden">${mainBf?.url?`<img src="${mainBf.url}" style="width:100%;height:100%;object-fit:cover">`:''}</div>
      ${!mainBf?.url&&!mainAf?.url?'<div class="pv-sl-empty">Before / After ç”»åƒ</div>':''}
      <div class="pv-sl-line" id="pvsln"></div>
      <div class="pv-sl-hdl" id="pvslh">â—€â–¶</div>
      <div class="pv-sl-bl">BEFORE</div><div class="pv-sl-ar">AFTER</div>
    </div>`;
  }

  let subsHtml='';
  if(subs.length>0){
    subsHtml=`<div class="pv-grid">`+subs.slice(0,4).map(s=>s.url?`<div class="pv-ph"><img src="${s.url}" alt="${s.label||''}"></div>`:`<div class="pv-ph">${s.label||'è¿½åŠ ã‚«ãƒƒãƒˆ'}</div>`).join('')+`</div>`;
  }

  const cmsHtml=comments.filter(c=>c).map(c=>`<p class="pv-cm">${c}</p>`).join('');

  document.getElementById('preview-area').innerHTML=`<div class="pv-card">
    <div class="pv-disc${isPaas?'':' real'}">${isPaas?'âš  AIãƒ‘ãƒ¼ã‚¹ãƒ»æ–½å·¥å‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™':'âœ“ å®Ÿéš›ã®æ–½å·¥å†™çœŸã§ã™'}</div>
    <div><span class="pv-cat ${catCls}">${cat}</span></div>
    <div class="pv-title">${isPaas?'åˆ¶ä½œ':'æ–½å·¥'}äº‹ä¾‹ <span class="pv-g">No.${id}</span></div>
    <div class="pv-sub">${sub||'ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«'}</div>
    <div class="pv-chips">
      <div class="pv-chip"><div class="pv-dot" style="background:${mc}"></div>ãƒ¡ã‚¤ãƒ³ï¼š${mct||mc}</div>
      <div class="pv-chip"><div class="pv-dot" style="background:${ac}"></div>ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼š${act||ac}</div>
    </div>
    ${slHtml}${subsHtml}${cmsHtml}
    <div class="pv-cta"><div class="pv-cta-t">ã“ã®ãƒ‡ã‚¶ã‚¤ãƒ³ãŒæ°—ã«ãªã‚Šã¾ã—ãŸã‹ï¼Ÿ</div><div class="pv-cta-s">${ctaSub}</div><a class="pv-cta-b">${ctaBtn}</a></div>
  </div>`;

  const sl=document.getElementById('pvsl');
  if(sl){
    const bf=document.getElementById('pvslbf'),ln=document.getElementById('pvsln'),hd=document.getElementById('pvslh');
    let drag=false;
    function sp(p){p=Math.max(2,Math.min(98,p));bf.style.clipPath=`inset(0 ${100-p}% 0 0)`;ln.style.left=hd.style.left=p+'%';}
    function pc(x){const r=sl.getBoundingClientRect();return((x-r.left)/r.width)*100;}
    sl.addEventListener('mousedown',e=>{drag=true;sp(pc(e.clientX));});
    window.addEventListener('mousemove',e=>{if(drag)sp(pc(e.clientX));});
    window.addEventListener('mouseup',()=>{drag=false;});
    sl.addEventListener('touchstart',e=>{drag=true;sp(pc(e.touches[0].clientX));},{passive:true});
    window.addEventListener('touchmove',e=>{if(drag)sp(pc(e.touches[0].clientX));},{passive:true});
    window.addEventListener('touchend',()=>{drag=false;});
    sp(50);
  }
}

function genCode(){
  const id=document.getElementById('f-id').value||'001';
  const tp=document.getElementById('f-type').value;
  const cat=document.getElementById('f-cat').value;
  const sub=document.getElementById('f-sub').value;
  const mc=document.getElementById('f-mc').value;
  const mct=document.getElementById('f-mct').value;
  const ac=document.getElementById('f-ac').value;
  const act=document.getElementById('f-act').value;

  const phStr=photos.map(p=>{let s=`        { type: '${p.type}', url: '${p.url}'`;if(p.label)s+=`, label: '${p.label}'`;if(p.poster)s+=`, poster: '${p.poster}'`;return s+' },';}).join('\n');
  const cmStr=comments.filter(c=>c).map(c=>`        '${c.replace(/'/g,"\\'")}',`).join('\n');

  const code=`<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>${tp==='paas'?'åˆ¶ä½œ':'æ–½å·¥'}äº‹ä¾‹ No.${id} | RollerStone</title>
</head>
<body>
<script>
const CASE = {
    id: '${id}',
    galleryType: '${tp}',
    theme: '${theme}',
    category: '${cat}',
    subtitle: '${sub}',
    mainColor: '${mc}',
    mainColorLabel: '${mct}',
    accentColor: '${ac}',
    accentColorLabel: '${act}',
    comments: [
${cmStr}
    ],
    photos: [
${phStr}
    ],
};
<\/script>
<script src="../case_template.js"><\/script>
</body>
</html>`;

  document.getElementById('code-box').textContent=code;
  document.getElementById('out-id').textContent=id;
  document.getElementById('out-id2').textContent=id;
  document.getElementById('output-area').style.display='block';
  document.getElementById('output-area').scrollIntoView({behavior:'smooth'});
}

function copyCode(){
  navigator.clipboard.writeText(document.getElementById('code-box').textContent).then(()=>{
    const b=document.getElementById('copy-btn');
    b.textContent='âœ“ ã‚³ãƒ”ãƒ¼å®Œäº†';b.classList.add('ok');
    setTimeout(()=>{b.textContent='ã‚³ãƒ”ãƒ¼';b.classList.remove('ok');},2000);
  });
}
</script>
</body>
</html>
